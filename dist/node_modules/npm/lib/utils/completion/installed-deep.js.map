{"version":3,"sources":["../../../../../../node_modules/npm/lib/utils/completion/installed-deep.js"],"names":["module","exports","installedDeep","npm","require","readInstalled","opts","cb","local","global","depth","config","get","opt","dev","next","prefix","er","data","getNames","getNames_","d","n","realName","Object","keys","dependencies","forEach","dep","map","g","names","concat"],"mappings":";;AAAAA,OAAOC,OAAP,GAAiBC,aAAjB;;AAEA,IAAIC,MAAMC,QAAQ,cAAR,CAAV;AACA,IAAIC,gBAAgBD,QAAQ,gBAAR,CAApB;;AAEA,SAASF,aAAT,CAAwBI,IAAxB,EAA8BC,EAA9B,EAAkC;AAChC,MAAIC,KAAJ;AACA,MAAIC,MAAJ;AACA,MAAIC,QAAQP,IAAIQ,MAAJ,CAAWC,GAAX,CAAe,OAAf,CAAZ;AACA,MAAIC,MAAM,EAAEH,OAAOA,KAAT,EAAgBI,KAAK,IAArB,EAAV;;AAEA,MAAIX,IAAIQ,MAAJ,CAAWC,GAAX,CAAe,QAAf,CAAJ,EAA8B;AAC5BJ,YAAQ,EAAR;AACAO;AACD,GAHD,MAGO;AACLV,kBAAcF,IAAIa,MAAlB,EAA0BH,GAA1B,EAA+B,UAAUI,EAAV,EAAcC,IAAd,EAAoB;AACjDV,cAAQW,SAASD,QAAQ,EAAjB,CAAR;AACAH;AACD,KAHD;AAID;;AAEDV,gBAAcF,IAAIQ,MAAJ,CAAWC,GAAX,CAAe,QAAf,CAAd,EAAwCC,GAAxC,EAA6C,UAAUI,EAAV,EAAcC,IAAd,EAAoB;AAC/DT,aAASU,SAASD,QAAQ,EAAjB,CAAT;AACAH;AACD,GAHD;;AAKA,WAASK,SAAT,CAAoBC,CAApB,EAAuBC,CAAvB,EAA0B;AACxB,QAAID,EAAEE,QAAF,IAAcD,CAAlB,EAAqB;AACnB,UAAIA,EAAED,EAAEE,QAAJ,CAAJ,EAAmB,OAAOD,CAAP;AACnBA,QAAED,EAAEE,QAAJ,IAAgB,IAAhB;AACD;AACD,QAAI,CAACD,CAAL,EAAQA,IAAI,EAAJ;AACRE,WAAOC,IAAP,CAAYJ,EAAEK,YAAF,IAAkB,EAA9B,EAAkCC,OAAlC,CAA0C,UAAUC,GAAV,EAAe;AACvDR,gBAAUC,EAAEK,YAAF,CAAeE,GAAf,CAAV,EAA+BN,CAA/B;AACD,KAFD;AAGA,WAAOA,CAAP;AACD;AACD,WAASH,QAAT,CAAmBE,CAAnB,EAAsB;AACpB,WAAOG,OAAOC,IAAP,CAAYL,UAAUC,CAAV,CAAZ,CAAP;AACD;;AAED,WAASN,IAAT,GAAiB;AACf,QAAI,CAACP,KAAD,IAAU,CAACC,MAAf,EAAuB;AACvB,QAAI,CAACN,IAAIQ,MAAJ,CAAWC,GAAX,CAAe,QAAf,CAAL,EAA+B;AAC7BH,eAASA,OAAOoB,GAAP,CAAW,UAAUC,CAAV,EAAa;AAC/B,eAAO,CAACA,CAAD,EAAI,IAAJ,CAAP;AACD,OAFQ,CAAT;AAGD;AACD,QAAIC,QAAQvB,MAAMwB,MAAN,CAAavB,MAAb,CAAZ;AACA,WAAOF,GAAG,IAAH,EAASwB,KAAT,CAAP;AACD;AACF","file":"installed-deep.js","sourcesContent":["module.exports = installedDeep\n\nvar npm = require('../../npm.js')\nvar readInstalled = require('read-installed')\n\nfunction installedDeep (opts, cb) {\n  var local\n  var global\n  var depth = npm.config.get('depth')\n  var opt = { depth: depth, dev: true }\n\n  if (npm.config.get('global')) {\n    local = []\n    next()\n  } else {\n    readInstalled(npm.prefix, opt, function (er, data) {\n      local = getNames(data || {})\n      next()\n    })\n  }\n\n  readInstalled(npm.config.get('prefix'), opt, function (er, data) {\n    global = getNames(data || {})\n    next()\n  })\n\n  function getNames_ (d, n) {\n    if (d.realName && n) {\n      if (n[d.realName]) return n\n      n[d.realName] = true\n    }\n    if (!n) n = {}\n    Object.keys(d.dependencies || {}).forEach(function (dep) {\n      getNames_(d.dependencies[dep], n)\n    })\n    return n\n  }\n  function getNames (d) {\n    return Object.keys(getNames_(d))\n  }\n\n  function next () {\n    if (!local || !global) return\n    if (!npm.config.get('global')) {\n      global = global.map(function (g) {\n        return [g, '-g']\n      })\n    }\n    var names = local.concat(global)\n    return cb(null, names)\n  }\n}\n"]}