{"version":3,"sources":["../../../../../node_modules/npm/lib/utils/metrics-launch.js"],"names":["module","exports","launchSendMetrics","fs","require","child_process","main","path","npm","config","get","cliMetrics","join","targetRegistry","statSync","runInBackground","__filename","ex","js","args","opts","unshift","stdio","detached","child","spawn","process","execPath","unref","sendMetrics","send","metricsFile","argv","metricsRegistry"],"mappings":"AAAA;AACA;;AACAA,OAAOC,OAAP,GAAiBC,iBAAjB;AACA,IAAIC,KAAKC,QAAQ,aAAR,CAAT;AACA,IAAIC,gBAAgBD,QAAQ,eAAR,CAApB;;AAEA,IAAIA,QAAQE,IAAR,KAAiBN,MAArB,EAA6BM;;AAE7B,SAASJ,iBAAT,GAA8B;AAC5B,MAAIK,OAAOH,QAAQ,MAAR,CAAX;AACA,MAAII,MAAMJ,QAAQ,WAAR,CAAV;AACA,MAAI;AACF,QAAI,CAACI,IAAIC,MAAJ,CAAWC,GAAX,CAAe,cAAf,CAAL,EAAqC;AACrC,QAAIC,aAAaJ,KAAKK,IAAL,CAAUJ,IAAIC,MAAJ,CAAWC,GAAX,CAAe,OAAf,CAAV,EAAmC,4BAAnC,CAAjB;AACA,QAAIG,iBAAiBL,IAAIC,MAAJ,CAAWC,GAAX,CAAe,kBAAf,CAArB;AACAP,OAAGW,QAAH,CAAYH,UAAZ;AACA,WAAOI,gBAAgBC,UAAhB,EAA4B,CAACL,UAAD,EAAaE,cAAb,CAA5B,CAAP;AACD,GAND,CAME,OAAOI,EAAP,EAAW;AACX;AACD;AACF;;AAED,SAASF,eAAT,CAA0BG,EAA1B,EAA8BC,IAA9B,EAAoCC,IAApC,EAA0C;AACxC,MAAI,CAACD,IAAL,EAAWA,OAAO,EAAP;AACXA,OAAKE,OAAL,CAAaH,EAAb;AACA,MAAI,CAACE,IAAL,EAAWA,OAAO,EAAP;AACXA,OAAKE,KAAL,GAAa,QAAb;AACAF,OAAKG,QAAL,GAAgB,IAAhB;AACA,MAAIC,QAAQnB,cAAcoB,KAAd,CAAoBC,QAAQC,QAA5B,EAAsCR,IAAtC,EAA4CC,IAA5C,CAAZ;AACAI,QAAMI,KAAN;AACA,SAAOJ,KAAP;AACD;;AAED,SAASlB,IAAT,GAAiB;AACf,MAAIuB,cAAczB,QAAQ,cAAR,EAAwB0B,IAA1C;AACA,MAAIC,cAAcL,QAAQM,IAAR,CAAa,CAAb,CAAlB;AACA,MAAIC,kBAAkBP,QAAQM,IAAR,CAAa,CAAb,CAAtB;;AAEAH,cAAYE,WAAZ,EAAyBE,eAAzB;AACD","file":"metrics-launch.js","sourcesContent":["'use strict'\n/* eslint-disable camelcase */\nmodule.exports = launchSendMetrics\nvar fs = require('graceful-fs')\nvar child_process = require('child_process')\n\nif (require.main === module) main()\n\nfunction launchSendMetrics () {\n  var path = require('path')\n  var npm = require('../npm.js')\n  try {\n    if (!npm.config.get('send-metrics')) return\n    var cliMetrics = path.join(npm.config.get('cache'), 'anonymous-cli-metrics.json')\n    var targetRegistry = npm.config.get('metrics-registry')\n    fs.statSync(cliMetrics)\n    return runInBackground(__filename, [cliMetrics, targetRegistry])\n  } catch (ex) {\n    // if the metrics file doesn't exist, don't run\n  }\n}\n\nfunction runInBackground (js, args, opts) {\n  if (!args) args = []\n  args.unshift(js)\n  if (!opts) opts = {}\n  opts.stdio = 'ignore'\n  opts.detached = true\n  var child = child_process.spawn(process.execPath, args, opts)\n  child.unref()\n  return child\n}\n\nfunction main () {\n  var sendMetrics = require('./metrics.js').send\n  var metricsFile = process.argv[2]\n  var metricsRegistry = process.argv[3]\n\n  sendMetrics(metricsFile, metricsRegistry)\n}\n"]}