{"version":3,"sources":["../../../../node_modules/npm/lib/deprecate.js"],"names":["npm","require","mapToRegistry","npa","module","exports","deprecate","usage","completion","opts","cb","conf","argv","remain","length","path","config","er","uri","c","username","params","timeout","auth","registry","get","list","console","error","args","pkg","msg","undefined","p","spec","rawSpec","fetchSpec","name","version","message"],"mappings":";;AAAA;AACA,IAAIA,MAAMC,QAAQ,UAAR,CAAV;AACA,IAAIC,gBAAgBD,QAAQ,4BAAR,CAApB;AACA,IAAIE,MAAMF,QAAQ,iBAAR,CAAV;;AAEAG,OAAOC,OAAP,GAAiBC,SAAjB;;AAEAA,UAAUC,KAAV,GAAkB,2CAAlB;;AAEAD,UAAUE,UAAV,GAAuB,UAAUC,IAAV,EAAgBC,EAAhB,EAAoB;AACzC;AACA;AACA,MAAID,KAAKE,IAAL,CAAUC,IAAV,CAAeC,MAAf,CAAsBC,MAAtB,GAA+B,CAAnC,EAAsC,OAAOJ,IAAP;AACtC;AACA,MAAIK,OAAO,aAAX;AACAb,gBAAca,IAAd,EAAoBf,IAAIgB,MAAxB,EAAgC,UAAUC,EAAV,EAAcC,GAAd,EAAmBC,CAAnB,EAAsB;AACpD,QAAIF,EAAJ,EAAQ,OAAOP,GAAGO,EAAH,CAAP;;AAER,QAAI,EAAEE,KAAKA,EAAEC,QAAT,CAAJ,EAAwB,OAAOV,IAAP;;AAExB,QAAIW,SAAS;AACXC,eAAS,KADE;AAEXC,YAAMJ;AAFK,KAAb;AAIAnB,QAAIwB,QAAJ,CAAaC,GAAb,CAAiBP,MAAMC,EAAEC,QAAzB,EAAmCC,MAAnC,EAA2C,UAAUJ,EAAV,EAAcS,IAAd,EAAoB;AAC7D,UAAIT,EAAJ,EAAQ,OAAOP,IAAP;AACRiB,cAAQC,KAAR,CAAcF,IAAd;AACA,aAAOhB,GAAG,IAAH,EAASgB,KAAKP,EAAEC,QAAP,CAAT,CAAP;AACD,KAJD;AAKD,GAdD;AAeD,CArBD;;AAuBA,SAASd,SAAT,CAAoBuB,IAApB,EAA0BnB,EAA1B,EAA8B;AAC5B,MAAIoB,MAAMD,KAAK,CAAL,CAAV;AACA,MAAIE,MAAMF,KAAK,CAAL,CAAV;AACA,MAAIE,QAAQC,SAAZ,EAAuB,OAAOtB,GAAG,YAAYJ,UAAUC,KAAzB,CAAP;;AAEvB;AACA,MAAI0B,IAAI9B,IAAI2B,GAAJ,CAAR;;AAEA;AACA;AACA,MAAII,OAAOD,EAAEE,OAAF,KAAc,EAAd,GAAmB,GAAnB,GAAyBF,EAAEG,SAAtC;;AAEAlC,gBAAc+B,EAAEI,IAAhB,EAAsBrC,IAAIgB,MAA1B,EAAkC,UAAUC,EAAV,EAAcC,GAAd,EAAmBK,IAAnB,EAAyB;AACzD,QAAIN,EAAJ,EAAQ,OAAOP,GAAGO,EAAH,CAAP;;AAER,QAAII,SAAS;AACXiB,eAASJ,IADE;AAEXK,eAASR,GAFE;AAGXR,YAAMA;AAHK,KAAb;AAKAvB,QAAIwB,QAAJ,CAAalB,SAAb,CAAuBY,GAAvB,EAA4BG,MAA5B,EAAoCX,EAApC;AACD,GATD;AAUD","file":"deprecate.js","sourcesContent":["/* eslint-disable standard/no-callback-literal */\nvar npm = require('./npm.js')\nvar mapToRegistry = require('./utils/map-to-registry.js')\nvar npa = require('npm-package-arg')\n\nmodule.exports = deprecate\n\ndeprecate.usage = 'npm deprecate <pkg>[@<version>] <message>'\n\ndeprecate.completion = function (opts, cb) {\n  // first, get a list of remote packages this user owns.\n  // once we have a user account, then don't complete anything.\n  if (opts.conf.argv.remain.length > 2) return cb()\n  // get the list of packages by user\n  var path = '/-/by-user/'\n  mapToRegistry(path, npm.config, function (er, uri, c) {\n    if (er) return cb(er)\n\n    if (!(c && c.username)) return cb()\n\n    var params = {\n      timeout: 60000,\n      auth: c\n    }\n    npm.registry.get(uri + c.username, params, function (er, list) {\n      if (er) return cb()\n      console.error(list)\n      return cb(null, list[c.username])\n    })\n  })\n}\n\nfunction deprecate (args, cb) {\n  var pkg = args[0]\n  var msg = args[1]\n  if (msg === undefined) return cb('Usage: ' + deprecate.usage)\n\n  // fetch the data and make sure it exists.\n  var p = npa(pkg)\n\n  // npa makes the default spec \"latest\", but for deprecation\n  // \"*\" is the appropriate default.\n  var spec = p.rawSpec === '' ? '*' : p.fetchSpec\n\n  mapToRegistry(p.name, npm.config, function (er, uri, auth) {\n    if (er) return cb(er)\n\n    var params = {\n      version: spec,\n      message: msg,\n      auth: auth\n    }\n    npm.registry.deprecate(uri, params, cb)\n  })\n}\n"]}