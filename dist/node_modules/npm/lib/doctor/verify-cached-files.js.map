{"version":3,"sources":["../../../../../node_modules/npm/lib/doctor/verify-cached-files.js"],"names":["cacache","require","log","module","exports","verifyCachedFiles","cache","cb","info","verify","then","stats","JSON","stringify","reclaimedCount","badContentCount","missingContent","warn","reclaimedSize","s"],"mappings":"AAAA;;AAEA,IAAMA,UAAUC,QAAQ,SAAR,CAAhB;AACA,IAAMC,MAAMD,QAAQ,QAAR,CAAZ;;AAEAE,OAAOC,OAAP,GAAiBC,iBAAjB;AACA,SAASA,iBAAT,CAA4BC,KAA5B,EAAmCC,EAAnC,EAAuC;AACrCL,MAAIM,IAAJ,CAAS,mBAAT,0BAAoDF,KAApD;AACAN,UAAQS,MAAR,CAAeH,KAAf,EAAsBI,IAAtB,CAA2B,UAACC,KAAD,EAAW;AACpCT,QAAIM,IAAJ,CAAS,mBAAT,qCAA+DI,KAAKC,SAAL,CAAeF,KAAf,EAAsB,CAAtB,CAA/D;AACA,QAAIA,MAAMG,cAAN,IAAwBH,MAAMI,eAA9B,IAAiDJ,MAAMK,cAA3D,EAA2E;AACzEL,YAAMI,eAAN,IAAyBb,IAAIe,IAAJ,CAAS,mBAAT,kCAA4DN,MAAMI,eAAlE,CAAzB;AACAJ,YAAMG,cAAN,IAAwBZ,IAAIe,IAAJ,CAAS,mBAAT,kCAA4DN,MAAMG,cAAlE,UAAqFH,MAAMO,aAA3F,aAAxB;AACAP,YAAMK,cAAN,IAAwBd,IAAIe,IAAJ,CAAS,mBAAT,wBAAkDN,MAAMK,cAAxD,CAAxB;AACAd,UAAIe,IAAJ,CAAS,mBAAT,EAA8B,8BAA9B;AACD;AACD,WAAON,KAAP;AACD,GATD,EASGD,IATH,CASQ,UAACS,CAAD;AAAA,WAAOZ,GAAG,IAAH,EAASY,CAAT,CAAP;AAAA,GATR,EAS4BZ,EAT5B;AAUD","file":"verify-cached-files.js","sourcesContent":["'use strict'\n\nconst cacache = require('cacache')\nconst log = require('npmlog')\n\nmodule.exports = verifyCachedFiles\nfunction verifyCachedFiles (cache, cb) {\n  log.info('verifyCachedFiles', `Verifying cache at ${cache}`)\n  cacache.verify(cache).then((stats) => {\n    log.info('verifyCachedFiles', `Verification complete. Stats: ${JSON.stringify(stats, 2)}`)\n    if (stats.reclaimedCount || stats.badContentCount || stats.missingContent) {\n      stats.badContentCount && log.warn('verifyCachedFiles', `Corrupted content removed: ${stats.badContentCount}`)\n      stats.reclaimedCount && log.warn('verifyCachedFiles', `Content garbage-collected: ${stats.reclaimedCount} (${stats.reclaimedSize} bytes)`)\n      stats.missingContent && log.warn('verifyCachedFiles', `Missing content: ${stats.missingContent}`)\n      log.warn('verifyCachedFiles', 'Cache issues have been fixed')\n    }\n    return stats\n  }).then((s) => cb(null, s), cb)\n}\n"]}