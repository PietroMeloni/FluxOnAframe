{"version":3,"sources":["../../../../node_modules/npm/lib/explore.js"],"names":["module","exports","explore","usage","completion","require","npm","spawn","path","fs","isWindowsShell","escapeExecPath","escapeArg","output","args","cb","length","p","shift","cwd","resolve","dir","opts","stdio","shellArgs","execCmd","execArgs","concat","map","windowsVerbatimArguments","unshift","join","trim","sh","config","get","stat","er","s","isDirectory","Error","shell","on"],"mappings":";;AAAA;AACA;;AAEAA,OAAOC,OAAP,GAAiBC,OAAjB;AACAA,QAAQC,KAAR,GAAgB,mCAAhB;AACAD,QAAQE,UAAR,GAAqBC,QAAQ,yCAAR,CAArB;;AAEA,IAAIC,MAAMD,QAAQ,UAAR,CAAV;AACA,IAAIE,QAAQF,QAAQ,eAAR,CAAZ;AACA,IAAIG,OAAOH,QAAQ,MAAR,CAAX;AACA,IAAII,KAAKJ,QAAQ,aAAR,CAAT;AACA,IAAIK,iBAAiBL,QAAQ,6BAAR,CAArB;AACA,IAAIM,iBAAiBN,QAAQ,6BAAR,CAArB;AACA,IAAIO,YAAYP,QAAQ,uBAAR,CAAhB;AACA,IAAIQ,SAASR,QAAQ,mBAAR,CAAb;;AAEA,SAASH,OAAT,CAAkBY,IAAlB,EAAwBC,EAAxB,EAA4B;AAC1B,MAAID,KAAKE,MAAL,GAAc,CAAd,IAAmB,CAACF,KAAK,CAAL,CAAxB,EAAiC,OAAOC,GAAGb,QAAQC,KAAX,CAAP;AACjC,MAAIc,IAAIH,KAAKI,KAAL,EAAR;;AAEA,MAAIC,MAAMX,KAAKY,OAAL,CAAad,IAAIe,GAAjB,EAAsBJ,CAAtB,CAAV;AACA,MAAIK,OAAO,EAACH,KAAKA,GAAN,EAAWI,OAAO,SAAlB,EAAX;;AAEA,MAAIC,YAAY,EAAhB;AACA,MAAIV,IAAJ,EAAU;AACR,QAAIJ,cAAJ,EAAoB;AAClB,UAAIe,UAAUd,eAAeG,KAAKI,KAAL,EAAf,CAAd;AACA,UAAIQ,WAAW,CAACD,OAAD,EAAUE,MAAV,CAAiBb,KAAKc,GAAL,CAAShB,SAAT,CAAjB,CAAf;AACAU,WAAKO,wBAAL,GAAgC,IAAhC;AACAL,kBAAY,CAAC,IAAD,EAAO,IAAP,EAAa,IAAb,EAAmBG,MAAnB,CAA0BD,QAA1B,CAAZ;AACD,KALD,MAKO;AACLF,gBAAUM,OAAV,CAAkB,IAAlB;AACAN,kBAAY,CAAC,IAAD,EAAOV,KAAKc,GAAL,CAAShB,SAAT,EAAoBmB,IAApB,CAAyB,GAAzB,EAA8BC,IAA9B,EAAP,CAAZ;AACD;AACF;;AAED,MAAIC,KAAK3B,IAAI4B,MAAJ,CAAWC,GAAX,CAAe,OAAf,CAAT;AACA1B,KAAG2B,IAAH,CAAQjB,GAAR,EAAa,UAAUkB,EAAV,EAAcC,CAAd,EAAiB;AAC5B,QAAID,MAAM,CAACC,EAAEC,WAAF,EAAX,EAA4B;AAC1B,aAAOxB,GAAG,IAAIyB,KAAJ,CACR,0BAA0BvB,CAA1B,GAA8B,gBADtB,CAAH,CAAP;AAGD;;AAED,QAAI,CAACO,UAAUR,MAAf,EAAuB;AACrBH,aACE,iBAAiBM,GAAjB,GAAuB,IAAvB,GACE,mCAFJ;AAID;;AAED,QAAIsB,QAAQlC,MAAM0B,EAAN,EAAUT,SAAV,EAAqBF,IAArB,CAAZ;AACAmB,UAAMC,EAAN,CAAS,OAAT,EAAkB,UAAUL,EAAV,EAAc;AAC9B;AACA,UAAI,CAACb,UAAUR,MAAf,EAAuB,OAAOD,IAAP;AACvBA,SAAGsB,EAAH;AACD,KAJD;AAKD,GApBD;AAqBD","file":"explore.js","sourcesContent":["// npm explore <pkg>[@<version>]\n// open a subshell to the package folder.\n\nmodule.exports = explore\nexplore.usage = 'npm explore <pkg> [ -- <command>]'\nexplore.completion = require('./utils/completion/installed-shallow.js')\n\nvar npm = require('./npm.js')\nvar spawn = require('./utils/spawn')\nvar path = require('path')\nvar fs = require('graceful-fs')\nvar isWindowsShell = require('./utils/is-windows-shell.js')\nvar escapeExecPath = require('./utils/escape-exec-path.js')\nvar escapeArg = require('./utils/escape-arg.js')\nvar output = require('./utils/output.js')\n\nfunction explore (args, cb) {\n  if (args.length < 1 || !args[0]) return cb(explore.usage)\n  var p = args.shift()\n\n  var cwd = path.resolve(npm.dir, p)\n  var opts = {cwd: cwd, stdio: 'inherit'}\n\n  var shellArgs = []\n  if (args) {\n    if (isWindowsShell) {\n      var execCmd = escapeExecPath(args.shift())\n      var execArgs = [execCmd].concat(args.map(escapeArg))\n      opts.windowsVerbatimArguments = true\n      shellArgs = ['/d', '/s', '/c'].concat(execArgs)\n    } else {\n      shellArgs.unshift('-c')\n      shellArgs = ['-c', args.map(escapeArg).join(' ').trim()]\n    }\n  }\n\n  var sh = npm.config.get('shell')\n  fs.stat(cwd, function (er, s) {\n    if (er || !s.isDirectory()) {\n      return cb(new Error(\n        \"It doesn't look like \" + p + ' is installed.'\n      ))\n    }\n\n    if (!shellArgs.length) {\n      output(\n        '\\nExploring ' + cwd + '\\n' +\n          \"Type 'exit' or ^D when finished\\n\"\n      )\n    }\n\n    var shell = spawn(sh, shellArgs, opts)\n    shell.on('close', function (er) {\n      // only fail if non-interactive.\n      if (!shellArgs.length) return cb()\n      cb(er)\n    })\n  })\n}\n"]}