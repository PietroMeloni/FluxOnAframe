{"version":3,"sources":["../../../../../node_modules/npm/lib/install/node.js"],"names":["defaultTemplate","package","version","dependencies","devDependencies","optionalDependencies","loaded","children","requiredBy","requires","missingDeps","missingDevDeps","phantomChildren","path","realpath","location","userRequired","save","saveSpec","isTop","fromBundle","isLink","node","isInLink","create","exports","template","isNotTop","Object","keys","forEach","key","Array","parent","reset","Set","seen","has","add","child","_id"],"mappings":"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","file":"node.js","sourcesContent":["'use strict'\n\nvar defaultTemplate = {\n  package: {\n    version: '',\n    dependencies: {},\n    devDependencies: {},\n    optionalDependencies: {}\n  },\n  loaded: false,\n  children: [],\n  requiredBy: [],\n  requires: [],\n  missingDeps: {},\n  missingDevDeps: {},\n  phantomChildren: {},\n  path: null,\n  realpath: null,\n  location: null,\n  userRequired: false,\n  save: false,\n  saveSpec: null,\n  isTop: false,\n  fromBundle: false\n}\n\nfunction isLink (node) {\n  return node && node.isLink\n}\nfunction isInLink (node) {\n  return node && (node.isInLink || node.isLink)\n}\n\nvar create = exports.create = function (node, template, isNotTop) {\n  if (!template) template = defaultTemplate\n  Object.keys(template).forEach(function (key) {\n    if (template[key] != null && typeof template[key] === 'object' && !(template[key] instanceof Array)) {\n      if (!node[key]) node[key] = {}\n      return create(node[key], template[key], true)\n    }\n    if (node[key] != null) return\n    node[key] = template[key]\n  })\n  if (!isNotTop) {\n    // isLink is true for the symlink and everything inside it.\n    // by contrast, isInLink is true for only the things inside a link\n    if (node.isLink == null) node.isLink = isLink(node.parent)\n    if (node.isInLink == null) node.isInLink = isInLink(node.parent)\n    if (node.fromBundle == null) {\n      node.fromBundle = false\n    }\n  }\n  return node\n}\n\nexports.reset = function (node) {\n  reset(node, new Set())\n}\n\nfunction reset (node, seen) {\n  if (seen.has(node)) return\n  seen.add(node)\n  var child = create(node)\n\n  // FIXME: cleaning up after read-package-json's mess =(\n  if (child.package._id === '@') delete child.package._id\n\n  child.isTop = false\n  child.requiredBy = []\n  child.requires = []\n  child.missingDeps = {}\n  child.missingDevDeps = {}\n  child.phantomChildren = {}\n  child.location = null\n\n  child.children.forEach(function (child) { reset(child, seen) })\n}\n"]}