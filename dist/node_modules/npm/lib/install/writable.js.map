{"version":3,"sources":["../../../../../node_modules/npm/lib/install/writable.js"],"names":["path","require","fs","inflight","accessError","andIgnoreErrors","isFsAccessAvailable","module","exports","fsAccessImplementation","fsOpenImplementation","dir","done","access","W_OK","tmp","join","open","er","fd","close","unlink"],"mappings":"AAAA;;AACA,IAAIA,OAAOC,QAAQ,MAAR,CAAX;AACA,IAAIC,KAAKD,QAAQ,IAAR,CAAT;AACA,IAAIE,WAAWF,QAAQ,UAAR,CAAf;AACA,IAAIG,cAAcH,QAAQ,mBAAR,CAAlB;AACA,IAAII,kBAAkBJ,QAAQ,wBAAR,CAAtB;AACA,IAAIK,sBAAsBL,QAAQ,6BAAR,CAA1B;;AAEA,IAAIK,mBAAJ,EAAyB;AACvBC,SAAOC,OAAP,GAAiBC,sBAAjB;AACD,CAFD,MAEO;AACLF,SAAOC,OAAP,GAAiBE,oBAAjB;AACD;;AAED;AACAH,OAAOC,OAAP,CAAeC,sBAAf,GAAwCA,sBAAxC;AACAF,OAAOC,OAAP,CAAeE,oBAAf,GAAsCA,oBAAtC;;AAEA,SAASD,sBAAT,CAAiCE,GAAjC,EAAsCC,IAAtC,EAA4C;AAC1CA,SAAOT,SAAS,cAAcQ,GAAvB,EAA4BC,IAA5B,CAAP;AACA,MAAI,CAACA,IAAL,EAAW;AACXV,KAAGW,MAAH,CAAUF,GAAV,EAAeT,GAAGY,IAAlB,EAAwBF,IAAxB;AACD;;AAED,SAASF,oBAAT,CAA+BC,GAA/B,EAAoCC,IAApC,EAA0C;AACxCA,SAAOT,SAAS,cAAcQ,GAAvB,EAA4BC,IAA5B,CAAP;AACA,MAAI,CAACA,IAAL,EAAW;AACX,MAAIG,MAAMf,KAAKgB,IAAL,CAAUL,GAAV,EAAe,wBAAf,CAAV;AACAT,KAAGe,IAAH,CAAQF,GAAR,EAAa,GAAb,EAAkB,UAAUG,EAAV,EAAcC,EAAd,EAAkB;AAClC,QAAID,EAAJ,EAAQ,OAAON,KAAKR,YAAYO,GAAZ,EAAiBO,EAAjB,CAAL,CAAP;AACRhB,OAAGkB,KAAH,CAASD,EAAT,EAAa,YAAY;AACvBjB,SAAGmB,MAAH,CAAUN,GAAV,EAAeV,gBAAgBO,IAAhB,CAAf;AACD,KAFD;AAGD,GALD;AAMD","file":"writable.js","sourcesContent":["'use strict'\nvar path = require('path')\nvar fs = require('fs')\nvar inflight = require('inflight')\nvar accessError = require('./access-error.js')\nvar andIgnoreErrors = require('./and-ignore-errors.js')\nvar isFsAccessAvailable = require('./is-fs-access-available.js')\n\nif (isFsAccessAvailable) {\n  module.exports = fsAccessImplementation\n} else {\n  module.exports = fsOpenImplementation\n}\n\n// exposed only for testing purposes\nmodule.exports.fsAccessImplementation = fsAccessImplementation\nmodule.exports.fsOpenImplementation = fsOpenImplementation\n\nfunction fsAccessImplementation (dir, done) {\n  done = inflight('writable:' + dir, done)\n  if (!done) return\n  fs.access(dir, fs.W_OK, done)\n}\n\nfunction fsOpenImplementation (dir, done) {\n  done = inflight('writable:' + dir, done)\n  if (!done) return\n  var tmp = path.join(dir, '.npm.check.permissions')\n  fs.open(tmp, 'w', function (er, fd) {\n    if (er) return done(accessError(dir, er))\n    fs.close(fd, function () {\n      fs.unlink(tmp, andIgnoreErrors(done))\n    })\n  })\n}\n"]}