{"version":3,"sources":["../../../../../node_modules/npm/lib/config/core.js"],"names":["CC","require","ConfigChain","inherits","configDefs","types","once","fs","path","nopt","ini","Umask","mkdirp","umask","isWindows","exports","load","Conf","loaded","rootConf","usingBuiltin","defs","Object","defineProperty","get","defaults","enumerable","validate","myUid","process","env","SUDO_UID","undefined","getuid","myGid","SUDO_GID","getgid","loading","loadCbs","cli","builtin","cb","i","arguments","length","ret","unshift","nextTick","bind","keys","reduce","c","k","push","er","conf","forEach","fn","rc","addFile","add","on","load_","addEnv","loadPrefix","projectConf","resolve","localPrefix","defaultUserConfig","resolvedUserConfig","afterPrefix","afterUser","etc","globalconfig","globalignorefile","root","shift","loadExtras","afterExtras","cafile","loadCAFile","finalize","base","call","list","prototype","loadUid","setUser","getCredentialsByURI","setCredentialsByURI","clearCredentialsByURI","prefix","save","where","target","sources","source","data","Error","emit","pref","stringify","then","done","chmod","mode","_saving","trim","unlink","dirname","writeFile","chown","file","name","marker","__source__","type","_await","readFile","addString","parse","content","newKey","envReplace","newField","parseField","e","filter","match","p","toLowerCase","replace","f","String","typeList","concat","isPath","indexOf","isBool","Boolean","isString","isUmask","isNumber","Number","JSON","homePattern","HOME","substr","fromString","isNaN","envExpr","orig","esc","cl","clean"],"mappings":"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","file":"core.js","sourcesContent":["var CC = require('config-chain').ConfigChain\nvar inherits = require('inherits')\nvar configDefs = require('./defaults.js')\nvar types = configDefs.types\nvar once = require('once')\nvar fs = require('fs')\nvar path = require('path')\nvar nopt = require('nopt')\nvar ini = require('ini')\nvar Umask = configDefs.Umask\nvar mkdirp = require('mkdirp')\nvar umask = require('../utils/umask')\nvar isWindows = require('../utils/is-windows.js')\n\nexports.load = load\nexports.Conf = Conf\nexports.loaded = false\nexports.rootConf = null\nexports.usingBuiltin = false\nexports.defs = configDefs\n\nObject.defineProperty(exports, 'defaults', { get: function () {\n  return configDefs.defaults\n},\nenumerable: true })\n\nObject.defineProperty(exports, 'types', { get: function () {\n  return configDefs.types\n},\nenumerable: true })\n\nexports.validate = validate\n\nvar myUid = process.env.SUDO_UID !== undefined\n  ? process.env.SUDO_UID : (process.getuid && process.getuid())\nvar myGid = process.env.SUDO_GID !== undefined\n  ? process.env.SUDO_GID : (process.getgid && process.getgid())\n\nvar loading = false\nvar loadCbs = []\nfunction load () {\n  var cli, builtin, cb\n  for (var i = 0; i < arguments.length; i++) {\n    switch (typeof arguments[i]) {\n      case 'string': builtin = arguments[i]; break\n      case 'object': cli = arguments[i]; break\n      case 'function': cb = arguments[i]; break\n    }\n  }\n\n  if (!cb) cb = function () {}\n\n  if (exports.loaded) {\n    var ret = exports.loaded\n    if (cli) {\n      ret = new Conf(ret)\n      ret.unshift(cli)\n    }\n    return process.nextTick(cb.bind(null, null, ret))\n  }\n\n  // either a fresh object, or a clone of the passed in obj\n  if (!cli) {\n    cli = {}\n  } else {\n    cli = Object.keys(cli).reduce(function (c, k) {\n      c[k] = cli[k]\n      return c\n    }, {})\n  }\n\n  loadCbs.push(cb)\n  if (loading) return\n\n  loading = true\n\n  cb = once(function (er, conf) {\n    if (!er) {\n      exports.loaded = conf\n      loading = false\n    }\n    loadCbs.forEach(function (fn) {\n      fn(er, conf)\n    })\n    loadCbs.length = 0\n  })\n\n  // check for a builtin if provided.\n  exports.usingBuiltin = !!builtin\n  var rc = exports.rootConf = new Conf()\n  if (builtin) {\n    rc.addFile(builtin, 'builtin')\n  } else {\n    rc.add({}, 'builtin')\n  }\n\n  rc.on('load', function () {\n    load_(builtin, rc, cli, cb)\n  })\n  rc.on('error', cb)\n}\n\nfunction load_ (builtin, rc, cli, cb) {\n  var defaults = configDefs.defaults\n  var conf = new Conf(rc)\n\n  conf.usingBuiltin = !!builtin\n  conf.add(cli, 'cli')\n  conf.addEnv()\n\n  conf.loadPrefix(function (er) {\n    if (er) return cb(er)\n\n    // If you're doing `npm --userconfig=~/foo.npmrc` then you'd expect\n    // that ~/.npmrc won't override the stuff in ~/foo.npmrc (or, indeed\n    // be used at all).\n    //\n    // However, if the cwd is ~, then ~/.npmrc is the home for the project\n    // config, and will override the userconfig.\n    //\n    // If you're not setting the userconfig explicitly, then it will be loaded\n    // twice, which is harmless but excessive.  If you *are* setting the\n    // userconfig explicitly then it will override your explicit intent, and\n    // that IS harmful and unexpected.\n    //\n    // Solution: Do not load project config file that is the same as either\n    // the default or resolved userconfig value.  npm will log a \"verbose\"\n    // message about this when it happens, but it is a rare enough edge case\n    // that we don't have to be super concerned about it.\n    var projectConf = path.resolve(conf.localPrefix, '.npmrc')\n    var defaultUserConfig = rc.get('userconfig')\n    var resolvedUserConfig = conf.get('userconfig')\n    if (!conf.get('global') &&\n        projectConf !== defaultUserConfig &&\n        projectConf !== resolvedUserConfig) {\n      conf.addFile(projectConf, 'project')\n      conf.once('load', afterPrefix)\n    } else {\n      conf.add({}, 'project')\n      afterPrefix()\n    }\n  })\n\n  function afterPrefix () {\n    conf.addFile(conf.get('userconfig'), 'user')\n    conf.once('error', cb)\n    conf.once('load', afterUser)\n  }\n\n  function afterUser () {\n    // globalconfig and globalignorefile defaults\n    // need to respond to the 'prefix' setting up to this point.\n    // Eg, `npm config get globalconfig --prefix ~/local` should\n    // return `~/local/etc/npmrc`\n    // annoying humans and their expectations!\n    if (conf.get('prefix')) {\n      var etc = path.resolve(conf.get('prefix'), 'etc')\n      defaults.globalconfig = path.resolve(etc, 'npmrc')\n      defaults.globalignorefile = path.resolve(etc, 'npmignore')\n    }\n\n    conf.addFile(conf.get('globalconfig'), 'global')\n\n    // move the builtin into the conf stack now.\n    conf.root = defaults\n    conf.add(rc.shift(), 'builtin')\n    conf.once('load', function () {\n      conf.loadExtras(afterExtras)\n    })\n  }\n\n  function afterExtras (er) {\n    if (er) return cb(er)\n\n    // warn about invalid bits.\n    validate(conf)\n\n    var cafile = conf.get('cafile')\n\n    if (cafile) {\n      return conf.loadCAFile(cafile, finalize)\n    }\n\n    finalize()\n  }\n\n  function finalize (er) {\n    if (er) {\n      return cb(er)\n    }\n\n    exports.loaded = conf\n    cb(er, conf)\n  }\n}\n\n// Basically the same as CC, but:\n// 1. Always ini\n// 2. Parses environment variable names in field values\n// 3. Field values that start with ~/ are replaced with process.env.HOME\n// 4. Can inherit from another Conf object, using it as the base.\ninherits(Conf, CC)\nfunction Conf (base) {\n  if (!(this instanceof Conf)) return new Conf(base)\n\n  CC.call(this)\n\n  if (base) {\n    if (base instanceof Conf) {\n      this.root = base.list[0] || base.root\n    } else {\n      this.root = base\n    }\n  } else {\n    this.root = configDefs.defaults\n  }\n}\n\nConf.prototype.loadPrefix = require('./load-prefix.js')\nConf.prototype.loadCAFile = require('./load-cafile.js')\nConf.prototype.loadUid = require('./load-uid.js')\nConf.prototype.setUser = require('./set-user.js')\nConf.prototype.getCredentialsByURI = require('./get-credentials-by-uri.js')\nConf.prototype.setCredentialsByURI = require('./set-credentials-by-uri.js')\nConf.prototype.clearCredentialsByURI = require('./clear-credentials-by-uri.js')\n\nConf.prototype.loadExtras = function (cb) {\n  this.setUser(function (er) {\n    if (er) return cb(er)\n    this.loadUid(function (er) {\n      if (er) return cb(er)\n      // Without prefix, nothing will ever work\n      mkdirp(this.prefix, cb)\n    }.bind(this))\n  }.bind(this))\n}\n\nConf.prototype.save = function (where, cb) {\n  var target = this.sources[where]\n  if (!target || !(target.path || target.source) || !target.data) {\n    var er\n    if (where !== 'builtin') er = new Error('bad save target: ' + where)\n    if (cb) {\n      process.nextTick(cb.bind(null, er))\n      return this\n    }\n    return this.emit('error', er)\n  }\n\n  if (target.source) {\n    var pref = target.prefix || ''\n    Object.keys(target.data).forEach(function (k) {\n      target.source[pref + k] = target.data[k]\n    })\n    if (cb) process.nextTick(cb)\n    return this\n  }\n\n  var data = ini.stringify(target.data)\n\n  var then = function then (er) {\n    if (er) return done(er)\n\n    fs.chmod(target.path, mode, done)\n  }\n\n  var done = function done (er) {\n    if (er) {\n      if (cb) return cb(er)\n      else return this.emit('error', er)\n    }\n    this._saving--\n    if (this._saving === 0) {\n      if (cb) cb()\n      this.emit('save')\n    }\n  }\n\n  then = then.bind(this)\n  done = done.bind(this)\n  this._saving++\n\n  var mode = where === 'user' ? '0600' : '0666'\n  if (!data.trim()) {\n    fs.unlink(target.path, function () {\n      // ignore the possible error (e.g. the file doesn't exist)\n      done(null)\n    })\n  } else {\n    mkdirp(path.dirname(target.path), function (er) {\n      if (er) return then(er)\n      fs.writeFile(target.path, data, 'utf8', function (er) {\n        if (er) return then(er)\n        if (where === 'user' && myUid && myGid) {\n          fs.chown(target.path, +myUid, +myGid, then)\n        } else {\n          then()\n        }\n      })\n    })\n  }\n\n  return this\n}\n\nConf.prototype.addFile = function (file, name) {\n  name = name || file\n  var marker = { __source__: name }\n  this.sources[name] = { path: file, type: 'ini' }\n  this.push(marker)\n  this._await()\n  fs.readFile(file, 'utf8', function (er, data) {\n    // just ignore missing files.\n    if (er) return this.add({}, marker)\n\n    this.addString(data, file, 'ini', marker)\n  }.bind(this))\n  return this\n}\n\n// always ini files.\nConf.prototype.parse = function (content, file) {\n  return CC.prototype.parse.call(this, content, file, 'ini')\n}\n\nConf.prototype.add = function (data, marker) {\n  try {\n    Object.keys(data).forEach(function (k) {\n      const newKey = envReplace(k)\n      const newField = parseField(data[k], newKey)\n      delete data[k]\n      data[newKey] = newField\n    })\n  } catch (e) {\n    this.emit('error', e)\n    return this\n  }\n  return CC.prototype.add.call(this, data, marker)\n}\n\nConf.prototype.addEnv = function (env) {\n  env = env || process.env\n  var conf = {}\n  Object.keys(env)\n    .filter(function (k) { return k.match(/^npm_config_/i) })\n    .forEach(function (k) {\n      if (!env[k]) return\n\n      // leave first char untouched, even if\n      // it is a '_' - convert all other to '-'\n      var p = k.toLowerCase()\n        .replace(/^npm_config_/, '')\n        .replace(/(?!^)_/g, '-')\n      conf[p] = env[k]\n    })\n  return CC.prototype.addEnv.call(this, '', conf, 'env')\n}\n\nfunction parseField (f, k) {\n  if (typeof f !== 'string' && !(f instanceof String)) return f\n\n  // type can be an array or single thing.\n  var typeList = [].concat(types[k])\n  var isPath = typeList.indexOf(path) !== -1\n  var isBool = typeList.indexOf(Boolean) !== -1\n  var isString = typeList.indexOf(String) !== -1\n  var isUmask = typeList.indexOf(Umask) !== -1\n  var isNumber = typeList.indexOf(Number) !== -1\n\n  f = ('' + f).trim()\n\n  if (f.match(/^\".*\"$/)) {\n    try {\n      f = JSON.parse(f)\n    } catch (e) {\n      throw new Error('Failed parsing JSON config key ' + k + ': ' + f)\n    }\n  }\n\n  if (isBool && !isString && f === '') return true\n\n  switch (f) {\n    case 'true': return true\n    case 'false': return false\n    case 'null': return null\n    case 'undefined': return undefined\n  }\n\n  f = envReplace(f)\n\n  if (isPath) {\n    var homePattern = isWindows ? /^~(\\/|\\\\)/ : /^~\\//\n    if (f.match(homePattern) && process.env.HOME) {\n      f = path.resolve(process.env.HOME, f.substr(2))\n    }\n    f = path.resolve(f)\n  }\n\n  if (isUmask) f = umask.fromString(f)\n\n  if (isNumber && !isNaN(f)) f = +f\n\n  return f\n}\n\nfunction envReplace (f) {\n  if (typeof f !== 'string' || !f) return f\n\n  // replace any ${ENV} values with the appropriate environ.\n  var envExpr = /(\\\\*)\\$\\{([^}]+)\\}/g\n  return f.replace(envExpr, function (orig, esc, name) {\n    esc = esc.length && esc.length % 2\n    if (esc) return orig\n    if (undefined === process.env[name]) {\n      throw new Error('Failed to replace env in config: ' + orig)\n    }\n\n    return process.env[name]\n  })\n}\n\nfunction validate (cl) {\n  // warn about invalid configs at every level.\n  cl.list.forEach(function (conf) {\n    nopt.clean(conf, configDefs.types)\n  })\n\n  nopt.clean(cl.root, configDefs.types)\n}\n"]}