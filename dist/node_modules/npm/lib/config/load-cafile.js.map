{"version":3,"sources":["../../../../../node_modules/npm/lib/config/load-cafile.js"],"names":["module","exports","loadCAFile","fs","require","cafilePath","cb","process","nextTick","readFile","afterCARead","bind","er","cadata","code","delim","output","split","filter","xs","trim","map","trimLeft","set"],"mappings":";;AAAAA,OAAOC,OAAP,GAAiBC,UAAjB;;AAEA,IAAIC,KAAKC,QAAQ,IAAR,CAAT;;AAEA,SAASF,UAAT,CAAqBG,UAArB,EAAiCC,EAAjC,EAAqC;AACnC,MAAI,CAACD,UAAL,EAAiB,OAAOE,QAAQC,QAAR,CAAiBF,EAAjB,CAAP;;AAEjBH,KAAGM,QAAH,CAAYJ,UAAZ,EAAwB,MAAxB,EAAgCK,YAAYC,IAAZ,CAAiB,IAAjB,CAAhC;;AAEA,WAASD,WAAT,CAAsBE,EAAtB,EAA0BC,MAA1B,EAAkC;AAChC,QAAID,EAAJ,EAAQ;AACN;AACA,UAAIA,GAAGE,IAAH,KAAY,QAAhB,EAA0B,OAAOR,IAAP;AAC1B,aAAOA,GAAGM,EAAH,CAAP;AACD;;AAED,QAAIG,QAAQ,2BAAZ;AACA,QAAIC,MAAJ;;AAEAA,aAASH,OACNI,KADM,CACAF,KADA,EAENG,MAFM,CAEC,UAAUC,EAAV,EAAc;AACpB,aAAO,CAAC,CAACA,GAAGC,IAAH,EAAT;AACD,KAJM,EAKNC,GALM,CAKF,UAAUF,EAAV,EAAc;AACjB,aAAOA,GAAGG,QAAH,KAAgBP,KAAvB;AACD,KAPM,CAAT;;AASA,SAAKQ,GAAL,CAAS,IAAT,EAAeP,MAAf;AACAV,OAAG,IAAH;AACD;AACF","file":"load-cafile.js","sourcesContent":["module.exports = loadCAFile\n\nvar fs = require('fs')\n\nfunction loadCAFile (cafilePath, cb) {\n  if (!cafilePath) return process.nextTick(cb)\n\n  fs.readFile(cafilePath, 'utf8', afterCARead.bind(this))\n\n  function afterCARead (er, cadata) {\n    if (er) {\n      // previous cafile no longer exists, so just continue on gracefully\n      if (er.code === 'ENOENT') return cb()\n      return cb(er)\n    }\n\n    var delim = '-----END CERTIFICATE-----'\n    var output\n\n    output = cadata\n      .split(delim)\n      .filter(function (xs) {\n        return !!xs.trim()\n      })\n      .map(function (xs) {\n        return xs.trimLeft() + delim\n      })\n\n    this.set('ca', output)\n    cb(null)\n  }\n}\n"]}