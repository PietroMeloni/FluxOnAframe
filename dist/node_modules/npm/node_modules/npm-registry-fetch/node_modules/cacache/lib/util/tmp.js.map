{"version":3,"sources":["../../../../../../../../../node_modules/npm/node_modules/npm-registry-fetch/node_modules/cacache/lib/util/tmp.js"],"names":["BB","require","fixOwner","path","rimraf","promisify","uniqueFilename","module","exports","mkdir","mktmpdir","cache","opts","tmpTarget","join","tmpPrefix","mkdirfix","uid","gid","then","withTmp","cb","using","disposer","fix","fixtmpdir"],"mappings":"AAAA;;AAEA,IAAMA,KAAKC,QAAQ,UAAR,CAAX;;AAEA,IAAMC,WAAWD,QAAQ,aAAR,CAAjB;AACA,IAAME,OAAOF,QAAQ,MAAR,CAAb;AACA,IAAMG,SAASJ,GAAGK,SAAH,CAAaJ,QAAQ,QAAR,CAAb,CAAf;AACA,IAAMK,iBAAiBL,QAAQ,iBAAR,CAAvB;;AAEAM,OAAOC,OAAP,CAAeC,KAAf,GAAuBC,QAAvB;AACA,SAASA,QAAT,CAAmBC,KAAnB,EAA0BC,IAA1B,EAAgC;AAC9BA,SAAOA,QAAQ,EAAf;AACA,MAAMC,YAAYP,eAAeH,KAAKW,IAAL,CAAUH,KAAV,EAAiB,KAAjB,CAAf,EAAwCC,KAAKG,SAA7C,CAAlB;AACA,SAAOb,SAASc,QAAT,CAAkBH,SAAlB,EAA6BD,KAAKK,GAAlC,EAAuCL,KAAKM,GAA5C,EAAiDC,IAAjD,CAAsD,YAAM;AACjE,WAAON,SAAP;AACD,GAFM,CAAP;AAGD;;AAEDN,OAAOC,OAAP,CAAeY,OAAf,GAAyBA,OAAzB;AACA,SAASA,OAAT,CAAkBT,KAAlB,EAAyBC,IAAzB,EAA+BS,EAA/B,EAAmC;AACjC,MAAI,CAACA,EAAL,EAAS;AACPA,SAAKT,IAAL;AACAA,WAAO,IAAP;AACD;AACDA,SAAOA,QAAQ,EAAf;AACA,SAAOZ,GAAGsB,KAAH,CAASZ,SAASC,KAAT,EAAgBC,IAAhB,EAAsBW,QAAtB,CAA+BnB,MAA/B,CAAT,EAAiDiB,EAAjD,CAAP;AACD;;AAEDd,OAAOC,OAAP,CAAegB,GAAf,GAAqBC,SAArB;AACA,SAASA,SAAT,CAAoBd,KAApB,EAA2BC,IAA3B,EAAiC;AAC/B,SAAOV,SAASC,KAAKW,IAAL,CAAUH,KAAV,EAAiB,KAAjB,CAAT,EAAkCC,KAAKK,GAAvC,EAA4CL,KAAKM,GAAjD,CAAP;AACD","file":"tmp.js","sourcesContent":["'use strict'\n\nconst BB = require('bluebird')\n\nconst fixOwner = require('./fix-owner')\nconst path = require('path')\nconst rimraf = BB.promisify(require('rimraf'))\nconst uniqueFilename = require('unique-filename')\n\nmodule.exports.mkdir = mktmpdir\nfunction mktmpdir (cache, opts) {\n  opts = opts || {}\n  const tmpTarget = uniqueFilename(path.join(cache, 'tmp'), opts.tmpPrefix)\n  return fixOwner.mkdirfix(tmpTarget, opts.uid, opts.gid).then(() => {\n    return tmpTarget\n  })\n}\n\nmodule.exports.withTmp = withTmp\nfunction withTmp (cache, opts, cb) {\n  if (!cb) {\n    cb = opts\n    opts = null\n  }\n  opts = opts || {}\n  return BB.using(mktmpdir(cache, opts).disposer(rimraf), cb)\n}\n\nmodule.exports.fix = fixtmpdir\nfunction fixtmpdir (cache, opts) {\n  return fixOwner(path.join(cache, 'tmp'), opts.uid, opts.gid)\n}\n"]}