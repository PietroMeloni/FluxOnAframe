{"version":3,"sources":["../../../../../../../node_modules/npm/node_modules/promzard/example/npm-init/init-input.js"],"names":["fs","require","path","module","exports","prompt","name","basename","replace","version","description","value","src","readFileSync","split","filter","line","test","trim","match","c","toLowerCase","e","d","f","readdirSync","dirname","indexOf","cb","readdir","er","dirs","res","forEach","example","doc","man","Object","keys","length","undefined","dependencies","dir","deps","n","next","readFile","p","JSON","parse","devDependencies","s","scripts","prepublish","notest","tx","gconf","i","u","Array","isArray","join","config"],"mappings":"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","file":"init-input.js","sourcesContent":["var fs = require('fs')\nvar path = require('path');\n\nmodule.exports = {\n  \"name\" : prompt('name',\n    typeof name === 'undefined'\n    ? basename.replace(/^node-|[.-]js$/g, ''): name),\n  \"version\" : prompt('version', typeof version !== \"undefined\"\n                              ? version : '0.0.0'),\n  \"description\" : (function () {\n      if (typeof description !== 'undefined' && description) {\n        return description\n      }\n      var value;\n      try {\n          var src = fs.readFileSync('README.md', 'utf8');\n          value = src.split('\\n').filter(function (line) {\n              return /\\s+/.test(line)\n                  && line.trim() !== basename.replace(/^node-/, '')\n                  && !line.trim().match(/^#/)\n              ;\n          })[0]\n              .trim()\n              .replace(/^./, function (c) { return c.toLowerCase() })\n              .replace(/\\.$/, '')\n          ;\n      }\n      catch (e) {\n        try {\n          // Wouldn't it be nice if that file mattered?\n          var d = fs.readFileSync('.git/description', 'utf8')\n        } catch (e) {}\n        if (d.trim() && !value) value = d\n      }\n      return prompt('description', value);\n  })(),\n  \"main\" : (function () {\n    var f\n    try {\n      f = fs.readdirSync(dirname).filter(function (f) {\n        return f.match(/\\.js$/)\n      })\n      if (f.indexOf('index.js') !== -1)\n        f = 'index.js'\n      else if (f.indexOf('main.js') !== -1)\n        f = 'main.js'\n      else if (f.indexOf(basename + '.js') !== -1)\n        f = basename + '.js'\n      else\n        f = f[0]\n    } catch (e) {}\n\n    return prompt('entry point', f || 'index.js')\n  })(),\n  \"bin\" : function (cb) {\n    fs.readdir(dirname + '/bin', function (er, d) {\n      // no bins\n      if (er) return cb()\n      // just take the first js file we find there, or nada\n      return cb(null, d.filter(function (f) {\n        return f.match(/\\.js$/)\n      })[0])\n    })\n  },\n  \"directories\" : function (cb) {\n    fs.readdir('.', function (er, dirs) {\n      if (er) return cb(er)\n      var res = {}\n      dirs.forEach(function (d) {\n        switch (d) {\n          case 'example': case 'examples': return res.example = d\n          case 'test': case 'tests': return res.test = d\n          case 'doc': case 'docs': return res.doc = d\n          case 'man': return res.man = d\n        }\n      })\n      if (Object.keys(res).length === 0) res = undefined\n      return cb(null, res)\n    })\n  },\n  \"dependencies\" : typeof dependencies !== 'undefined' ? dependencies\n    : function (cb) {\n      fs.readdir('node_modules', function (er, dir) {\n        if (er) return cb()\n        var deps = {}\n        var n = dir.length\n        dir.forEach(function (d) {\n          if (d.match(/^\\./)) return next()\n          if (d.match(/^(expresso|mocha|tap|coffee-script|coco|streamline)$/))\n            return next()\n          fs.readFile('node_modules/' + d + '/package.json', function (er, p) {\n            if (er) return next()\n            try { p = JSON.parse(p) } catch (e) { return next() }\n            if (!p.version) return next()\n            deps[d] = '~' + p.version\n            return next()\n          })\n        })\n        function next () {\n          if (--n === 0) return cb(null, deps)\n        }\n      })\n    },\n  \"devDependencies\" : typeof devDependencies !== 'undefined' ? devDependencies\n    : function (cb) {\n      // same as dependencies but for dev deps\n      fs.readdir('node_modules', function (er, dir) {\n        if (er) return cb()\n        var deps = {}\n        var n = dir.length\n        dir.forEach(function (d) {\n          if (d.match(/^\\./)) return next()\n          if (!d.match(/^(expresso|mocha|tap|coffee-script|coco|streamline)$/))\n            return next()\n          fs.readFile('node_modules/' + d + '/package.json', function (er, p) {\n            if (er) return next()\n            try { p = JSON.parse(p) } catch (e) { return next() }\n            if (!p.version) return next()\n            deps[d] = '~' + p.version\n            return next()\n          })\n        })\n        function next () {\n          if (--n === 0) return cb(null, deps)\n        }\n      })\n    },\n  \"scripts\" : (function () {\n    // check to see what framework is in use, if any\n    try { var d = fs.readdirSync('node_modules') }\n    catch (e) { d = [] }\n    var s = typeof scripts === 'undefined' ? {} : scripts\n\n    if (d.indexOf('coffee-script') !== -1)\n      s.prepublish = prompt('build command',\n                            s.prepublish || 'coffee src/*.coffee -o lib')\n\n    var notest = 'echo \"Error: no test specified\" && exit 1'\n    function tx (test) {\n      return test || notest\n    }\n\n    if (!s.test || s.test === notest) {\n      if (d.indexOf('tap') !== -1)\n        s.test = prompt('test command', 'tap test/*.js', tx)\n      else if (d.indexOf('expresso') !== -1)\n        s.test = prompt('test command', 'expresso test', tx)\n      else if (d.indexOf('mocha') !== -1)\n        s.test = prompt('test command', 'mocha', tx)\n      else\n        s.test = prompt('test command', tx)\n    }\n\n    return s\n\n  })(),\n\n  \"repository\" : (function () {\n    try { var gconf = fs.readFileSync('.git/config') }\n    catch (e) { gconf = null }\n    if (gconf) {\n      gconf = gconf.split(/\\r?\\n/)\n      var i = gconf.indexOf('[remote \"origin\"]')\n      if (i !== -1) {\n        var u = gconf[i + 1]\n        if (!u.match(/^\\s*url =/)) u = gconf[i + 2]\n        if (!u.match(/^\\s*url =/)) u = null\n        else u = u.replace(/^\\s*url = /, '')\n      }\n      if (u && u.match(/^git@github.com:/))\n        u = u.replace(/^git@github.com:/, 'git://github.com/')\n    }\n\n    return prompt('git repository', u)\n  })(),\n\n  \"keywords\" : prompt(function (s) {\n    if (!s) return undefined\n    if (Array.isArray(s)) s = s.join(' ')\n    if (typeof s !== 'string') return s\n    return s.split(/[\\s,]+/)\n  }),\n  \"author\" : config['init.author.name']\n    ? {\n        \"name\" : config['init.author.name'],\n        \"email\" : config['init.author.email'],\n        \"url\" : config['init.author.url']\n      }\n    : undefined,\n  \"license\" : prompt('license', 'BSD')\n}\n"]}