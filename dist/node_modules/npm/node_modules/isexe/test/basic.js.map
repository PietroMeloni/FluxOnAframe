{"version":3,"sources":["../../../../../../node_modules/npm/node_modules/isexe/test/basic.js"],"names":["t","require","fs","path","fixture","resolve","__dirname","meow","mine","ours","fail","noent","mkdirp","rimraf","isWindows","process","platform","hasAccess","access","winSkip","accessSkip","hasPromise","Promise","promiseSkip","reset","cache","test","sync","writeFileSync","chmodSync","parseInt","end","skip","isexe","then","is","ok","notOk","catch","er","ignoreErrors","global","throws","runTest","accessSync","uid","gid","TESTING_WINDOWS","pathExt","env","PATHEXT","skipFail","options","optionsIgnore","Object","create"],"mappings":"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","file":"basic.js","sourcesContent":["var t = require('tap')\nvar fs = require('fs')\nvar path = require('path')\nvar fixture = path.resolve(__dirname, 'fixtures')\nvar meow = fixture + '/meow.cat'\nvar mine = fixture + '/mine.cat'\nvar ours = fixture + '/ours.cat'\nvar fail = fixture + '/fail.false'\nvar noent = fixture + '/enoent.exe'\nvar mkdirp = require('mkdirp')\nvar rimraf = require('rimraf')\n\nvar isWindows = process.platform === 'win32'\nvar hasAccess = typeof fs.access === 'function'\nvar winSkip = isWindows && 'windows'\nvar accessSkip = !hasAccess && 'no fs.access function'\nvar hasPromise = typeof Promise === 'function'\nvar promiseSkip = !hasPromise && 'no global Promise'\n\nfunction reset () {\n  delete require.cache[require.resolve('../')]\n  return require('../')\n}\n\nt.test('setup fixtures', function (t) {\n  rimraf.sync(fixture)\n  mkdirp.sync(fixture)\n  fs.writeFileSync(meow, '#!/usr/bin/env cat\\nmeow\\n')\n  fs.chmodSync(meow, parseInt('0755', 8))\n  fs.writeFileSync(fail, '#!/usr/bin/env false\\n')\n  fs.chmodSync(fail, parseInt('0644', 8))\n  fs.writeFileSync(mine, '#!/usr/bin/env cat\\nmine\\n')\n  fs.chmodSync(mine, parseInt('0744', 8))\n  fs.writeFileSync(ours, '#!/usr/bin/env cat\\nours\\n')\n  fs.chmodSync(ours, parseInt('0754', 8))\n  t.end()\n})\n\nt.test('promise', { skip: promiseSkip }, function (t) {\n  var isexe = reset()\n  t.test('meow async', function (t) {\n    isexe(meow).then(function (is) {\n      t.ok(is)\n      t.end()\n    })\n  })\n  t.test('fail async', function (t) {\n    isexe(fail).then(function (is) {\n      t.notOk(is)\n      t.end()\n    })\n  })\n  t.test('noent async', function (t) {\n    isexe(noent).catch(function (er) {\n      t.ok(er)\n      t.end()\n    })\n  })\n  t.test('noent ignore async', function (t) {\n    isexe(noent, { ignoreErrors: true }).then(function (is) {\n      t.notOk(is)\n      t.end()\n    })\n  })\n  t.end()\n})\n\nt.test('no promise', function (t) {\n  global.Promise = null\n  var isexe = reset()\n  t.throws('try to meow a promise', function () {\n    isexe(meow)\n  })\n  t.end()\n})\n\nt.test('access', { skip: accessSkip || winSkip }, function (t) {\n  runTest(t)\n})\n\nt.test('mode', { skip: winSkip }, function (t) {\n  delete fs.access\n  delete fs.accessSync\n  var isexe = reset()\n  t.ok(isexe.sync(ours, { uid: 0, gid: 0 }))\n  t.ok(isexe.sync(mine, { uid: 0, gid: 0 }))\n  runTest(t)\n})\n\nt.test('windows', function (t) {\n  global.TESTING_WINDOWS = true\n  var pathExt = '.EXE;.CAT;.CMD;.COM'\n  t.test('pathExt option', function (t) {\n    runTest(t, { pathExt: '.EXE;.CAT;.CMD;.COM' })\n  })\n  t.test('pathExt env', function (t) {\n    process.env.PATHEXT = pathExt\n    runTest(t)\n  })\n  t.test('no pathExt', function (t) {\n    // with a pathExt of '', any filename is fine.\n    // so the \"fail\" one would still pass.\n    runTest(t, { pathExt: '', skipFail: true })\n  })\n  t.test('pathext with empty entry', function (t) {\n    // with a pathExt of '', any filename is fine.\n    // so the \"fail\" one would still pass.\n    runTest(t, { pathExt: ';' + pathExt, skipFail: true })\n  })\n  t.end()\n})\n\nt.test('cleanup', function (t) {\n  rimraf.sync(fixture)\n  t.end()\n})\n\nfunction runTest (t, options) {\n  var isexe = reset()\n\n  var optionsIgnore = Object.create(options || {})\n  optionsIgnore.ignoreErrors = true\n\n  if (!options || !options.skipFail) {\n    t.notOk(isexe.sync(fail, options))\n  }\n  t.notOk(isexe.sync(noent, optionsIgnore))\n  if (!options) {\n    t.ok(isexe.sync(meow))\n  } else {\n    t.ok(isexe.sync(meow, options))\n  }\n\n  t.ok(isexe.sync(mine, options))\n  t.ok(isexe.sync(ours, options))\n  t.throws(function () {\n    isexe.sync(noent, options)\n  })\n\n  t.test('meow async', function (t) {\n    if (!options) {\n      isexe(meow, function (er, is) {\n        if (er) {\n          throw er\n        }\n        t.ok(is)\n        t.end()\n      })\n    } else {\n      isexe(meow, options, function (er, is) {\n        if (er) {\n          throw er\n        }\n        t.ok(is)\n        t.end()\n      })\n    }\n  })\n\n  t.test('mine async', function (t) {\n    isexe(mine, options, function (er, is) {\n      if (er) {\n        throw er\n      }\n      t.ok(is)\n      t.end()\n    })\n  })\n\n  t.test('ours async', function (t) {\n    isexe(ours, options, function (er, is) {\n      if (er) {\n        throw er\n      }\n      t.ok(is)\n      t.end()\n    })\n  })\n\n  if (!options || !options.skipFail) {\n    t.test('fail async', function (t) {\n      isexe(fail, options, function (er, is) {\n        if (er) {\n          throw er\n        }\n        t.notOk(is)\n        t.end()\n      })\n    })\n  }\n\n  t.test('noent async', function (t) {\n    isexe(noent, options, function (er, is) {\n      t.ok(er)\n      t.notOk(is)\n      t.end()\n    })\n  })\n\n  t.test('noent ignore async', function (t) {\n    isexe(noent, optionsIgnore, function (er, is) {\n      if (er) {\n        throw er\n      }\n      t.notOk(is)\n      t.end()\n    })\n  })\n\n  t.test('directory is not executable', function (t) {\n    isexe(__dirname, options, function (er, is) {\n      if (er) {\n        throw er\n      }\n      t.notOk(is)\n      t.end()\n    })\n  })\n\n  t.end()\n}\n"]}