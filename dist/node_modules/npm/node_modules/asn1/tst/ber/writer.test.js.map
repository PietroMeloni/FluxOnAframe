{"version":3,"sources":["../../../../../../../node_modules/npm/node_modules/asn1/tst/ber/writer.test.js"],"names":["test","require","sys","BerWriter","BerReader","t","ok","end","writer","writeByte","ber","buffer","equal","length","writeInt","writeBoolean","writeString","slice","toString","buf","Buffer","writeBuffer","i","j","writeStringArray","size","startSequence","endSequence","console","log","dn","oid","writeOID","inspect"],"mappings":"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","file":"writer.test.js","sourcesContent":["// Copyright 2011 Mark Cavage <mcavage@gmail.com> All rights reserved.\n\nvar test = require('tap').test;\nvar sys = require('sys');\n\n///--- Globals\n\nvar BerWriter;\n\nvar BerReader;\n\n\n///--- Tests\n\ntest('load library', function(t) {\n  BerWriter = require('../../lib/index').BerWriter;\n  t.ok(BerWriter);\n  t.ok(new BerWriter());\n  t.end();\n});\n\n\ntest('write byte', function(t) {\n  var writer = new BerWriter();\n\n  writer.writeByte(0xC2);\n  var ber = writer.buffer;\n\n  t.ok(ber);\n  t.equal(ber.length, 1, 'Wrong length');\n  t.equal(ber[0], 0xC2, 'value wrong');\n\n  t.end();\n});\n\n\ntest('write 1 byte int', function(t) {\n  var writer = new BerWriter();\n\n  writer.writeInt(0x7f);\n  var ber = writer.buffer;\n\n  t.ok(ber);\n  t.equal(ber.length, 3, 'Wrong length for an int: ' + ber.length);\n  t.equal(ber[0], 0x02, 'ASN.1 tag wrong (2) -> ' + ber[0]);\n  t.equal(ber[1], 0x01, 'length wrong(1) -> ' + ber[1]);\n  t.equal(ber[2], 0x7f, 'value wrong(3) -> ' + ber[2]);\n\n  t.end();\n});\n\n\ntest('write 2 byte int', function(t) {\n  var writer = new BerWriter();\n\n  writer.writeInt(0x7ffe);\n  var ber = writer.buffer;\n\n  t.ok(ber);\n  t.equal(ber.length, 4, 'Wrong length for an int');\n  t.equal(ber[0], 0x02, 'ASN.1 tag wrong');\n  t.equal(ber[1], 0x02, 'length wrong');\n  t.equal(ber[2], 0x7f, 'value wrong (byte 1)');\n  t.equal(ber[3], 0xfe, 'value wrong (byte 2)');\n\n  t.end();\n});\n\n\ntest('write 3 byte int', function(t) {\n  var writer = new BerWriter();\n\n  writer.writeInt(0x7ffffe);\n  var ber = writer.buffer;\n\n  t.ok(ber);\n  t.equal(ber.length, 5, 'Wrong length for an int');\n  t.equal(ber[0], 0x02, 'ASN.1 tag wrong');\n  t.equal(ber[1], 0x03, 'length wrong');\n  t.equal(ber[2], 0x7f, 'value wrong (byte 1)');\n  t.equal(ber[3], 0xff, 'value wrong (byte 2)');\n  t.equal(ber[4], 0xfe, 'value wrong (byte 3)');\n\n  t.end();\n});\n\n\ntest('write 4 byte int', function(t) {\n  var writer = new BerWriter();\n\n  writer.writeInt(0x7ffffffe);\n  var ber = writer.buffer;\n\n  t.ok(ber);\n\n  t.equal(ber.length, 6, 'Wrong length for an int');\n  t.equal(ber[0], 0x02, 'ASN.1 tag wrong');\n  t.equal(ber[1], 0x04, 'length wrong');\n  t.equal(ber[2], 0x7f, 'value wrong (byte 1)');\n  t.equal(ber[3], 0xff, 'value wrong (byte 2)');\n  t.equal(ber[4], 0xff, 'value wrong (byte 3)');\n  t.equal(ber[5], 0xfe, 'value wrong (byte 4)');\n\n  t.end();\n});\n\n\ntest('write 1 byte negative int', function(t) {\n  var writer = new BerWriter();\n\n  writer.writeInt(-128);\n  var ber = writer.buffer;\n\n  t.ok(ber);\n\n  t.equal(ber.length, 3, 'Wrong length for an int');\n  t.equal(ber[0], 0x02, 'ASN.1 tag wrong');\n  t.equal(ber[1], 0x01, 'length wrong');\n  t.equal(ber[2], 0x80, 'value wrong (byte 1)');\n\n  t.end();\n});\n\n\ntest('write 2 byte negative int', function(t) {\n  var writer = new BerWriter();\n\n  writer.writeInt(-22400);\n  var ber = writer.buffer;\n\n  t.ok(ber);\n\n  t.equal(ber.length, 4, 'Wrong length for an int');\n  t.equal(ber[0], 0x02, 'ASN.1 tag wrong');\n  t.equal(ber[1], 0x02, 'length wrong');\n  t.equal(ber[2], 0xa8, 'value wrong (byte 1)');\n  t.equal(ber[3], 0x80, 'value wrong (byte 2)');\n\n  t.end();\n});\n\n\ntest('write 3 byte negative int', function(t) {\n  var writer = new BerWriter();\n\n  writer.writeInt(-481653);\n  var ber = writer.buffer;\n\n  t.ok(ber);\n\n  t.equal(ber.length, 5, 'Wrong length for an int');\n  t.equal(ber[0], 0x02, 'ASN.1 tag wrong');\n  t.equal(ber[1], 0x03, 'length wrong');\n  t.equal(ber[2], 0xf8, 'value wrong (byte 1)');\n  t.equal(ber[3], 0xa6, 'value wrong (byte 2)');\n  t.equal(ber[4], 0x8b, 'value wrong (byte 3)');\n\n  t.end();\n});\n\n\ntest('write 4 byte negative int', function(t) {\n  var writer = new BerWriter();\n\n  writer.writeInt(-1522904131);\n  var ber = writer.buffer;\n\n  t.ok(ber);\n\n  t.equal(ber.length, 6, 'Wrong length for an int');\n  t.equal(ber[0], 0x02, 'ASN.1 tag wrong');\n  t.equal(ber[1], 0x04, 'length wrong');\n  t.equal(ber[2], 0xa5, 'value wrong (byte 1)');\n  t.equal(ber[3], 0x3a, 'value wrong (byte 2)');\n  t.equal(ber[4], 0x53, 'value wrong (byte 3)');\n  t.equal(ber[5], 0xbd, 'value wrong (byte 4)');\n\n  t.end();\n});\n\n\ntest('write boolean', function(t) {\n  var writer = new BerWriter();\n\n  writer.writeBoolean(true);\n  writer.writeBoolean(false);\n  var ber = writer.buffer;\n\n  t.ok(ber);\n  t.equal(ber.length, 6, 'Wrong length');\n  t.equal(ber[0], 0x01, 'tag wrong');\n  t.equal(ber[1], 0x01, 'length wrong');\n  t.equal(ber[2], 0xff, 'value wrong');\n  t.equal(ber[3], 0x01, 'tag wrong');\n  t.equal(ber[4], 0x01, 'length wrong');\n  t.equal(ber[5], 0x00, 'value wrong');\n\n  t.end();\n});\n\n\ntest('write string', function(t) {\n  var writer = new BerWriter();\n  writer.writeString('hello world');\n  var ber = writer.buffer;\n\n  t.ok(ber);\n  t.equal(ber.length, 13, 'wrong length');\n  t.equal(ber[0], 0x04, 'wrong tag');\n  t.equal(ber[1], 11, 'wrong length');\n  t.equal(ber.slice(2).toString('utf8'), 'hello world', 'wrong value');\n\n  t.end();\n});\n\ntest('write buffer', function(t) {\n  var writer = new BerWriter();\n  // write some stuff to start with\n  writer.writeString('hello world');\n  var ber = writer.buffer;\n  var buf = new Buffer([0x04, 0x0b, 0x30, 0x09, 0x02, 0x01, 0x0f, 0x01, 0x01,\n     0xff, 0x01, 0x01, 0xff]);\n  writer.writeBuffer(buf.slice(2, buf.length), 0x04);\n  ber = writer.buffer;\n\n  t.ok(ber);\n  t.equal(ber.length, 26, 'wrong length');\n  t.equal(ber[0], 0x04, 'wrong tag');\n  t.equal(ber[1], 11, 'wrong length');\n  t.equal(ber.slice(2, 13).toString('utf8'), 'hello world', 'wrong value');\n  t.equal(ber[13], buf[0], 'wrong tag');\n  t.equal(ber[14], buf[1], 'wrong length');\n  for (var i = 13, j = 0; i < ber.length && j < buf.length; i++, j++) {\n    t.equal(ber[i], buf[j], 'buffer contents not identical');\n  }\n  t.end();\n});\n\ntest('write string array', function(t) {\n  var writer = new BerWriter();\n  writer.writeStringArray(['hello world', 'fubar!']);\n  var ber = writer.buffer;\n\n  t.ok(ber);\n\n  t.equal(ber.length, 21, 'wrong length');\n  t.equal(ber[0], 0x04, 'wrong tag');\n  t.equal(ber[1], 11, 'wrong length');\n  t.equal(ber.slice(2, 13).toString('utf8'), 'hello world', 'wrong value');\n\n  t.equal(ber[13], 0x04, 'wrong tag');\n  t.equal(ber[14], 6, 'wrong length');\n  t.equal(ber.slice(15).toString('utf8'), 'fubar!', 'wrong value');\n\n  t.end();\n});\n\n\ntest('resize internal buffer', function(t) {\n  var writer = new BerWriter({size: 2});\n  writer.writeString('hello world');\n  var ber = writer.buffer;\n\n  t.ok(ber);\n  t.equal(ber.length, 13, 'wrong length');\n  t.equal(ber[0], 0x04, 'wrong tag');\n  t.equal(ber[1], 11, 'wrong length');\n  t.equal(ber.slice(2).toString('utf8'), 'hello world', 'wrong value');\n\n  t.end();\n});\n\n\ntest('sequence', function(t) {\n  var writer = new BerWriter({size: 25});\n  writer.startSequence();\n  writer.writeString('hello world');\n  writer.endSequence();\n  var ber = writer.buffer;\n\n  t.ok(ber);\n  console.log(ber);\n  t.equal(ber.length, 15, 'wrong length');\n  t.equal(ber[0], 0x30, 'wrong tag');\n  t.equal(ber[1], 13, 'wrong length');\n  t.equal(ber[2], 0x04, 'wrong tag');\n  t.equal(ber[3], 11, 'wrong length');\n  t.equal(ber.slice(4).toString('utf8'), 'hello world', 'wrong value');\n\n  t.end();\n});\n\n\ntest('nested sequence', function(t) {\n  var writer = new BerWriter({size: 25});\n  writer.startSequence();\n  writer.writeString('hello world');\n  writer.startSequence();\n  writer.writeString('hello world');\n  writer.endSequence();\n  writer.endSequence();\n  var ber = writer.buffer;\n\n  t.ok(ber);\n  t.equal(ber.length, 30, 'wrong length');\n  t.equal(ber[0], 0x30, 'wrong tag');\n  t.equal(ber[1], 28, 'wrong length');\n  t.equal(ber[2], 0x04, 'wrong tag');\n  t.equal(ber[3], 11, 'wrong length');\n  t.equal(ber.slice(4, 15).toString('utf8'), 'hello world', 'wrong value');\n  t.equal(ber[15], 0x30, 'wrong tag');\n  t.equal(ber[16], 13, 'wrong length');\n  t.equal(ber[17], 0x04, 'wrong tag');\n  t.equal(ber[18], 11, 'wrong length');\n  t.equal(ber.slice(19, 30).toString('utf8'), 'hello world', 'wrong value');\n\n  t.end();\n});\n\n\ntest('LDAP bind message', function(t) {\n  var dn = 'cn=foo,ou=unit,o=test';\n  var writer = new BerWriter();\n  writer.startSequence();\n  writer.writeInt(3);             // msgid = 3\n  writer.startSequence(0x60);     // ldap bind\n  writer.writeInt(3);             // ldap v3\n  writer.writeString(dn);\n  writer.writeByte(0x80);\n  writer.writeByte(0x00);\n  writer.endSequence();\n  writer.endSequence();\n  var ber = writer.buffer;\n\n  t.ok(ber);\n  t.equal(ber.length, 35, 'wrong length (buffer)');\n  t.equal(ber[0], 0x30, 'wrong tag');\n  t.equal(ber[1], 33, 'wrong length');\n  t.equal(ber[2], 0x02, 'wrong tag');\n  t.equal(ber[3], 1, 'wrong length');\n  t.equal(ber[4], 0x03, 'wrong value');\n  t.equal(ber[5], 0x60, 'wrong tag');\n  t.equal(ber[6], 28, 'wrong length');\n  t.equal(ber[7], 0x02, 'wrong tag');\n  t.equal(ber[8], 1, 'wrong length');\n  t.equal(ber[9], 0x03, 'wrong value');\n  t.equal(ber[10], 0x04, 'wrong tag');\n  t.equal(ber[11], dn.length, 'wrong length');\n  t.equal(ber.slice(12, 33).toString('utf8'), dn, 'wrong value');\n  t.equal(ber[33], 0x80, 'wrong tag');\n  t.equal(ber[34], 0x00, 'wrong len');\n\n  t.end();\n});\n\n\ntest('Write OID', function(t) {\n  var oid = '1.2.840.113549.1.1.1';\n  var writer = new BerWriter();\n  writer.writeOID(oid);\n\n  var ber = writer.buffer;\n  t.ok(ber);\n  console.log(require('util').inspect(ber));\n  console.log(require('util').inspect(new Buffer([0x06, 0x09, 0x2a, 0x86,\n                                                  0x48, 0x86, 0xf7, 0x0d,\n                                                  0x01, 0x01, 0x01])));\n\n  t.end();\n});\n"]}