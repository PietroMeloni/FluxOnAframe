{"version":3,"sources":["../../../../../node_modules/npm/node_modules/npm-package-arg/npa.js"],"names":["module","exports","npa","resolve","Result","url","HostedGit","semver","path","validatePackageName","osenv","isWindows","process","platform","global","FAKE_WINDOWS","hasSlashes","isURL","isFilename","arg","where","name","spec","rawSpec","raw","nameEndsAt","slice","indexOf","namePart","test","require","valid","validForOldPackages","isFilespec","res","fromArgument","setName","fromFile","fromAlias","hosted","fromUrl","noGitPlus","noCommittish","fromHostedGit","fromURL","fromRegistry","invalidPackageName","err","Error","errors","join","code","invalidTagName","opts","type","registry","undefined","escapedName","scope","saveSpec","fetchSpec","gitRange","gitCommittish","prototype","replace","toString","full","push","length","toJSON","result","Object","assign","setGitCommittish","committish","decodeURIComponent","isAbsolutePath","resolvePath","isAbsolute","dir","cwd","home","relative","getDefaultRepresentation","unsupportedURLType","protocol","matchGitScp","matched","match","urlparse","parse","hash","format","subSpec","substr","version","range","validRange","encodeURIComponent"],"mappings":"AAAA;;;;AACAA,OAAOC,OAAP,GAAiBC,GAAjB;AACAF,OAAOC,OAAP,CAAeE,OAAf,GAAyBA,OAAzB;AACAH,OAAOC,OAAP,CAAeG,MAAf,GAAwBA,MAAxB;;AAEA,IAAIC,YAAJ;AACA,IAAIC,kBAAJ;AACA,IAAIC,eAAJ;AACA,IAAIC,aAAJ;AACA,IAAIC,4BAAJ;AACA,IAAIC,cAAJ;;AAEA,IAAMC,YAAYC,QAAQC,QAAR,KAAqB,OAArB,IAAgCC,OAAOC,YAAzD;AACA,IAAMC,aAAaL,YAAY,QAAZ,GAAuB,KAA1C;AACA,IAAMM,QAAQ,sBAAd;AACA,IAAMC,aAAa,yBAAnB;;AAEA,SAAShB,GAAT,CAAciB,GAAd,EAAmBC,KAAnB,EAA0B;AACxB,MAAIC,aAAJ;AACA,MAAIC,aAAJ;AACA,MAAI,QAAOH,GAAP,yCAAOA,GAAP,OAAe,QAAnB,EAA6B;AAC3B,QAAIA,eAAef,MAAf,KAA0B,CAACgB,KAAD,IAAUA,UAAUD,IAAIC,KAAlD,CAAJ,EAA8D;AAC5D,aAAOD,GAAP;AACD,KAFD,MAEO,IAAIA,IAAIE,IAAJ,IAAYF,IAAII,OAApB,EAA6B;AAClC,aAAOrB,IAAIC,OAAJ,CAAYgB,IAAIE,IAAhB,EAAsBF,IAAII,OAA1B,EAAmCH,SAASD,IAAIC,KAAhD,CAAP;AACD,KAFM,MAEA;AACL,aAAOlB,IAAIiB,IAAIK,GAAR,EAAaJ,SAASD,IAAIC,KAA1B,CAAP;AACD;AACF;AACD,MAAMK,aAAaN,IAAI,CAAJ,MAAW,GAAX,GAAiBA,IAAIO,KAAJ,CAAU,CAAV,EAAaC,OAAb,CAAqB,GAArB,IAA4B,CAA7C,GAAiDR,IAAIQ,OAAJ,CAAY,GAAZ,CAApE;AACA,MAAMC,WAAWH,aAAa,CAAb,GAAiBN,IAAIO,KAAJ,CAAU,CAAV,EAAaD,UAAb,CAAjB,GAA4CN,GAA7D;AACA,MAAIF,MAAMY,IAAN,CAAWV,GAAX,CAAJ,EAAqB;AACnBG,WAAOH,GAAP;AACD,GAFD,MAEO,IAAIS,SAAS,CAAT,MAAgB,GAAhB,KAAwBZ,WAAWa,IAAX,CAAgBD,QAAhB,KAA6BV,WAAWW,IAAX,CAAgBD,QAAhB,CAArD,CAAJ,EAAqF;AAC1FN,WAAOH,GAAP;AACD,GAFM,MAEA,IAAIM,aAAa,CAAjB,EAAoB;AACzBJ,WAAOO,QAAP;AACAN,WAAOH,IAAIO,KAAJ,CAAUD,aAAa,CAAvB,CAAP;AACD,GAHM,MAGA;AACL,QAAI,CAAChB,mBAAL,EAA0BA,sBAAsBqB,QAAQ,2BAAR,CAAtB;AAC1B,QAAMC,QAAQtB,oBAAoBU,GAApB,CAAd;AACA,QAAIY,MAAMC,mBAAV,EAA+B;AAC7BX,aAAOF,GAAP;AACD,KAFD,MAEO;AACLG,aAAOH,GAAP;AACD;AACF;AACD,SAAOhB,QAAQkB,IAAR,EAAcC,IAAd,EAAoBF,KAApB,EAA2BD,GAA3B,CAAP;AACD;;AAED,IAAMc,aAAatB,YAAY,+BAAZ,GAA8C,6BAAjE;;AAEA,SAASR,OAAT,CAAkBkB,IAAlB,EAAwBC,IAAxB,EAA8BF,KAA9B,EAAqCD,GAArC,EAA0C;AACxC,MAAMe,MAAM,IAAI9B,MAAJ,CAAW;AACrBoB,SAAKL,GADgB;AAErBE,UAAMA,IAFe;AAGrBE,aAASD,IAHY;AAIrBa,kBAAchB,OAAO;AAJA,GAAX,CAAZ;;AAOA,MAAIE,IAAJ,EAAUa,IAAIE,OAAJ,CAAYf,IAAZ;;AAEV,MAAIC,SAASW,WAAWJ,IAAX,CAAgBP,IAAhB,KAAyB,UAAUO,IAAV,CAAeP,IAAf,CAAlC,CAAJ,EAA6D;AAC3D,WAAOe,SAASH,GAAT,EAAcd,KAAd,CAAP;AACD,GAFD,MAEO,IAAIE,QAAQ,SAASO,IAAT,CAAcP,IAAd,CAAZ,EAAiC;AACtC,WAAOgB,UAAUJ,GAAV,EAAed,KAAf,CAAP;AACD;AACD,MAAI,CAACd,SAAL,EAAgBA,YAAYwB,QAAQ,iBAAR,CAAZ;AAChB,MAAMS,SAASjC,UAAUkC,OAAV,CAAkBlB,IAAlB,EAAwB,EAACmB,WAAW,IAAZ,EAAkBC,cAAc,IAAhC,EAAxB,CAAf;AACA,MAAIH,MAAJ,EAAY;AACV,WAAOI,cAAcT,GAAd,EAAmBK,MAAnB,CAAP;AACD,GAFD,MAEO,IAAIjB,QAAQL,MAAMY,IAAN,CAAWP,IAAX,CAAZ,EAA8B;AACnC,WAAOsB,QAAQV,GAAR,CAAP;AACD,GAFM,MAEA,IAAIZ,SAASN,WAAWa,IAAX,CAAgBP,IAAhB,KAAyBJ,WAAWW,IAAX,CAAgBP,IAAhB,CAAlC,CAAJ,EAA8D;AACnE,WAAOe,SAASH,GAAT,EAAcd,KAAd,CAAP;AACD,GAFM,MAEA;AACL,WAAOyB,aAAaX,GAAb,CAAP;AACD;AACF;;AAED,SAASY,kBAAT,CAA6BzB,IAA7B,EAAmCU,KAAnC,EAA0C;AACxC,MAAMgB,MAAM,IAAIC,KAAJ,4BAAmC3B,IAAnC,WAA6CU,MAAMkB,MAAN,CAAaC,IAAb,CAAkB,IAAlB,CAA7C,CAAZ;AACAH,MAAII,IAAJ,GAAW,qBAAX;AACA,SAAOJ,GAAP;AACD;AACD,SAASK,cAAT,CAAyB/B,IAAzB,EAA+B;AAC7B,MAAM0B,MAAM,IAAIC,KAAJ,wBAA+B3B,IAA/B,0EAAZ;AACA0B,MAAII,IAAJ,GAAW,iBAAX;AACA,SAAOJ,GAAP;AACD;;AAED,SAAS3C,MAAT,CAAiBiD,IAAjB,EAAuB;AACrB,OAAKC,IAAL,GAAYD,KAAKC,IAAjB;AACA,OAAKC,QAAL,GAAgBF,KAAKE,QAArB;AACA,OAAKnC,KAAL,GAAaiC,KAAKjC,KAAlB;AACA,MAAIiC,KAAK7B,GAAL,IAAY,IAAhB,EAAsB;AACpB,SAAKA,GAAL,GAAW6B,KAAKhC,IAAL,GAAYgC,KAAKhC,IAAL,GAAY,GAAZ,GAAkBgC,KAAK9B,OAAnC,GAA6C8B,KAAK9B,OAA7D;AACD,GAFD,MAEO;AACL,SAAKC,GAAL,GAAW6B,KAAK7B,GAAhB;AACD;AACD,OAAKH,IAAL,GAAYmC,SAAZ;AACA,OAAKC,WAAL,GAAmBD,SAAnB;AACA,OAAKE,KAAL,GAAaF,SAAb;AACA,OAAKjC,OAAL,GAAe8B,KAAK9B,OAAL,IAAgB,IAAhB,GAAuB,EAAvB,GAA4B8B,KAAK9B,OAAhD;AACA,OAAKoC,QAAL,GAAgBN,KAAKM,QAArB;AACA,OAAKC,SAAL,GAAiBP,KAAKO,SAAtB;AACA,MAAIP,KAAKhC,IAAT,EAAe,KAAKe,OAAL,CAAaiB,KAAKhC,IAAlB;AACf,OAAKwC,QAAL,GAAgBR,KAAKQ,QAArB;AACA,OAAKC,aAAL,GAAqBT,KAAKS,aAA1B;AACA,OAAKvB,MAAL,GAAcc,KAAKd,MAAnB;AACD;AACDnC,OAAO2D,SAAP,GAAmB,EAAnB;;AAEA3D,OAAO2D,SAAP,CAAiB3B,OAAjB,GAA2B,UAAUf,IAAV,EAAgB;AACzC,MAAI,CAACZ,mBAAL,EAA0BA,sBAAsBqB,QAAQ,2BAAR,CAAtB;AAC1B,MAAMC,QAAQtB,oBAAoBY,IAApB,CAAd;AACA,MAAI,CAACU,MAAMC,mBAAX,EAAgC;AAC9B,UAAMc,mBAAmBzB,IAAnB,EAAyBU,KAAzB,CAAN;AACD;AACD,OAAKV,IAAL,GAAYA,IAAZ;AACA,OAAKqC,KAAL,GAAarC,KAAK,CAAL,MAAY,GAAZ,GAAkBA,KAAKK,KAAL,CAAW,CAAX,EAAcL,KAAKM,OAAL,CAAa,GAAb,CAAd,CAAlB,GAAqD6B,SAAlE;AACA;AACA,OAAKC,WAAL,GAAmBpC,KAAK2C,OAAL,CAAa,GAAb,EAAkB,KAAlB,CAAnB;AACA,SAAO,IAAP;AACD,CAXD;;AAaA5D,OAAO2D,SAAP,CAAiBE,QAAjB,GAA4B,YAAY;AACtC,MAAMC,OAAO,EAAb;AACA,MAAI,KAAK7C,IAAL,IAAa,IAAb,IAAqB,KAAKA,IAAL,KAAc,EAAvC,EAA2C6C,KAAKC,IAAL,CAAU,KAAK9C,IAAf;AAC3C,MAAMC,OAAO,KAAKqC,QAAL,IAAiB,KAAKC,SAAtB,IAAmC,KAAKrC,OAArD;AACA,MAAID,QAAQ,IAAR,IAAgBA,SAAS,EAA7B,EAAiC4C,KAAKC,IAAL,CAAU7C,IAAV;AACjC,SAAO4C,KAAKE,MAAL,GAAcF,KAAKhB,IAAL,CAAU,GAAV,CAAd,GAA+B,KAAK1B,GAA3C;AACD,CAND;;AAQApB,OAAO2D,SAAP,CAAiBM,MAAjB,GAA0B,YAAY;AACpC,MAAMC,SAASC,OAAOC,MAAP,CAAc,EAAd,EAAkB,IAAlB,CAAf;AACA,SAAOF,OAAO/B,MAAd;AACA,SAAO+B,MAAP;AACD,CAJD;;AAMA,SAASG,gBAAT,CAA2BvC,GAA3B,EAAgCwC,UAAhC,EAA4C;AAC1C,MAAIA,cAAc,IAAd,IAAsBA,WAAWN,MAAX,IAAqB,CAA3C,IAAgDM,WAAWhD,KAAX,CAAiB,CAAjB,EAAoB,CAApB,MAA2B,SAA/E,EAA0F;AACxFQ,QAAI2B,QAAJ,GAAec,mBAAmBD,WAAWhD,KAAX,CAAiB,CAAjB,CAAnB,CAAf;AACAQ,QAAI4B,aAAJ,GAAoB,IAApB;AACD,GAHD,MAGO;AACL5B,QAAI4B,aAAJ,GAAoBY,eAAe,EAAf,GAAoB,IAApB,GAA2BA,UAA/C;AACD;AACD,SAAOxC,GAAP;AACD;;AAED,IAAM0C,iBAAiB,iBAAvB;;AAEA,SAASC,WAAT,CAAsBzD,KAAtB,EAA6BE,IAA7B,EAAmC;AACjC,MAAIsD,eAAe/C,IAAf,CAAoBP,IAApB,CAAJ,EAA+B,OAAOA,IAAP;AAC/B,MAAI,CAACd,IAAL,EAAWA,OAAOsB,QAAQ,MAAR,CAAP;AACX,SAAOtB,KAAKL,OAAL,CAAaiB,KAAb,EAAoBE,IAApB,CAAP;AACD;;AAED,SAASwD,UAAT,CAAqBC,GAArB,EAA0B;AACxB,MAAIA,IAAI,CAAJ,MAAW,GAAf,EAAoB,OAAO,IAAP;AACpB,MAAI,aAAalD,IAAb,CAAkBkD,GAAlB,CAAJ,EAA4B,OAAO,IAAP;AAC5B,SAAO,KAAP;AACD;;AAED,SAAS1C,QAAT,CAAmBH,GAAnB,EAAwBd,KAAxB,EAA+B;AAC7B,MAAI,CAACA,KAAL,EAAYA,QAAQR,QAAQoE,GAAR,EAAR;AACZ9C,MAAIoB,IAAJ,GAAWpC,WAAWW,IAAX,CAAgBK,IAAIX,OAApB,IAA+B,MAA/B,GAAwC,WAAnD;AACAW,MAAId,KAAJ,GAAYA,KAAZ;;AAEA,MAAME,OAAOY,IAAIX,OAAJ,CAAYyC,OAAZ,CAAoB,KAApB,EAA2B,GAA3B,EACVA,OADU,CACF,uBADE,EACuB,IADvB,EAC6B;AAD7B,GAEVA,OAFU,CAEF,wBAFE,EAEwB,IAFxB,CAAb;AAGA,MAAI,QAAQnC,IAAR,CAAaP,IAAb,CAAJ,EAAwB;AACtB;AACA,QAAI,CAACZ,KAAL,EAAYA,QAAQoB,QAAQ,OAAR,CAAR;AACZI,QAAI0B,SAAJ,GAAgBiB,YAAYnE,MAAMuE,IAAN,EAAZ,EAA0B3D,KAAKI,KAAL,CAAW,CAAX,CAA1B,CAAhB;AACAQ,QAAIyB,QAAJ,GAAe,UAAUrC,IAAzB;AACD,GALD,MAKO;AACLY,QAAI0B,SAAJ,GAAgBiB,YAAYzD,KAAZ,EAAmBE,IAAnB,CAAhB;AACA,QAAIwD,WAAWxD,IAAX,CAAJ,EAAsB;AACpBY,UAAIyB,QAAJ,GAAe,UAAUrC,IAAzB;AACD,KAFD,MAEO;AACL,UAAI,CAACd,IAAL,EAAWA,OAAOsB,QAAQ,MAAR,CAAP;AACXI,UAAIyB,QAAJ,GAAe,UAAUnD,KAAK0E,QAAL,CAAc9D,KAAd,EAAqBc,IAAI0B,SAAzB,CAAzB;AACD;AACF;AACD,SAAO1B,GAAP;AACD;;AAED,SAASS,aAAT,CAAwBT,GAAxB,EAA6BK,MAA7B,EAAqC;AACnCL,MAAIoB,IAAJ,GAAW,KAAX;AACApB,MAAIK,MAAJ,GAAaA,MAAb;AACAL,MAAIyB,QAAJ,GAAepB,OAAO0B,QAAP,CAAgB,EAACxB,WAAW,KAAZ,EAAmBC,cAAc,KAAjC,EAAhB,CAAf;AACAR,MAAI0B,SAAJ,GAAgBrB,OAAO4C,wBAAP,OAAsC,UAAtC,GAAmD,IAAnD,GAA0D5C,OAAO0B,QAAP,EAA1E;AACA,SAAOQ,iBAAiBvC,GAAjB,EAAsBK,OAAOmC,UAA7B,CAAP;AACD;;AAED,SAASU,kBAAT,CAA6BC,QAA7B,EAAuC/D,IAAvC,EAA6C;AAC3C,MAAMyB,MAAM,IAAIC,KAAJ,4BAAmCqC,QAAnC,WAAiD/D,IAAjD,CAAZ;AACAyB,MAAII,IAAJ,GAAW,sBAAX;AACA,SAAOJ,GAAP;AACD;;AAED,SAASuC,WAAT,CAAsBhE,IAAtB,EAA4B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAMiE,UAAUjE,KAAKkE,KAAL,CAAW,oDAAX,CAAhB;AACA,SAAOD,WAAW,CAACA,QAAQ,CAAR,EAAWC,KAAX,CAAiB,gBAAjB,CAAZ,IAAkD;AACvD5B,eAAW2B,QAAQ,CAAR,CAD4C;AAEvDzB,mBAAeyB,QAAQ,CAAR,KAAc,IAAd,GAAqB,IAArB,GAA4BA,QAAQ,CAAR;AAFY,GAAzD;AAID;;AAED,SAAS3C,OAAT,CAAkBV,GAAlB,EAAuB;AACrB,MAAI,CAAC7B,GAAL,EAAUA,MAAMyB,QAAQ,KAAR,CAAN;AACV,MAAM2D,WAAWpF,IAAIqF,KAAJ,CAAUxD,IAAIX,OAAd,CAAjB;AACAW,MAAIyB,QAAJ,GAAezB,IAAIX,OAAnB;AACA;AACA,UAAQkE,SAASJ,QAAjB;AACE,SAAK,MAAL;AACA,SAAK,WAAL;AACA,SAAK,YAAL;AACA,SAAK,YAAL;AACA,SAAK,UAAL;AACA,SAAK,WAAL;AACA,SAAK,UAAL;AACEnD,UAAIoB,IAAJ,GAAW,KAAX;AACA,UAAMkC,QAAQC,SAASJ,QAAT,KAAsB,UAAtB,IAAoCC,YAAYpD,IAAIX,OAAhB,CAAlD;AACA,UAAIiE,KAAJ,EAAW;AACTf,yBAAiBvC,GAAjB,EAAsBsD,MAAM1B,aAA5B;AACA5B,YAAI0B,SAAJ,GAAgB4B,MAAM5B,SAAtB;AACD,OAHD,MAGO;AACLa,yBAAiBvC,GAAjB,EAAsBuD,SAASE,IAAT,IAAiB,IAAjB,GAAwBF,SAASE,IAAT,CAAcjE,KAAd,CAAoB,CAApB,CAAxB,GAAiD,EAAvE;AACA+D,iBAASJ,QAAT,GAAoBI,SAASJ,QAAT,CAAkBrB,OAAlB,CAA0B,SAA1B,EAAqC,EAArC,CAApB;AACA,eAAOyB,SAASE,IAAhB;AACAzD,YAAI0B,SAAJ,GAAgBvD,IAAIuF,MAAJ,CAAWH,QAAX,CAAhB;AACD;AACD;AACF,SAAK,OAAL;AACA,SAAK,QAAL;AACEvD,UAAIoB,IAAJ,GAAW,QAAX;AACApB,UAAI0B,SAAJ,GAAgB1B,IAAIyB,QAApB;AACA;;AAEF;AACE,YAAMyB,mBAAmBK,SAASJ,QAA5B,EAAsCnD,IAAIX,OAA1C,CAAN;AA3BJ;;AA8BA,SAAOW,GAAP;AACD;;AAED,SAASI,SAAT,CAAoBJ,GAApB,EAAyBd,KAAzB,EAAgC;AAC9B,MAAMyE,UAAU3F,IAAIgC,IAAIX,OAAJ,CAAYuE,MAAZ,CAAmB,CAAnB,CAAJ,EAA2B1E,KAA3B,CAAhB;AACA,MAAIyE,QAAQvC,IAAR,KAAiB,OAArB,EAA8B;AAC5B,UAAM,IAAIN,KAAJ,CAAU,8BAAV,CAAN;AACD;AACD,MAAI,CAAC6C,QAAQtC,QAAb,EAAuB;AACrB,UAAM,IAAIP,KAAJ,CAAU,qCAAV,CAAN;AACD;AACDd,MAAI2D,OAAJ,GAAcA,OAAd;AACA3D,MAAIqB,QAAJ,GAAe,IAAf;AACArB,MAAIoB,IAAJ,GAAW,OAAX;AACApB,MAAIyB,QAAJ,GAAe,IAAf;AACAzB,MAAI0B,SAAJ,GAAgB,IAAhB;AACA,SAAO1B,GAAP;AACD;;AAED,SAASW,YAAT,CAAuBX,GAAvB,EAA4B;AAC1BA,MAAIqB,QAAJ,GAAe,IAAf;AACA,MAAMjC,OAAOY,IAAIX,OAAJ,KAAgB,EAAhB,GAAqB,QAArB,GAAgCW,IAAIX,OAAjD;AACA;AACA;AACAW,MAAIyB,QAAJ,GAAe,IAAf;AACAzB,MAAI0B,SAAJ,GAAgBtC,IAAhB;AACA,MAAI,CAACf,MAAL,EAAaA,SAASuB,QAAQ,QAAR,CAAT;AACb,MAAMiE,UAAUxF,OAAOwB,KAAP,CAAaT,IAAb,EAAmB,IAAnB,CAAhB;AACA,MAAM0E,QAAQzF,OAAO0F,UAAP,CAAkB3E,IAAlB,EAAwB,IAAxB,CAAd;AACA,MAAIyE,OAAJ,EAAa;AACX7D,QAAIoB,IAAJ,GAAW,SAAX;AACD,GAFD,MAEO,IAAI0C,KAAJ,EAAW;AAChB9D,QAAIoB,IAAJ,GAAW,OAAX;AACD,GAFM,MAEA;AACL,QAAI4C,mBAAmB5E,IAAnB,MAA6BA,IAAjC,EAAuC;AACrC,YAAM8B,eAAe9B,IAAf,CAAN;AACD;AACDY,QAAIoB,IAAJ,GAAW,KAAX;AACD;AACD,SAAOpB,GAAP;AACD","file":"npa.js","sourcesContent":["'use strict'\nmodule.exports = npa\nmodule.exports.resolve = resolve\nmodule.exports.Result = Result\n\nlet url\nlet HostedGit\nlet semver\nlet path\nlet validatePackageName\nlet osenv\n\nconst isWindows = process.platform === 'win32' || global.FAKE_WINDOWS\nconst hasSlashes = isWindows ? /\\\\|[/]/ : /[/]/\nconst isURL = /^(?:git[+])?[a-z]+:/i\nconst isFilename = /[.](?:tgz|tar.gz|tar)$/i\n\nfunction npa (arg, where) {\n  let name\n  let spec\n  if (typeof arg === 'object') {\n    if (arg instanceof Result && (!where || where === arg.where)) {\n      return arg\n    } else if (arg.name && arg.rawSpec) {\n      return npa.resolve(arg.name, arg.rawSpec, where || arg.where)\n    } else {\n      return npa(arg.raw, where || arg.where)\n    }\n  }\n  const nameEndsAt = arg[0] === '@' ? arg.slice(1).indexOf('@') + 1 : arg.indexOf('@')\n  const namePart = nameEndsAt > 0 ? arg.slice(0, nameEndsAt) : arg\n  if (isURL.test(arg)) {\n    spec = arg\n  } else if (namePart[0] !== '@' && (hasSlashes.test(namePart) || isFilename.test(namePart))) {\n    spec = arg\n  } else if (nameEndsAt > 0) {\n    name = namePart\n    spec = arg.slice(nameEndsAt + 1)\n  } else {\n    if (!validatePackageName) validatePackageName = require('validate-npm-package-name')\n    const valid = validatePackageName(arg)\n    if (valid.validForOldPackages) {\n      name = arg\n    } else {\n      spec = arg\n    }\n  }\n  return resolve(name, spec, where, arg)\n}\n\nconst isFilespec = isWindows ? /^(?:[.]|~[/]|[/\\\\]|[a-zA-Z]:)/ : /^(?:[.]|~[/]|[/]|[a-zA-Z]:)/\n\nfunction resolve (name, spec, where, arg) {\n  const res = new Result({\n    raw: arg,\n    name: name,\n    rawSpec: spec,\n    fromArgument: arg != null\n  })\n\n  if (name) res.setName(name)\n\n  if (spec && (isFilespec.test(spec) || /^file:/i.test(spec))) {\n    return fromFile(res, where)\n  } else if (spec && /^npm:/i.test(spec)) {\n    return fromAlias(res, where)\n  }\n  if (!HostedGit) HostedGit = require('hosted-git-info')\n  const hosted = HostedGit.fromUrl(spec, {noGitPlus: true, noCommittish: true})\n  if (hosted) {\n    return fromHostedGit(res, hosted)\n  } else if (spec && isURL.test(spec)) {\n    return fromURL(res)\n  } else if (spec && (hasSlashes.test(spec) || isFilename.test(spec))) {\n    return fromFile(res, where)\n  } else {\n    return fromRegistry(res)\n  }\n}\n\nfunction invalidPackageName (name, valid) {\n  const err = new Error(`Invalid package name \"${name}\": ${valid.errors.join('; ')}`)\n  err.code = 'EINVALIDPACKAGENAME'\n  return err\n}\nfunction invalidTagName (name) {\n  const err = new Error(`Invalid tag name \"${name}\": Tags may not have any characters that encodeURIComponent encodes.`)\n  err.code = 'EINVALIDTAGNAME'\n  return err\n}\n\nfunction Result (opts) {\n  this.type = opts.type\n  this.registry = opts.registry\n  this.where = opts.where\n  if (opts.raw == null) {\n    this.raw = opts.name ? opts.name + '@' + opts.rawSpec : opts.rawSpec\n  } else {\n    this.raw = opts.raw\n  }\n  this.name = undefined\n  this.escapedName = undefined\n  this.scope = undefined\n  this.rawSpec = opts.rawSpec == null ? '' : opts.rawSpec\n  this.saveSpec = opts.saveSpec\n  this.fetchSpec = opts.fetchSpec\n  if (opts.name) this.setName(opts.name)\n  this.gitRange = opts.gitRange\n  this.gitCommittish = opts.gitCommittish\n  this.hosted = opts.hosted\n}\nResult.prototype = {}\n\nResult.prototype.setName = function (name) {\n  if (!validatePackageName) validatePackageName = require('validate-npm-package-name')\n  const valid = validatePackageName(name)\n  if (!valid.validForOldPackages) {\n    throw invalidPackageName(name, valid)\n  }\n  this.name = name\n  this.scope = name[0] === '@' ? name.slice(0, name.indexOf('/')) : undefined\n  // scoped packages in couch must have slash url-encoded, e.g. @foo%2Fbar\n  this.escapedName = name.replace('/', '%2f')\n  return this\n}\n\nResult.prototype.toString = function () {\n  const full = []\n  if (this.name != null && this.name !== '') full.push(this.name)\n  const spec = this.saveSpec || this.fetchSpec || this.rawSpec\n  if (spec != null && spec !== '') full.push(spec)\n  return full.length ? full.join('@') : this.raw\n}\n\nResult.prototype.toJSON = function () {\n  const result = Object.assign({}, this)\n  delete result.hosted\n  return result\n}\n\nfunction setGitCommittish (res, committish) {\n  if (committish != null && committish.length >= 7 && committish.slice(0, 7) === 'semver:') {\n    res.gitRange = decodeURIComponent(committish.slice(7))\n    res.gitCommittish = null\n  } else {\n    res.gitCommittish = committish === '' ? null : committish\n  }\n  return res\n}\n\nconst isAbsolutePath = /^[/]|^[A-Za-z]:/\n\nfunction resolvePath (where, spec) {\n  if (isAbsolutePath.test(spec)) return spec\n  if (!path) path = require('path')\n  return path.resolve(where, spec)\n}\n\nfunction isAbsolute (dir) {\n  if (dir[0] === '/') return true\n  if (/^[A-Za-z]:/.test(dir)) return true\n  return false\n}\n\nfunction fromFile (res, where) {\n  if (!where) where = process.cwd()\n  res.type = isFilename.test(res.rawSpec) ? 'file' : 'directory'\n  res.where = where\n\n  const spec = res.rawSpec.replace(/\\\\/g, '/')\n    .replace(/^file:[/]*([A-Za-z]:)/, '$1') // drive name paths on windows\n    .replace(/^file:(?:[/]*([~./]))?/, '$1')\n  if (/^~[/]/.test(spec)) {\n    // this is needed for windows and for file:~/foo/bar\n    if (!osenv) osenv = require('osenv')\n    res.fetchSpec = resolvePath(osenv.home(), spec.slice(2))\n    res.saveSpec = 'file:' + spec\n  } else {\n    res.fetchSpec = resolvePath(where, spec)\n    if (isAbsolute(spec)) {\n      res.saveSpec = 'file:' + spec\n    } else {\n      if (!path) path = require('path')\n      res.saveSpec = 'file:' + path.relative(where, res.fetchSpec)\n    }\n  }\n  return res\n}\n\nfunction fromHostedGit (res, hosted) {\n  res.type = 'git'\n  res.hosted = hosted\n  res.saveSpec = hosted.toString({noGitPlus: false, noCommittish: false})\n  res.fetchSpec = hosted.getDefaultRepresentation() === 'shortcut' ? null : hosted.toString()\n  return setGitCommittish(res, hosted.committish)\n}\n\nfunction unsupportedURLType (protocol, spec) {\n  const err = new Error(`Unsupported URL Type \"${protocol}\": ${spec}`)\n  err.code = 'EUNSUPPORTEDPROTOCOL'\n  return err\n}\n\nfunction matchGitScp (spec) {\n  // git ssh specifiers are overloaded to also use scp-style git\n  // specifiers, so we have to parse those out and treat them special.\n  // They are NOT true URIs, so we can't hand them to `url.parse`.\n  //\n  // This regex looks for things that look like:\n  // git+ssh://git@my.custom.git.com:username/project.git#deadbeef\n  //\n  // ...and various combinations. The username in the beginning is *required*.\n  const matched = spec.match(/^git\\+ssh:\\/\\/([^:#]+:[^#]+(?:\\.git)?)(?:#(.*))?$/i)\n  return matched && !matched[1].match(/:[0-9]+\\/?.*$/i) && {\n    fetchSpec: matched[1],\n    gitCommittish: matched[2] == null ? null : matched[2]\n  }\n}\n\nfunction fromURL (res) {\n  if (!url) url = require('url')\n  const urlparse = url.parse(res.rawSpec)\n  res.saveSpec = res.rawSpec\n  // check the protocol, and then see if it's git or not\n  switch (urlparse.protocol) {\n    case 'git:':\n    case 'git+http:':\n    case 'git+https:':\n    case 'git+rsync:':\n    case 'git+ftp:':\n    case 'git+file:':\n    case 'git+ssh:':\n      res.type = 'git'\n      const match = urlparse.protocol === 'git+ssh:' && matchGitScp(res.rawSpec)\n      if (match) {\n        setGitCommittish(res, match.gitCommittish)\n        res.fetchSpec = match.fetchSpec\n      } else {\n        setGitCommittish(res, urlparse.hash != null ? urlparse.hash.slice(1) : '')\n        urlparse.protocol = urlparse.protocol.replace(/^git[+]/, '')\n        delete urlparse.hash\n        res.fetchSpec = url.format(urlparse)\n      }\n      break\n    case 'http:':\n    case 'https:':\n      res.type = 'remote'\n      res.fetchSpec = res.saveSpec\n      break\n\n    default:\n      throw unsupportedURLType(urlparse.protocol, res.rawSpec)\n  }\n\n  return res\n}\n\nfunction fromAlias (res, where) {\n  const subSpec = npa(res.rawSpec.substr(4), where)\n  if (subSpec.type === 'alias') {\n    throw new Error('nested aliases not supported')\n  }\n  if (!subSpec.registry) {\n    throw new Error('aliases only work for registry deps')\n  }\n  res.subSpec = subSpec\n  res.registry = true\n  res.type = 'alias'\n  res.saveSpec = null\n  res.fetchSpec = null\n  return res\n}\n\nfunction fromRegistry (res) {\n  res.registry = true\n  const spec = res.rawSpec === '' ? 'latest' : res.rawSpec\n  // no save spec for registry components as we save based on the fetched\n  // version, not on the argument so this can't compute that.\n  res.saveSpec = null\n  res.fetchSpec = spec\n  if (!semver) semver = require('semver')\n  const version = semver.valid(spec, true)\n  const range = semver.validRange(spec, true)\n  if (version) {\n    res.type = 'version'\n  } else if (range) {\n    res.type = 'range'\n  } else {\n    if (encodeURIComponent(spec) !== spec) {\n      throw invalidTagName(spec)\n    }\n    res.type = 'tag'\n  }\n  return res\n}\n"]}