{"version":3,"sources":["../../../../../../node_modules/npm/node_modules/npm-audit-report/reporters/install.js"],"names":["Utils","require","module","exports","report","data","options","msg","summary","Object","keys","advisories","length","exitCode","defaults","severityThreshold","config","assign","clr","str","color","withColor","green","red","output","log","value","total","totalVulnCount","metadata","vulnerabilities","sev","severities","map","severityLabel","toLowerCase","join","vulnCount","vulnLabel","trim"],"mappings":"AAAA;;AAEA,IAAMA,QAAQC,QAAQ,cAAR,CAAd;;AAEAC,OAAOC,OAAP,GAAiBC,MAAjB;AACA,SAASA,MAAT,CAAiBC,IAAjB,EAAuBC,OAAvB,EAAgC;AAC9B,MAAIC,MAAMC,QAAQH,IAAR,EAAcC,OAAd,CAAV;AACA,MAAI,CAACG,OAAOC,IAAP,CAAYL,KAAKM,UAAjB,EAA6BC,MAAlC,EAA0C;AACxC,WAAO;AACLR,cAAQG,GADH;AAELM,gBAAU;AAFL,KAAP;AAID,GALD,MAKO;AACLN,WAAO,iEAAP;AACA,WAAO;AACLH,cAAQG,GADH;AAELM,gBAAU;AAFL,KAAP;AAID;AACF;;AAEDX,OAAOC,OAAP,CAAeK,OAAf,GAAyBA,OAAzB;AACA,SAASA,OAAT,CAAkBH,IAAlB,EAAwBC,OAAxB,EAAiC;AAC/B,MAAMQ,WAAW;AACfC,uBAAmB;AADJ,GAAjB;;AAIA,MAAMC,SAASP,OAAOQ,MAAP,CAAc,EAAd,EAAkBH,QAAlB,EAA4BR,OAA5B,CAAf;;AAEA,WAASY,GAAT,CAAcC,GAAd,EAAmBD,GAAnB,EAAwB;AAAE,WAAOlB,MAAMoB,KAAN,CAAYD,GAAZ,EAAiBD,GAAjB,EAAsBF,OAAOK,SAA7B,CAAP;AAAgD;AAC1E,WAASC,KAAT,CAAgBH,GAAhB,EAAqB;AAAE,WAAOD,IAAIC,GAAJ,EAAS,aAAT,CAAP;AAAgC;AACvD,WAASI,GAAT,CAAcJ,GAAd,EAAmB;AAAE,WAAOD,IAAIC,GAAJ,EAAS,WAAT,CAAP;AAA8B;;AAEnD,MAAIK,SAAS,EAAb;;AAEA,MAAMC,MAAM,SAANA,GAAM,CAAUC,KAAV,EAAiB;AAC3BF,aAASA,SAASE,KAAT,GAAiB,IAA1B;AACD,GAFD;;AAIAF,YAAU,QAAV;;AAEA,MAAIf,OAAOC,IAAP,CAAYL,KAAKM,UAAjB,EAA6BC,MAA7B,KAAwC,CAA5C,EAA+C;AAC7Ca,QAAOH,MAAM,GAAN,CAAP;AACA,WAAOE,MAAP;AACD,GAHD,MAGO;AACL,QAAMG,QAAQ3B,MAAM4B,cAAN,CAAqBvB,KAAKwB,QAAL,CAAcC,eAAnC,CAAd;AACA,QAAMC,MAAM/B,MAAMgC,UAAN,CAAiB3B,KAAKwB,QAAL,CAAcC,eAA/B,CAAZ;;AAEA,QAAIC,IAAInB,MAAJ,GAAa,CAAjB,EAAoB;AAClB,UAAMoB,aAAaD,IAAIE,GAAJ,CAAQ,UAACP,KAAD,EAAW;AACpC,eAAUA,MAAM,CAAN,CAAV,SAAsB1B,MAAMkC,aAAN,CAAoBR,MAAM,CAAN,CAApB,EAA8BV,OAAOK,SAArC,EAAgDc,WAAhD,EAAtB;AACD,OAFkB,EAEhBC,IAFgB,CAEX,IAFW,CAAnB;AAGAX,UAAOF,IAAII,KAAJ,CAAP,0BAAsCK,UAAtC;AACD,KALD,MAKO;AACL,UAAMK,YAAYN,IAAI,CAAJ,EAAO,CAAP,CAAlB;AACA,UAAMO,YAAYtC,MAAMkC,aAAN,CAAoBH,IAAI,CAAJ,EAAO,CAAP,CAApB,EAA+Bf,OAAOK,SAAtC,EAAiDc,WAAjD,EAAlB;AACAV,UAAOY,SAAP,SAAoBC,SAApB,+BAAsDD,cAAc,CAAd,GAAkB,GAAlB,GAAwB,KAA9E;AACD;AACF;AACD,SAAOb,OAAOe,IAAP,EAAP;AACD","file":"install.js","sourcesContent":["'use strict'\n\nconst Utils = require('../lib/utils')\n\nmodule.exports = report\nfunction report (data, options) {\n  let msg = summary(data, options)\n  if (!Object.keys(data.advisories).length) {\n    return {\n      report: msg,\n      exitCode: 0\n    }\n  } else {\n    msg += '\\n  run `npm audit fix` to fix them, or `npm audit` for details'\n    return {\n      report: msg,\n      exitCode: 1\n    }\n  }\n}\n\nmodule.exports.summary = summary\nfunction summary (data, options) {\n  const defaults = {\n    severityThreshold: 'info'\n  }\n\n  const config = Object.assign({}, defaults, options)\n\n  function clr (str, clr) { return Utils.color(str, clr, config.withColor) }\n  function green (str) { return clr(str, 'brightGreen') }\n  function red (str) { return clr(str, 'brightRed') }\n\n  let output = ''\n\n  const log = function (value) {\n    output = output + value + '\\n'\n  }\n\n  output += 'found '\n\n  if (Object.keys(data.advisories).length === 0) {\n    log(`${green('0')} vulnerabilities`)\n    return output\n  } else {\n    const total = Utils.totalVulnCount(data.metadata.vulnerabilities)\n    const sev = Utils.severities(data.metadata.vulnerabilities)\n\n    if (sev.length > 1) {\n      const severities = sev.map((value) => {\n        return `${value[1]} ${Utils.severityLabel(value[0], config.withColor).toLowerCase()}`\n      }).join(', ')\n      log(`${red(total)} vulnerabilities (${severities})`)\n    } else {\n      const vulnCount = sev[0][1]\n      const vulnLabel = Utils.severityLabel(sev[0][0], config.withColor).toLowerCase()\n      log(`${vulnCount} ${vulnLabel} severity vulnerabilit${vulnCount === 1 ? 'y' : 'ies'}`)\n    }\n  }\n  return output.trim()\n}\n"]}