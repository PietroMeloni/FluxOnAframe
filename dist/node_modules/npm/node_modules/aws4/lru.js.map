{"version":3,"sources":["../../../../../node_modules/npm/node_modules/aws4/lru.js"],"names":["module","exports","size","LruCache","capacity","map","Object","create","list","DoublyLinkedList","prototype","get","key","node","undefined","used","val","set","prune","DoublyLinkedNode","moveToFront","pop","firstNode","lastNode","remove","prev","next"],"mappings":"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","file":"lru.js","sourcesContent":["module.exports = function(size) {\n  return new LruCache(size)\n}\n\nfunction LruCache(size) {\n  this.capacity = size | 0\n  this.map = Object.create(null)\n  this.list = new DoublyLinkedList()\n}\n\nLruCache.prototype.get = function(key) {\n  var node = this.map[key]\n  if (node == null) return undefined\n  this.used(node)\n  return node.val\n}\n\nLruCache.prototype.set = function(key, val) {\n  var node = this.map[key]\n  if (node != null) {\n    node.val = val\n  } else {\n    if (!this.capacity) this.prune()\n    if (!this.capacity) return false\n    node = new DoublyLinkedNode(key, val)\n    this.map[key] = node\n    this.capacity--\n  }\n  this.used(node)\n  return true\n}\n\nLruCache.prototype.used = function(node) {\n  this.list.moveToFront(node)\n}\n\nLruCache.prototype.prune = function() {\n  var node = this.list.pop()\n  if (node != null) {\n    delete this.map[node.key]\n    this.capacity++\n  }\n}\n\n\nfunction DoublyLinkedList() {\n  this.firstNode = null\n  this.lastNode = null\n}\n\nDoublyLinkedList.prototype.moveToFront = function(node) {\n  if (this.firstNode == node) return\n\n  this.remove(node)\n\n  if (this.firstNode == null) {\n    this.firstNode = node\n    this.lastNode = node\n    node.prev = null\n    node.next = null\n  } else {\n    node.prev = null\n    node.next = this.firstNode\n    node.next.prev = node\n    this.firstNode = node\n  }\n}\n\nDoublyLinkedList.prototype.pop = function() {\n  var lastNode = this.lastNode\n  if (lastNode != null) {\n    this.remove(lastNode)\n  }\n  return lastNode\n}\n\nDoublyLinkedList.prototype.remove = function(node) {\n  if (this.firstNode == node) {\n    this.firstNode = node.next\n  } else if (node.prev != null) {\n    node.prev.next = node.next\n  }\n  if (this.lastNode == node) {\n    this.lastNode = node.prev\n  } else if (node.next != null) {\n    node.next.prev = node.prev\n  }\n}\n\n\nfunction DoublyLinkedNode(key, val) {\n  this.key = key\n  this.val = val\n  this.prev = null\n  this.next = null\n}\n"]}