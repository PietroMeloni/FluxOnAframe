{"version":3,"sources":["../../../../../../node_modules/npm/node_modules/fs-write-stream-atomic/test/toolong.js"],"names":["path","require","test","writeStream","repeat","times","string","output","ii","target","resolve","__dirname","t","plan","stream","hadError","on","er","is","code","length","ok","end"],"mappings":";;AAAA,IAAIA,OAAOC,QAAQ,MAAR,CAAX;AACA,IAAIC,OAAOD,QAAQ,KAAR,EAAeC,IAA1B;AACA,IAAIC,cAAcF,QAAQ,aAAR,CAAlB;;AAEA,SAASG,MAAT,CAAiBC,KAAjB,EAAwBC,MAAxB,EAAgC;AAC9B,MAAIC,SAAS,EAAb;AACA,OAAK,IAAIC,KAAK,CAAd,EAAiBA,KAAKH,KAAtB,EAA6B,EAAEG,EAA/B,EAAmC;AACjCD,cAAUD,MAAV;AACD;AACD,SAAOC,MAAP;AACD;;AAED,IAAIE,SAAST,KAAKU,OAAL,CAAaC,SAAb,EAAwBP,OAAO,IAAP,EAAa,MAAb,CAAxB,CAAb;;AAEAF,KAAK,eAAL,EAAsB,UAAUU,CAAV,EAAa;AACjCA,IAAEC,IAAF,CAAO,CAAP;AACA,MAAIC,SAASX,YAAYM,MAAZ,CAAb;AACA,MAAIM,WAAW,KAAf;AACAD,SAAOE,EAAP,CAAU,OAAV,EAAmB,UAAUC,EAAV,EAAc;AAC/B,QAAI,CAACF,QAAL,EAAe;AACbH,QAAEM,EAAF,CAAKD,GAAGE,IAAR,EAAc,cAAd,EAA8BV,OAAOW,MAAP,GAAgB,yCAA9C;AACAL,iBAAW,IAAX;AACD;AACF,GALD;AAMAD,SAAOE,EAAP,CAAU,OAAV,EAAmB,YAAY;AAC7BJ,MAAES,EAAF,CAAKN,QAAL,EAAe,wBAAf;AACD,GAFD;AAGAD,SAAOQ,GAAP;AACD,CAdD","file":"toolong.js","sourcesContent":["var path = require('path')\nvar test = require('tap').test\nvar writeStream = require('../index.js')\n\nfunction repeat (times, string) {\n  var output = ''\n  for (var ii = 0; ii < times; ++ii) {\n    output += string\n  }\n  return output\n}\n\nvar target = path.resolve(__dirname, repeat(1000, 'test'))\n\ntest('name too long', function (t) {\n  t.plan(2)\n  var stream = writeStream(target)\n  var hadError = false\n  stream.on('error', function (er) {\n    if (!hadError) {\n      t.is(er.code, 'ENAMETOOLONG', target.length + ' character name results in ENAMETOOLONG')\n      hadError = true\n    }\n  })\n  stream.on('close', function () {\n    t.ok(hadError, 'got error before close')\n  })\n  stream.end()\n})\n"]}