{"version":3,"sources":["../../../../../../node_modules/npm/node_modules/fs-write-stream-atomic/test/rename-fail.js"],"names":["fs","require","path","test","rimraf","writeStream","target","resolve","__dirname","t","plan","rename","src","dest","cb","Error","stream","hadError","on","er","console","log","is","end","sync"],"mappings":"AAAA;;AACA,IAAIA,KAAKC,QAAQ,aAAR,CAAT;AACA,IAAIC,OAAOD,QAAQ,MAAR,CAAX;AACA,IAAIE,OAAOF,QAAQ,KAAR,EAAeE,IAA1B;AACA,IAAIC,SAASH,QAAQ,QAAR,CAAb;AACA,IAAII,cAAcJ,QAAQ,aAAR,CAAlB;;AAEA,IAAIK,SAASJ,KAAKK,OAAL,CAAaC,SAAb,EAAwB,aAAxB,CAAb;;AAEAL,KAAK,cAAL,EAAqB,UAAUM,CAAV,EAAa;AAChCA,IAAEC,IAAF,CAAO,CAAP;AACAV,KAAGW,MAAH,GAAY,UAAUC,GAAV,EAAeC,IAAf,EAAqBC,EAArB,EAAyB;AACnCA,OAAG,IAAIC,KAAJ,CAAU,YAAV,CAAH;AACD,GAFD;AAGA,MAAIC,SAASX,YAAYC,MAAZ,CAAb;AACA,MAAIW,WAAW,KAAf;AACAD,SAAOE,EAAP,CAAU,OAAV,EAAmB,UAAUC,EAAV,EAAc;AAC/BF,eAAW,IAAX;AACAG,YAAQC,GAAR,CAAY,GAAZ,EAAiBF,EAAjB;AACD,GAHD;AAIAH,SAAOE,EAAP,CAAU,OAAV,EAAmB,YAAY;AAC7BT,MAAEa,EAAF,CAAKL,QAAL,EAAe,IAAf,EAAqB,oBAArB;AACD,GAFD;AAGAD,SAAOO,GAAP;AACD,CAfD;;AAiBApB,KAAK,SAAL,EAAgB,UAAUM,CAAV,EAAa;AAC3BL,SAAOoB,IAAP,CAAYlB,MAAZ;AACAG,IAAEc,GAAF;AACD,CAHD","file":"rename-fail.js","sourcesContent":["'use strict'\nvar fs = require('graceful-fs')\nvar path = require('path')\nvar test = require('tap').test\nvar rimraf = require('rimraf')\nvar writeStream = require('../index.js')\n\nvar target = path.resolve(__dirname, 'test-rename')\n\ntest('rename fails', function (t) {\n  t.plan(1)\n  fs.rename = function (src, dest, cb) {\n    cb(new Error('TEST BREAK'))\n  }\n  var stream = writeStream(target)\n  var hadError = false\n  stream.on('error', function (er) {\n    hadError = true\n    console.log('#', er)\n  })\n  stream.on('close', function () {\n    t.is(hadError, true, 'error before close')\n  })\n  stream.end()\n})\n\ntest('cleanup', function (t) {\n  rimraf.sync(target)\n  t.end()\n})\n"]}