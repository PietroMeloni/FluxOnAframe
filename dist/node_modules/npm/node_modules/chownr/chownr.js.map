{"version":3,"sources":["../../../../../node_modules/npm/node_modules/chownr/chownr.js"],"names":["module","exports","chownr","sync","chownrSync","fs","require","path","p","uid","gid","cb","readdir","er","children","code","length","chown","len","errState","forEach","child","pathChild","resolve","lstat","stats","isSymbolicLink","then","readdirSync","chownSync","lstatSync"],"mappings":";;AAAAA,OAAOC,OAAP,GAAiBC,MAAjB;AACAA,OAAOC,IAAP,GAAcC,UAAd;;AAEA,IAAIC,KAAKC,QAAQ,IAAR,CAAT;AAAA,IACEC,OAAOD,QAAQ,MAAR,CADT;;AAGA,SAASJ,MAAT,CAAiBM,CAAjB,EAAoBC,GAApB,EAAyBC,GAAzB,EAA8BC,EAA9B,EAAkC;AAChCN,KAAGO,OAAH,CAAWJ,CAAX,EAAc,UAAUK,EAAV,EAAcC,QAAd,EAAwB;AACpC;AACA;AACA,QAAID,MAAMA,GAAGE,IAAH,KAAY,SAAtB,EAAiC,OAAOJ,GAAGE,EAAH,CAAP;AACjC,QAAIA,MAAM,CAACC,SAASE,MAApB,EAA4B,OAAOX,GAAGY,KAAH,CAAST,CAAT,EAAYC,GAAZ,EAAiBC,GAAjB,EAAsBC,EAAtB,CAAP;;AAE5B,QAAIO,MAAMJ,SAASE,MAAnB;AAAA,QACEG,WAAW,IADb;AAEAL,aAASM,OAAT,CAAiB,UAAUC,KAAV,EAAiB;AAChC,UAAIC,YAAYf,KAAKgB,OAAL,CAAaf,CAAb,EAAgBa,KAAhB,CAAhB;AACAhB,SAAGmB,KAAH,CAASF,SAAT,EAAoB,UAAST,EAAT,EAAaY,KAAb,EAAoB;AACtC,YAAIZ,EAAJ,EACE,OAAOF,GAAGE,EAAH,CAAP;AACF,YAAI,CAACY,MAAMC,cAAN,EAAL,EACExB,OAAOoB,SAAP,EAAkBb,GAAlB,EAAuBC,GAAvB,EAA4BiB,IAA5B,EADF,KAGEA;AACD,OAPH;AAQD,KAVD;AAWA,aAASA,IAAT,CAAed,EAAf,EAAmB;AACjB,UAAIM,QAAJ,EAAc;AACd,UAAIN,EAAJ,EAAQ,OAAOF,GAAGQ,WAAWN,EAAd,CAAP;AACR,UAAI,EAAGK,GAAH,KAAW,CAAf,EAAkB,OAAOb,GAAGY,KAAH,CAAST,CAAT,EAAYC,GAAZ,EAAiBC,GAAjB,EAAsBC,EAAtB,CAAP;AACnB;AACF,GAxBD;AAyBD;;AAED,SAASP,UAAT,CAAqBI,CAArB,EAAwBC,GAAxB,EAA6BC,GAA7B,EAAkC;AAChC,MAAII,QAAJ;AACA,MAAI;AACFA,eAAWT,GAAGuB,WAAH,CAAepB,CAAf,CAAX;AACD,GAFD,CAEE,OAAOK,EAAP,EAAW;AACX,QAAIA,MAAMA,GAAGE,IAAH,KAAY,SAAtB,EAAiC,OAAOV,GAAGwB,SAAH,CAAarB,CAAb,EAAgBC,GAAhB,EAAqBC,GAArB,CAAP;AACjC,UAAMG,EAAN;AACD;AACD,MAAI,CAACC,SAASE,MAAd,EAAsB,OAAOX,GAAGwB,SAAH,CAAarB,CAAb,EAAgBC,GAAhB,EAAqBC,GAArB,CAAP;;AAEtBI,WAASM,OAAT,CAAiB,UAAUC,KAAV,EAAiB;AAChC,QAAIC,YAAYf,KAAKgB,OAAL,CAAaf,CAAb,EAAgBa,KAAhB,CAAhB;AACA,QAAII,QAAQpB,GAAGyB,SAAH,CAAaR,SAAb,CAAZ;AACA,QAAI,CAACG,MAAMC,cAAN,EAAL,EACEtB,WAAWkB,SAAX,EAAsBb,GAAtB,EAA2BC,GAA3B;AACH,GALD;AAMA,SAAOL,GAAGwB,SAAH,CAAarB,CAAb,EAAgBC,GAAhB,EAAqBC,GAArB,CAAP;AACD","file":"chownr.js","sourcesContent":["module.exports = chownr\nchownr.sync = chownrSync\n\nvar fs = require(\"fs\")\n, path = require(\"path\")\n\nfunction chownr (p, uid, gid, cb) {\n  fs.readdir(p, function (er, children) {\n    // any error other than ENOTDIR means it's not readable, or\n    // doesn't exist.  give up.\n    if (er && er.code !== \"ENOTDIR\") return cb(er)\n    if (er || !children.length) return fs.chown(p, uid, gid, cb)\n\n    var len = children.length\n    , errState = null\n    children.forEach(function (child) {\n      var pathChild = path.resolve(p, child);\n      fs.lstat(pathChild, function(er, stats) {\n        if (er)\n          return cb(er)\n        if (!stats.isSymbolicLink())\n          chownr(pathChild, uid, gid, then)\n        else\n          then()\n        })\n    })\n    function then (er) {\n      if (errState) return\n      if (er) return cb(errState = er)\n      if (-- len === 0) return fs.chown(p, uid, gid, cb)\n    }\n  })\n}\n\nfunction chownrSync (p, uid, gid) {\n  var children\n  try {\n    children = fs.readdirSync(p)\n  } catch (er) {\n    if (er && er.code === \"ENOTDIR\") return fs.chownSync(p, uid, gid)\n    throw er\n  }\n  if (!children.length) return fs.chownSync(p, uid, gid)\n\n  children.forEach(function (child) {\n    var pathChild = path.resolve(p, child)\n    var stats = fs.lstatSync(pathChild)\n    if (!stats.isSymbolicLink())\n      chownrSync(pathChild, uid, gid)\n  })\n  return fs.chownSync(p, uid, gid)\n}\n"]}