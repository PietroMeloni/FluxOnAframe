{"version":3,"sources":["../../../../../node_modules/npm/node_modules/lru-cache/index.js"],"names":["module","exports","LRUCache","Map","require","util","Yallist","hasSymbol","Symbol","makeSymbol","key","MAX","LENGTH","LENGTH_CALCULATOR","ALLOW_STALE","MAX_AGE","DISPOSE","NO_DISPOSE_ON_SET","LRU_LIST","CACHE","naiveLength","options","max","Infinity","lc","length","stale","maxAge","dispose","noDisposeOnSet","reset","Object","defineProperty","prototype","set","mL","trim","get","enumerable","allowStale","mA","lC","forEach","hit","value","rforEach","fn","thisp","walker","tail","prev","forEachStep","self","node","isStale","del","undefined","call","head","next","keys","toArray","map","k","values","dump","v","e","now","filter","h","dumpLru","inspect","n","opts","str","extras","as","didFirst","item","split","join","val","Date","len","has","Entry","unshift","peek","pop","load","arr","l","expiresAt","prune","doUse","unshiftNode","diff","delete","removeNode"],"mappings":"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","file":"index.js","sourcesContent":["'use strict'\n\nmodule.exports = LRUCache\n\n// This will be a proper iterable 'Map' in engines that support it,\n// or a fakey-fake PseudoMap in older versions.\nvar Map = require('pseudomap')\nvar util = require('util')\n\n// A linked list to keep track of recently-used-ness\nvar Yallist = require('yallist')\n\n// use symbols if possible, otherwise just _props\nvar hasSymbol = typeof Symbol === 'function'\nvar makeSymbol\nif (hasSymbol) {\n  makeSymbol = function (key) {\n    return Symbol(key)\n  }\n} else {\n  makeSymbol = function (key) {\n    return '_' + key\n  }\n}\n\nvar MAX = makeSymbol('max')\nvar LENGTH = makeSymbol('length')\nvar LENGTH_CALCULATOR = makeSymbol('lengthCalculator')\nvar ALLOW_STALE = makeSymbol('allowStale')\nvar MAX_AGE = makeSymbol('maxAge')\nvar DISPOSE = makeSymbol('dispose')\nvar NO_DISPOSE_ON_SET = makeSymbol('noDisposeOnSet')\nvar LRU_LIST = makeSymbol('lruList')\nvar CACHE = makeSymbol('cache')\n\nfunction naiveLength () { return 1 }\n\n// lruList is a yallist where the head is the youngest\n// item, and the tail is the oldest.  the list contains the Hit\n// objects as the entries.\n// Each Hit object has a reference to its Yallist.Node.  This\n// never changes.\n//\n// cache is a Map (or PseudoMap) that matches the keys to\n// the Yallist.Node object.\nfunction LRUCache (options) {\n  if (!(this instanceof LRUCache)) {\n    return new LRUCache(options)\n  }\n\n  if (typeof options === 'number') {\n    options = { max: options }\n  }\n\n  if (!options) {\n    options = {}\n  }\n\n  var max = this[MAX] = options.max\n  // Kind of weird to have a default max of Infinity, but oh well.\n  if (!max ||\n      !(typeof max === 'number') ||\n      max <= 0) {\n    this[MAX] = Infinity\n  }\n\n  var lc = options.length || naiveLength\n  if (typeof lc !== 'function') {\n    lc = naiveLength\n  }\n  this[LENGTH_CALCULATOR] = lc\n\n  this[ALLOW_STALE] = options.stale || false\n  this[MAX_AGE] = options.maxAge || 0\n  this[DISPOSE] = options.dispose\n  this[NO_DISPOSE_ON_SET] = options.noDisposeOnSet || false\n  this.reset()\n}\n\n// resize the cache when the max changes.\nObject.defineProperty(LRUCache.prototype, 'max', {\n  set: function (mL) {\n    if (!mL || !(typeof mL === 'number') || mL <= 0) {\n      mL = Infinity\n    }\n    this[MAX] = mL\n    trim(this)\n  },\n  get: function () {\n    return this[MAX]\n  },\n  enumerable: true\n})\n\nObject.defineProperty(LRUCache.prototype, 'allowStale', {\n  set: function (allowStale) {\n    this[ALLOW_STALE] = !!allowStale\n  },\n  get: function () {\n    return this[ALLOW_STALE]\n  },\n  enumerable: true\n})\n\nObject.defineProperty(LRUCache.prototype, 'maxAge', {\n  set: function (mA) {\n    if (!mA || !(typeof mA === 'number') || mA < 0) {\n      mA = 0\n    }\n    this[MAX_AGE] = mA\n    trim(this)\n  },\n  get: function () {\n    return this[MAX_AGE]\n  },\n  enumerable: true\n})\n\n// resize the cache when the lengthCalculator changes.\nObject.defineProperty(LRUCache.prototype, 'lengthCalculator', {\n  set: function (lC) {\n    if (typeof lC !== 'function') {\n      lC = naiveLength\n    }\n    if (lC !== this[LENGTH_CALCULATOR]) {\n      this[LENGTH_CALCULATOR] = lC\n      this[LENGTH] = 0\n      this[LRU_LIST].forEach(function (hit) {\n        hit.length = this[LENGTH_CALCULATOR](hit.value, hit.key)\n        this[LENGTH] += hit.length\n      }, this)\n    }\n    trim(this)\n  },\n  get: function () { return this[LENGTH_CALCULATOR] },\n  enumerable: true\n})\n\nObject.defineProperty(LRUCache.prototype, 'length', {\n  get: function () { return this[LENGTH] },\n  enumerable: true\n})\n\nObject.defineProperty(LRUCache.prototype, 'itemCount', {\n  get: function () { return this[LRU_LIST].length },\n  enumerable: true\n})\n\nLRUCache.prototype.rforEach = function (fn, thisp) {\n  thisp = thisp || this\n  for (var walker = this[LRU_LIST].tail; walker !== null;) {\n    var prev = walker.prev\n    forEachStep(this, fn, walker, thisp)\n    walker = prev\n  }\n}\n\nfunction forEachStep (self, fn, node, thisp) {\n  var hit = node.value\n  if (isStale(self, hit)) {\n    del(self, node)\n    if (!self[ALLOW_STALE]) {\n      hit = undefined\n    }\n  }\n  if (hit) {\n    fn.call(thisp, hit.value, hit.key, self)\n  }\n}\n\nLRUCache.prototype.forEach = function (fn, thisp) {\n  thisp = thisp || this\n  for (var walker = this[LRU_LIST].head; walker !== null;) {\n    var next = walker.next\n    forEachStep(this, fn, walker, thisp)\n    walker = next\n  }\n}\n\nLRUCache.prototype.keys = function () {\n  return this[LRU_LIST].toArray().map(function (k) {\n    return k.key\n  }, this)\n}\n\nLRUCache.prototype.values = function () {\n  return this[LRU_LIST].toArray().map(function (k) {\n    return k.value\n  }, this)\n}\n\nLRUCache.prototype.reset = function () {\n  if (this[DISPOSE] &&\n      this[LRU_LIST] &&\n      this[LRU_LIST].length) {\n    this[LRU_LIST].forEach(function (hit) {\n      this[DISPOSE](hit.key, hit.value)\n    }, this)\n  }\n\n  this[CACHE] = new Map() // hash of items by key\n  this[LRU_LIST] = new Yallist() // list of items in order of use recency\n  this[LENGTH] = 0 // length of items in the list\n}\n\nLRUCache.prototype.dump = function () {\n  return this[LRU_LIST].map(function (hit) {\n    if (!isStale(this, hit)) {\n      return {\n        k: hit.key,\n        v: hit.value,\n        e: hit.now + (hit.maxAge || 0)\n      }\n    }\n  }, this).toArray().filter(function (h) {\n    return h\n  })\n}\n\nLRUCache.prototype.dumpLru = function () {\n  return this[LRU_LIST]\n}\n\nLRUCache.prototype.inspect = function (n, opts) {\n  var str = 'LRUCache {'\n  var extras = false\n\n  var as = this[ALLOW_STALE]\n  if (as) {\n    str += '\\n  allowStale: true'\n    extras = true\n  }\n\n  var max = this[MAX]\n  if (max && max !== Infinity) {\n    if (extras) {\n      str += ','\n    }\n    str += '\\n  max: ' + util.inspect(max, opts)\n    extras = true\n  }\n\n  var maxAge = this[MAX_AGE]\n  if (maxAge) {\n    if (extras) {\n      str += ','\n    }\n    str += '\\n  maxAge: ' + util.inspect(maxAge, opts)\n    extras = true\n  }\n\n  var lc = this[LENGTH_CALCULATOR]\n  if (lc && lc !== naiveLength) {\n    if (extras) {\n      str += ','\n    }\n    str += '\\n  length: ' + util.inspect(this[LENGTH], opts)\n    extras = true\n  }\n\n  var didFirst = false\n  this[LRU_LIST].forEach(function (item) {\n    if (didFirst) {\n      str += ',\\n  '\n    } else {\n      if (extras) {\n        str += ',\\n'\n      }\n      didFirst = true\n      str += '\\n  '\n    }\n    var key = util.inspect(item.key).split('\\n').join('\\n  ')\n    var val = { value: item.value }\n    if (item.maxAge !== maxAge) {\n      val.maxAge = item.maxAge\n    }\n    if (lc !== naiveLength) {\n      val.length = item.length\n    }\n    if (isStale(this, item)) {\n      val.stale = true\n    }\n\n    val = util.inspect(val, opts).split('\\n').join('\\n  ')\n    str += key + ' => ' + val\n  })\n\n  if (didFirst || extras) {\n    str += '\\n'\n  }\n  str += '}'\n\n  return str\n}\n\nLRUCache.prototype.set = function (key, value, maxAge) {\n  maxAge = maxAge || this[MAX_AGE]\n\n  var now = maxAge ? Date.now() : 0\n  var len = this[LENGTH_CALCULATOR](value, key)\n\n  if (this[CACHE].has(key)) {\n    if (len > this[MAX]) {\n      del(this, this[CACHE].get(key))\n      return false\n    }\n\n    var node = this[CACHE].get(key)\n    var item = node.value\n\n    // dispose of the old one before overwriting\n    // split out into 2 ifs for better coverage tracking\n    if (this[DISPOSE]) {\n      if (!this[NO_DISPOSE_ON_SET]) {\n        this[DISPOSE](key, item.value)\n      }\n    }\n\n    item.now = now\n    item.maxAge = maxAge\n    item.value = value\n    this[LENGTH] += len - item.length\n    item.length = len\n    this.get(key)\n    trim(this)\n    return true\n  }\n\n  var hit = new Entry(key, value, len, now, maxAge)\n\n  // oversized objects fall out of cache automatically.\n  if (hit.length > this[MAX]) {\n    if (this[DISPOSE]) {\n      this[DISPOSE](key, value)\n    }\n    return false\n  }\n\n  this[LENGTH] += hit.length\n  this[LRU_LIST].unshift(hit)\n  this[CACHE].set(key, this[LRU_LIST].head)\n  trim(this)\n  return true\n}\n\nLRUCache.prototype.has = function (key) {\n  if (!this[CACHE].has(key)) return false\n  var hit = this[CACHE].get(key).value\n  if (isStale(this, hit)) {\n    return false\n  }\n  return true\n}\n\nLRUCache.prototype.get = function (key) {\n  return get(this, key, true)\n}\n\nLRUCache.prototype.peek = function (key) {\n  return get(this, key, false)\n}\n\nLRUCache.prototype.pop = function () {\n  var node = this[LRU_LIST].tail\n  if (!node) return null\n  del(this, node)\n  return node.value\n}\n\nLRUCache.prototype.del = function (key) {\n  del(this, this[CACHE].get(key))\n}\n\nLRUCache.prototype.load = function (arr) {\n  // reset the cache\n  this.reset()\n\n  var now = Date.now()\n  // A previous serialized cache has the most recent items first\n  for (var l = arr.length - 1; l >= 0; l--) {\n    var hit = arr[l]\n    var expiresAt = hit.e || 0\n    if (expiresAt === 0) {\n      // the item was created without expiration in a non aged cache\n      this.set(hit.k, hit.v)\n    } else {\n      var maxAge = expiresAt - now\n      // dont add already expired items\n      if (maxAge > 0) {\n        this.set(hit.k, hit.v, maxAge)\n      }\n    }\n  }\n}\n\nLRUCache.prototype.prune = function () {\n  var self = this\n  this[CACHE].forEach(function (value, key) {\n    get(self, key, false)\n  })\n}\n\nfunction get (self, key, doUse) {\n  var node = self[CACHE].get(key)\n  if (node) {\n    var hit = node.value\n    if (isStale(self, hit)) {\n      del(self, node)\n      if (!self[ALLOW_STALE]) hit = undefined\n    } else {\n      if (doUse) {\n        self[LRU_LIST].unshiftNode(node)\n      }\n    }\n    if (hit) hit = hit.value\n  }\n  return hit\n}\n\nfunction isStale (self, hit) {\n  if (!hit || (!hit.maxAge && !self[MAX_AGE])) {\n    return false\n  }\n  var stale = false\n  var diff = Date.now() - hit.now\n  if (hit.maxAge) {\n    stale = diff > hit.maxAge\n  } else {\n    stale = self[MAX_AGE] && (diff > self[MAX_AGE])\n  }\n  return stale\n}\n\nfunction trim (self) {\n  if (self[LENGTH] > self[MAX]) {\n    for (var walker = self[LRU_LIST].tail;\n         self[LENGTH] > self[MAX] && walker !== null;) {\n      // We know that we're about to delete this one, and also\n      // what the next least recently used key will be, so just\n      // go ahead and set it now.\n      var prev = walker.prev\n      del(self, walker)\n      walker = prev\n    }\n  }\n}\n\nfunction del (self, node) {\n  if (node) {\n    var hit = node.value\n    if (self[DISPOSE]) {\n      self[DISPOSE](hit.key, hit.value)\n    }\n    self[LENGTH] -= hit.length\n    self[CACHE].delete(hit.key)\n    self[LRU_LIST].removeNode(node)\n  }\n}\n\n// classy, since V8 prefers predictable objects.\nfunction Entry (key, value, length, now, maxAge) {\n  this.key = key\n  this.value = value\n  this.length = length\n  this.now = now\n  this.maxAge = maxAge || 0\n}\n"]}