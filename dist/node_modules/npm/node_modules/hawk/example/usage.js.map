{"version":3,"sources":["../../../../../../node_modules/npm/node_modules/hawk/example/usage.js"],"names":["Http","require","Request","Hawk","internals","credentials","dh37fgj492je","id","key","algorithm","user","credentialsFunc","callback","handler","req","res","server","authenticate","err","artifacts","payload","ext","headers","header","contentType","writeHead","end","createServer","listen","error","response","body","console","log","statusCode","client","options","uri","method","authorization","field","isValid","process","exit"],"mappings":";;AAAA;;AAEA,IAAIA,OAAOC,QAAQ,MAAR,CAAX;AACA,IAAIC,UAAUD,QAAQ,SAAR,CAAd;AACA,IAAIE,OAAOF,QAAQ,QAAR,CAAX;;AAGA;;AAEA,IAAIG,YAAY;AACZC,iBAAa;AACTC,sBAAc;AACVC,gBAAI,cADM,EACsD;AAChEC,iBAAK,6CAFK;AAGVC,uBAAW,QAHD;AAIVC,kBAAM;AAJI;AADL;AADD,CAAhB;;AAYA;;AAEA,IAAIC,kBAAkB,SAAlBA,eAAkB,CAAUJ,EAAV,EAAcK,QAAd,EAAwB;;AAE1C,WAAOA,SAAS,IAAT,EAAeR,UAAUC,WAAV,CAAsBE,EAAtB,CAAf,CAAP;AACH,CAHD;;AAMA;;AAEA,IAAIM,UAAU,SAAVA,OAAU,CAAUC,GAAV,EAAeC,GAAf,EAAoB;;AAE9BZ,SAAKa,MAAL,CAAYC,YAAZ,CAAyBH,GAAzB,EAA8BH,eAA9B,EAA+C,EAA/C,EAAmD,UAAUO,GAAV,EAAeb,WAAf,EAA4Bc,SAA5B,EAAuC;;AAEtF,YAAIC,UAAW,CAACF,GAAD,GAAO,WAAWb,YAAYK,IAAvB,GAA8B,GAA9B,GAAoCS,UAAUE,GAArD,GAA2D,SAA1E;AACA,YAAIC,UAAU;AACV,4BAAgB,YADN;AAEV,oCAAwBnB,KAAKa,MAAL,CAAYO,MAAZ,CAAmBlB,WAAnB,EAAgCc,SAAhC,EAA2C,EAAEC,SAASA,OAAX,EAAoBI,aAAa,YAAjC,EAA3C;AAFd,SAAd;;AAKAT,YAAIU,SAAJ,CAAc,CAACP,GAAD,GAAO,GAAP,GAAa,GAA3B,EAAgCI,OAAhC;AACAP,YAAIW,GAAJ,CAAQN,OAAR;AACH,KAVD;AAWH,CAbD;;AAeApB,KAAK2B,YAAL,CAAkBd,OAAlB,EAA2Be,MAA3B,CAAkC,IAAlC,EAAwC,WAAxC;;AAGA;;AAEA1B,QAAQ,0CAAR,EAAoD,UAAU2B,KAAV,EAAiBC,QAAjB,EAA2BC,IAA3B,EAAiC;;AAEjFC,YAAQC,GAAR,CAAYH,SAASI,UAAT,GAAsB,IAAtB,GAA6BH,IAAzC;AACH,CAHD;;AAMA;;AAEApB,gBAAgB,cAAhB,EAAgC,UAAUO,GAAV,EAAeb,WAAf,EAA4B;;AAExD,QAAIkB,SAASpB,KAAKgC,MAAL,CAAYZ,MAAZ,CAAmB,0CAAnB,EAA+D,KAA/D,EAAsE,EAAElB,aAAaA,WAAf,EAA4BgB,KAAK,cAAjC,EAAtE,CAAb;AACA,QAAIe,UAAU;AACVC,aAAK,0CADK;AAEVC,gBAAQ,KAFE;AAGVhB,iBAAS;AACLiB,2BAAehB,OAAOiB;AADjB;AAHC,KAAd;;AAQAtC,YAAQkC,OAAR,EAAiB,UAAUP,KAAV,EAAiBC,QAAjB,EAA2BC,IAA3B,EAAiC;;AAE9C,YAAIU,UAAUtC,KAAKgC,MAAL,CAAYlB,YAAZ,CAAyBa,QAAzB,EAAmCzB,WAAnC,EAAgDkB,OAAOJ,SAAvD,EAAkE,EAAEC,SAASW,IAAX,EAAlE,CAAd;AACAC,gBAAQC,GAAR,CAAYH,SAASI,UAAT,GAAsB,IAAtB,GAA6BH,IAA7B,IAAqCU,UAAU,UAAV,GAAuB,YAA5D,CAAZ;AACAC,gBAAQC,IAAR,CAAa,CAAb;AACH,KALD;AAMH,CAjBD","file":"usage.js","sourcesContent":["// Load modules\r\n\r\nvar Http = require('http');\r\nvar Request = require('request');\r\nvar Hawk = require('../lib');\r\n\r\n\r\n// Declare internals\r\n\r\nvar internals = {\r\n    credentials: {\r\n        dh37fgj492je: {\r\n            id: 'dh37fgj492je',                                             // Required by Hawk.client.header\r\n            key: 'werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn',\r\n            algorithm: 'sha256',\r\n            user: 'Steve'\r\n        }\r\n    }\r\n};\r\n\r\n\r\n// Credentials lookup function\r\n\r\nvar credentialsFunc = function (id, callback) {\r\n\r\n    return callback(null, internals.credentials[id]);\r\n};\r\n\r\n\r\n// Create HTTP server\r\n\r\nvar handler = function (req, res) {\r\n\r\n    Hawk.server.authenticate(req, credentialsFunc, {}, function (err, credentials, artifacts) {\r\n\r\n        var payload = (!err ? 'Hello ' + credentials.user + ' ' + artifacts.ext : 'Shoosh!');\r\n        var headers = {\r\n            'Content-Type': 'text/plain',\r\n            'Server-Authorization': Hawk.server.header(credentials, artifacts, { payload: payload, contentType: 'text/plain' })\r\n        };\r\n\r\n        res.writeHead(!err ? 200 : 401, headers);\r\n        res.end(payload);\r\n    });\r\n};\r\n\r\nHttp.createServer(handler).listen(8000, '127.0.0.1');\r\n\r\n\r\n// Send unauthenticated request\r\n\r\nRequest('http://127.0.0.1:8000/resource/1?b=1&a=2', function (error, response, body) {\r\n\r\n    console.log(response.statusCode + ': ' + body);\r\n});\r\n\r\n\r\n// Send authenticated request\r\n\r\ncredentialsFunc('dh37fgj492je', function (err, credentials) {\r\n\r\n    var header = Hawk.client.header('http://127.0.0.1:8000/resource/1?b=1&a=2', 'GET', { credentials: credentials, ext: 'and welcome!' });\r\n    var options = {\r\n        uri: 'http://127.0.0.1:8000/resource/1?b=1&a=2',\r\n        method: 'GET',\r\n        headers: {\r\n            authorization: header.field\r\n        }\r\n    };\r\n\r\n    Request(options, function (error, response, body) {\r\n\r\n        var isValid = Hawk.client.authenticate(response, credentials, header.artifacts, { payload: body });\r\n        console.log(response.statusCode + ': ' + body + (isValid ? ' (valid)' : ' (invalid)'));\r\n        process.exit(0);\r\n    });\r\n});\r\n\r\n"]}