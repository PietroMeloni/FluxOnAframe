{"version":3,"sources":["../../../../../../node_modules/npm/node_modules/hawk/test/client.js"],"names":["Url","require","Code","Hawk","Lab","internals","lab","exports","script","describe","experiment","it","test","expect","done","credentials","id","key","algorithm","header","client","ext","timestamp","nonce","payload","field","to","equal","contentType","options","hash","crypto","calculatePayloadHash","err","res","headers","authenticate","artifacts","method","host","port","resource","ts","app","undefined","dlg","mac","user","auth","message","exist","not"],"mappings":";;AAAA;;AAEA,IAAIA,MAAMC,QAAQ,KAAR,CAAV;AACA,IAAIC,OAAOD,QAAQ,MAAR,CAAX;AACA,IAAIE,OAAOF,QAAQ,QAAR,CAAX;AACA,IAAIG,MAAMH,QAAQ,KAAR,CAAV;;AAGA;;AAEA,IAAII,YAAY,EAAhB;;AAGA;;AAEA,IAAIC,MAAMC,QAAQD,GAAR,GAAcF,IAAII,MAAJ,EAAxB;AACA,IAAIC,WAAWH,IAAII,UAAnB;AACA,IAAIC,KAAKL,IAAIM,IAAb;AACA,IAAIC,SAASX,KAAKW,MAAlB;;AAGAJ,SAAS,QAAT,EAAmB,YAAY;;AAE3BA,aAAS,UAAT,EAAqB,YAAY;;AAE7BE,WAAG,6CAAH,EAAkD,UAAUG,IAAV,EAAgB;;AAE9D,gBAAIC,cAAc;AACdC,oBAAI,QADU;AAEdC,qBAAK,eAFS;AAGdC,2BAAW;AAHG,aAAlB;;AAMA,gBAAIC,SAAShB,KAAKiB,MAAL,CAAYD,MAAZ,CAAmB,+CAAnB,EAAoE,MAApE,EAA4E,EAAEJ,aAAaA,WAAf,EAA4BM,KAAK,UAAjC,EAA6CC,WAAW,UAAxD,EAAoEC,OAAO,QAA3E,EAAqFC,SAAS,0BAA9F,EAA5E,EAAwMC,KAArN;AACAZ,mBAAOM,MAAP,EAAeO,EAAf,CAAkBC,KAAlB,CAAwB,4IAAxB;AACAb;AACH,SAXD;;AAaAH,WAAG,+CAAH,EAAoD,UAAUG,IAAV,EAAgB;;AAEhE,gBAAIC,cAAc;AACdC,oBAAI,QADU;AAEdC,qBAAK,eAFS;AAGdC,2BAAW;AAHG,aAAlB;;AAMA,gBAAIC,SAAShB,KAAKiB,MAAL,CAAYD,MAAZ,CAAmB,gDAAnB,EAAqE,MAArE,EAA6E,EAAEJ,aAAaA,WAAf,EAA4BM,KAAK,UAAjC,EAA6CC,WAAW,UAAxD,EAAoEC,OAAO,QAA3E,EAAqFC,SAAS,0BAA9F,EAA0HI,aAAa,YAAvI,EAA7E,EAAoOH,KAAjP;AACAZ,mBAAOM,MAAP,EAAeO,EAAf,CAAkBC,KAAlB,CAAwB,4KAAxB;AACAb;AACH,SAXD;;AAaAH,WAAG,+CAAH,EAAoD,UAAUG,IAAV,EAAgB;;AAEhE,gBAAIC,cAAc;AACdC,oBAAI,QADU;AAEdC,qBAAK,eAFS;AAGdC,2BAAW;AAHG,aAAlB;;AAMA,gBAAIC,SAAShB,KAAKiB,MAAL,CAAYD,MAAZ,CAAmB,gDAAnB,EAAqE,MAArE,EAA6E,EAAEJ,aAAaA,WAAf,EAA4BO,WAAW,UAAvC,EAAmDC,OAAO,QAA1D,EAAoEC,SAAS,0BAA7E,EAAyGI,aAAa,YAAtH,EAA7E,EAAmNH,KAAhO;AACAZ,mBAAOM,MAAP,EAAeO,EAAf,CAAkBC,KAAlB,CAAwB,4JAAxB;AACAb;AACH,SAXD;;AAaAH,WAAG,iDAAH,EAAsD,UAAUG,IAAV,EAAgB;;AAElE,gBAAIC,cAAc;AACdC,oBAAI,QADU;AAEdC,qBAAK,eAFS;AAGdC,2BAAW;AAHG,aAAlB;;AAMA,gBAAIC,SAAShB,KAAKiB,MAAL,CAAYD,MAAZ,CAAmB,gDAAnB,EAAqE,MAArE,EAA6E,EAAEJ,aAAaA,WAAf,EAA4BO,WAAW,UAAvC,EAAmDC,OAAO,QAA1D,EAAoEC,SAAS,0BAA7E,EAAyGI,aAAa,YAAtH,EAAoIP,KAAK,IAAzI,EAA7E,EAA8NI,KAA3O;AACAZ,mBAAOM,MAAP,EAAeO,EAAf,CAAkBC,KAAlB,CAAwB,4JAAxB;AACAb;AACH,SAXD;;AAaAH,WAAG,sDAAH,EAA2D,UAAUG,IAAV,EAAgB;;AAEvE,gBAAIC,cAAc;AACdC,oBAAI,QADU;AAEdC,qBAAK,eAFS;AAGdC,2BAAW;AAHG,aAAlB;;AAMA,gBAAIC,SAAShB,KAAKiB,MAAL,CAAYD,MAAZ,CAAmB,gDAAnB,EAAqE,MAArE,EAA6E,EAAEJ,aAAaA,WAAf,EAA4BO,WAAW,UAAvC,EAAmDC,OAAO,QAA1D,EAAoEC,SAAS,EAA7E,EAAiFI,aAAa,YAA9F,EAA7E,EAA2LH,KAAxM;AACAZ,mBAAOM,MAAP,EAAeO,EAAf,CAAkBC,KAAlB,CAAwB,sKAAxB;AACAb;AACH,SAXD;;AAaAH,WAAG,2DAAH,EAAgE,UAAUG,IAAV,EAAgB;;AAE5E,gBAAIC,cAAc;AACdC,oBAAI,QADU;AAEdC,qBAAK,eAFS;AAGdC,2BAAW;AAHG,aAAlB;;AAMA,gBAAIW,UAAU,EAAEd,aAAaA,WAAf,EAA4BO,WAAW,UAAvC,EAAmDC,OAAO,QAA1D,EAAoEC,SAAS,0BAA7E,EAAyGI,aAAa,YAAtH,EAAd;AACAC,oBAAQC,IAAR,GAAe3B,KAAK4B,MAAL,CAAYC,oBAAZ,CAAiCH,QAAQL,OAAzC,EAAkDT,YAAYG,SAA9D,EAAyEW,QAAQD,WAAjF,CAAf;AACA,gBAAIT,SAAShB,KAAKiB,MAAL,CAAYD,MAAZ,CAAmB,gDAAnB,EAAqE,MAArE,EAA6EU,OAA7E,EAAsFJ,KAAnG;AACAZ,mBAAOM,MAAP,EAAeO,EAAf,CAAkBC,KAAlB,CAAwB,4JAAxB;AACAb;AACH,SAbD;;AAeAH,WAAG,uBAAH,EAA4B,UAAUG,IAAV,EAAgB;;AAExC,gBAAIK,SAAShB,KAAKiB,MAAL,CAAYD,MAAZ,CAAmB,EAAnB,EAAuB,MAAvB,CAAb;AACAN,mBAAOM,OAAOM,KAAd,EAAqBC,EAArB,CAAwBC,KAAxB,CAA8B,EAA9B;AACAd,mBAAOM,OAAOc,GAAd,EAAmBP,EAAnB,CAAsBC,KAAtB,CAA4B,uBAA5B;AACAb;AACH,SAND;;AAQAH,WAAG,uBAAH,EAA4B,UAAUG,IAAV,EAAgB;;AAExC,gBAAIK,SAAShB,KAAKiB,MAAL,CAAYD,MAAZ,CAAmB,CAAnB,EAAsB,MAAtB,CAAb;AACAN,mBAAOM,OAAOM,KAAd,EAAqBC,EAArB,CAAwBC,KAAxB,CAA8B,EAA9B;AACAd,mBAAOM,OAAOc,GAAd,EAAmBP,EAAnB,CAAsBC,KAAtB,CAA4B,uBAA5B;AACAb;AACH,SAND;;AAQAH,WAAG,0BAAH,EAA+B,UAAUG,IAAV,EAAgB;;AAE3C,gBAAIK,SAAShB,KAAKiB,MAAL,CAAYD,MAAZ,CAAmB,gDAAnB,EAAqE,EAArE,CAAb;AACAN,mBAAOM,OAAOM,KAAd,EAAqBC,EAArB,CAAwBC,KAAxB,CAA8B,EAA9B;AACAd,mBAAOM,OAAOc,GAAd,EAAmBP,EAAnB,CAAsBC,KAAtB,CAA4B,uBAA5B;AACAb;AACH,SAND;;AAQAH,WAAG,0BAAH,EAA+B,UAAUG,IAAV,EAAgB;;AAE3C,gBAAIK,SAAShB,KAAKiB,MAAL,CAAYD,MAAZ,CAAmB,gDAAnB,EAAqE,CAArE,CAAb;AACAN,mBAAOM,OAAOM,KAAd,EAAqBC,EAArB,CAAwBC,KAAxB,CAA8B,EAA9B;AACAd,mBAAOM,OAAOc,GAAd,EAAmBP,EAAnB,CAAsBC,KAAtB,CAA4B,uBAA5B;AACAb;AACH,SAND;;AAQAH,WAAG,2BAAH,EAAgC,UAAUG,IAAV,EAAgB;;AAE5C,gBAAIK,SAAShB,KAAKiB,MAAL,CAAYD,MAAZ,CAAmB,gDAAnB,EAAqE,MAArE,CAAb;AACAN,mBAAOM,OAAOM,KAAd,EAAqBC,EAArB,CAAwBC,KAAxB,CAA8B,EAA9B;AACAd,mBAAOM,OAAOc,GAAd,EAAmBP,EAAnB,CAAsBC,KAAtB,CAA4B,uBAA5B;AACAb;AACH,SAND;;AAQAH,WAAG,oCAAH,EAAyC,UAAUG,IAAV,EAAgB;;AAErD,gBAAIC,cAAc;AACdE,qBAAK,eADS;AAEdC,2BAAW;AAFG,aAAlB;;AAKA,gBAAIC,SAAShB,KAAKiB,MAAL,CAAYD,MAAZ,CAAmB,gDAAnB,EAAqE,MAArE,EAA6E,EAAEJ,aAAaA,WAAf,EAA4BM,KAAK,UAAjC,EAA6CC,WAAW,UAAxD,EAA7E,CAAb;AACAT,mBAAOM,OAAOM,KAAd,EAAqBC,EAArB,CAAwBC,KAAxB,CAA8B,EAA9B;AACAd,mBAAOM,OAAOc,GAAd,EAAmBP,EAAnB,CAAsBC,KAAtB,CAA4B,2BAA5B;AACAb;AACH,SAXD;;AAaAH,WAAG,+BAAH,EAAoC,UAAUG,IAAV,EAAgB;;AAEhD,gBAAIK,SAAShB,KAAKiB,MAAL,CAAYD,MAAZ,CAAmB,gDAAnB,EAAqE,MAArE,EAA6E,EAAEE,KAAK,UAAP,EAAmBC,WAAW,UAA9B,EAA7E,CAAb;AACAT,mBAAOM,OAAOM,KAAd,EAAqBC,EAArB,CAAwBC,KAAxB,CAA8B,EAA9B;AACAd,mBAAOM,OAAOc,GAAd,EAAmBP,EAAnB,CAAsBC,KAAtB,CAA4B,2BAA5B;AACAb;AACH,SAND;;AAQAH,WAAG,+BAAH,EAAoC,UAAUG,IAAV,EAAgB;;AAEhD,gBAAIC,cAAc;AACdC,oBAAI,QADU;AAEdE,2BAAW;AAFG,aAAlB;;AAKA,gBAAIC,SAAShB,KAAKiB,MAAL,CAAYD,MAAZ,CAAmB,gDAAnB,EAAqE,MAArE,EAA6E,EAAEJ,aAAaA,WAAf,EAA4BM,KAAK,UAAjC,EAA6CC,WAAW,UAAxD,EAA7E,CAAb;AACAT,mBAAOM,OAAOM,KAAd,EAAqBC,EAArB,CAAwBC,KAAxB,CAA8B,EAA9B;AACAd,mBAAOM,OAAOc,GAAd,EAAmBP,EAAnB,CAAsBC,KAAtB,CAA4B,2BAA5B;AACAb;AACH,SAXD;;AAaAH,WAAG,6BAAH,EAAkC,UAAUG,IAAV,EAAgB;;AAE9C,gBAAIC,cAAc;AACdC,oBAAI,QADU;AAEdC,qBAAK,eAFS;AAGdC,2BAAW;AAHG,aAAlB;;AAMA,gBAAIC,SAAShB,KAAKiB,MAAL,CAAYD,MAAZ,CAAmB,gDAAnB,EAAqE,MAArE,EAA6E,EAAEJ,aAAaA,WAAf,EAA4BS,SAAS,sBAArC,EAA6DH,KAAK,UAAlE,EAA8EC,WAAW,UAAzF,EAA7E,CAAb;AACAT,mBAAOM,OAAOM,KAAd,EAAqBC,EAArB,CAAwBC,KAAxB,CAA8B,EAA9B;AACAd,mBAAOM,OAAOc,GAAd,EAAmBP,EAAnB,CAAsBC,KAAtB,CAA4B,mBAA5B;AACAb;AACH,SAZD;AAaH,KAzKD;;AA2KAL,aAAS,gBAAT,EAA2B,YAAY;;AAEnCE,WAAG,iCAAH,EAAsC,UAAUG,IAAV,EAAgB;;AAElD,gBAAIoB,MAAM;AACNC,yBAAS;AACL,4CAAwB;AADnB;AADH,aAAV;;AAMAtB,mBAAOV,KAAKiB,MAAL,CAAYgB,YAAZ,CAAyBF,GAAzB,EAA8B,EAA9B,CAAP,EAA0CR,EAA1C,CAA6CC,KAA7C,CAAmD,KAAnD;AACAb;AACH,SAVD;;AAYAH,WAAG,8BAAH,EAAmC,UAAUG,IAAV,EAAgB;;AAE/C,gBAAIoB,MAAM;AACNC,yBAAS;AACL,oCAAgB,YADX;AAEL,4CAAwB;AAFnB;AADH,aAAV;;AAOA,gBAAIE,YAAY;AACZC,wBAAQ,MADI;AAEZC,sBAAM,aAFM;AAGZC,sBAAM,MAHM;AAIZC,0BAAU,sBAJE;AAKZC,oBAAI,YALQ;AAMZnB,uBAAO,QANK;AAOZO,sBAAM,8CAPM;AAQZT,qBAAK,eARO;AASZsB,qBAAKC,SATO;AAUZC,qBAAKD,SAVO;AAWZE,qBAAK,8CAXO;AAYZ9B,oBAAI;AAZQ,aAAhB;;AAeA,gBAAID,cAAc;AACdC,oBAAI,QADU;AAEdC,qBAAK,6CAFS;AAGdC,2BAAW,QAHG;AAId6B,sBAAM;AAJQ,aAAlB;;AAOAlC,mBAAOV,KAAKiB,MAAL,CAAYgB,YAAZ,CAAyBF,GAAzB,EAA8BnB,WAA9B,EAA2CsB,SAA3C,CAAP,EAA8DX,EAA9D,CAAiEC,KAAjE,CAAuE,KAAvE;AACAb;AACH,SAjCD;;AAmCAH,WAAG,+BAAH,EAAoC,UAAUG,IAAV,EAAgB;;AAEhD,gBAAIoB,MAAM;AACNC,yBAAS;AACL,oCAAgB,YADX;AAEL,4CAAwB;AAFnB;AADH,aAAV;;AAOA,gBAAIE,YAAY;AACZC,wBAAQ,MADI;AAEZC,sBAAM,aAFM;AAGZC,sBAAM,MAHM;AAIZC,0BAAU,sBAJE;AAKZC,oBAAI,YALQ;AAMZnB,uBAAO,QANK;AAOZO,sBAAM,8CAPM;AAQZT,qBAAK,eARO;AASZsB,qBAAKC,SATO;AAUZC,qBAAKD,SAVO;AAWZE,qBAAK,8CAXO;AAYZ9B,oBAAI;AAZQ,aAAhB;;AAeA,gBAAID,cAAc;AACdC,oBAAI,QADU;AAEdC,qBAAK,6CAFS;AAGdC,2BAAW,QAHG;AAId6B,sBAAM;AAJQ,aAAlB;;AAOAlC,mBAAOV,KAAKiB,MAAL,CAAYgB,YAAZ,CAAyBF,GAAzB,EAA8BnB,WAA9B,EAA2CsB,SAA3C,CAAP,EAA8DX,EAA9D,CAAiEC,KAAjE,CAAuE,IAAvE;AACAb;AACH,SAjCD;;AAmCAH,WAAG,iDAAH,EAAsD,UAAUG,IAAV,EAAgB;;AAElE,gBAAIK,SAAS,kGAAb;AACAN,mBAAOV,KAAKiB,MAAL,CAAYgB,YAAZ,CAAyB,EAAED,SAAS,EAAE,oBAAoBhB,MAAtB,EAAX,EAAzB,EAAsE,EAAtE,CAAP,EAAkFO,EAAlF,CAAqFC,KAArF,CAA2F,KAA3F;AACAb;AACH,SALD;;AAOAH,WAAG,iDAAH,EAAsD,UAAUG,IAAV,EAAgB;;AAElE,gBAAIC,cAAc;AACdC,oBAAI,QADU;AAEdC,qBAAK,6CAFS;AAGdC,2BAAW,QAHG;AAId6B,sBAAM;AAJQ,aAAlB;;AAOA,gBAAI5B,SAAS,qGAAb;AACAN,mBAAOV,KAAKiB,MAAL,CAAYgB,YAAZ,CAAyB,EAAED,SAAS,EAAE,oBAAoBhB,MAAtB,EAAX,EAAzB,EAAsEJ,WAAtE,CAAP,EAA2FW,EAA3F,CAA8FC,KAA9F,CAAoG,KAApG;AACAb;AACH,SAZD;;AAcAH,WAAG,sCAAH,EAA2C,UAAUG,IAAV,EAAgB;;AAEvD,gBAAIK,SAAS,8BAAb;AACAN,mBAAOV,KAAKiB,MAAL,CAAYgB,YAAZ,CAAyB,EAAED,SAAS,EAAE,oBAAoBhB,MAAtB,EAAX,EAAzB,EAAsE,EAAtE,CAAP,EAAkFO,EAAlF,CAAqFC,KAArF,CAA2F,IAA3F;AACAb;AACH,SALD;AAMH,KA/GD;;AAiHAL,aAAS,WAAT,EAAsB,YAAY;;AAE9BE,WAAG,yBAAH,EAA8B,UAAUG,IAAV,EAAgB;;AAE1C,gBAAIC,cAAc;AACdC,oBAAI,QADU;AAEdC,qBAAK,eAFS;AAGdC,2BAAW;AAHG,aAAlB;;AAMA,gBAAI8B,OAAO7C,KAAKiB,MAAL,CAAY6B,OAAZ,CAAoB,aAApB,EAAmC,EAAnC,EAAuC,mBAAvC,EAA4D,EAAElC,aAAaA,WAAf,EAA4BO,WAAW,UAAvC,EAAmDC,OAAO,QAA1D,EAA5D,CAAX;AACAV,mBAAOmC,IAAP,EAAatB,EAAb,CAAgBwB,KAAhB;AACArC,mBAAOmC,KAAKN,EAAZ,EAAgBhB,EAAhB,CAAmBC,KAAnB,CAAyB,UAAzB;AACAd,mBAAOmC,KAAKzB,KAAZ,EAAmBG,EAAnB,CAAsBC,KAAtB,CAA4B,QAA5B;AACAb;AACH,SAbD;;AAeAH,WAAG,wBAAH,EAA6B,UAAUG,IAAV,EAAgB;;AAEzC,gBAAIC,cAAc;AACdC,oBAAI,QADU;AAEdC,qBAAK,eAFS;AAGdC,2BAAW;AAHG,aAAlB;;AAMA,gBAAI8B,OAAO7C,KAAKiB,MAAL,CAAY6B,OAAZ,CAAoB,CAApB,EAAuB,EAAvB,EAA2B,mBAA3B,EAAgD,EAAElC,aAAaA,WAAf,EAA4BO,WAAW,UAAvC,EAAmDC,OAAO,QAA1D,EAAhD,CAAX;AACAV,mBAAOmC,IAAP,EAAatB,EAAb,CAAgByB,GAAhB,CAAoBD,KAApB;AACApC;AACH,SAXD;;AAaAH,WAAG,wBAAH,EAA6B,UAAUG,IAAV,EAAgB;;AAEzC,gBAAIC,cAAc;AACdC,oBAAI,QADU;AAEdC,qBAAK,eAFS;AAGdC,2BAAW;AAHG,aAAlB;;AAMA,gBAAI8B,OAAO7C,KAAKiB,MAAL,CAAY6B,OAAZ,CAAoB,aAApB,EAAmC,IAAnC,EAAyC,mBAAzC,EAA8D,EAAElC,aAAaA,WAAf,EAA4BO,WAAW,UAAvC,EAAmDC,OAAO,QAA1D,EAA9D,CAAX;AACAV,mBAAOmC,IAAP,EAAatB,EAAb,CAAgByB,GAAhB,CAAoBD,KAApB;AACApC;AACH,SAXD;;AAaAH,WAAG,wBAAH,EAA6B,UAAUG,IAAV,EAAgB;;AAEzC,gBAAIC,cAAc;AACdC,oBAAI,QADU;AAEdC,qBAAK,eAFS;AAGdC,2BAAW;AAHG,aAAlB;;AAMA,gBAAI8B,OAAO7C,KAAKiB,MAAL,CAAY6B,OAAZ,CAAoB,aAApB,EAAmC,CAAnC,EAAsC,mBAAtC,EAA2D,EAAElC,aAAaA,WAAf,EAA4BO,WAAW,UAAvC,EAAmDC,OAAO,QAA1D,EAA3D,CAAX;AACAV,mBAAOmC,IAAP,EAAatB,EAAb,CAAgByB,GAAhB,CAAoBD,KAApB;AACApC;AACH,SAXD;;AAaAH,WAAG,wBAAH,EAA6B,UAAUG,IAAV,EAAgB;;AAEzC,gBAAIC,cAAc;AACdC,oBAAI,QADU;AAEdC,qBAAK,eAFS;AAGdC,2BAAW;AAHG,aAAlB;;AAMA,gBAAI8B,OAAO7C,KAAKiB,MAAL,CAAY6B,OAAZ,CAAoB,aAApB,EAAmC,EAAnC,EAAuC,IAAvC,EAA6C,EAAElC,aAAaA,WAAf,EAA4BO,WAAW,UAAvC,EAAmDC,OAAO,QAA1D,EAA7C,CAAX;AACAV,mBAAOmC,IAAP,EAAatB,EAAb,CAAgByB,GAAhB,CAAoBD,KAApB;AACApC;AACH,SAXD;;AAaAH,WAAG,2BAAH,EAAgC,UAAUG,IAAV,EAAgB;;AAE5C,gBAAIC,cAAc;AACdC,oBAAI,QADU;AAEdC,qBAAK,eAFS;AAGdC,2BAAW;AAHG,aAAlB;;AAMA,gBAAI8B,OAAO7C,KAAKiB,MAAL,CAAY6B,OAAZ,CAAoB,aAApB,EAAmC,EAAnC,EAAuCL,SAAvC,EAAkD,EAAE7B,aAAaA,WAAf,EAA4BO,WAAW,UAAvC,EAAmDC,OAAO,QAA1D,EAAlD,CAAX;AACAV,mBAAOmC,IAAP,EAAatB,EAAb,CAAgByB,GAAhB,CAAoBD,KAApB;AACApC;AACH,SAXD;;AAaAH,WAAG,2BAAH,EAAgC,UAAUG,IAAV,EAAgB;;AAE5C,gBAAIC,cAAc;AACdC,oBAAI,QADU;AAEdC,qBAAK,eAFS;AAGdC,2BAAW;AAHG,aAAlB;;AAMA,gBAAI8B,OAAO7C,KAAKiB,MAAL,CAAY6B,OAAZ,CAAoB,aAApB,EAAmC,EAAnC,EAAuC,CAAvC,EAA0C,EAAElC,aAAaA,WAAf,EAA4BO,WAAW,UAAvC,EAAmDC,OAAO,QAA1D,EAA1C,CAAX;AACAV,mBAAOmC,IAAP,EAAatB,EAAb,CAAgByB,GAAhB,CAAoBD,KAApB;AACApC;AACH,SAXD;;AAaAH,WAAG,2BAAH,EAAgC,UAAUG,IAAV,EAAgB;;AAE5C,gBAAIC,cAAc;AACdC,oBAAI,QADU;AAEdC,qBAAK,eAFS;AAGdC,2BAAW;AAHG,aAAlB;;AAMA,gBAAI8B,OAAO7C,KAAKiB,MAAL,CAAY6B,OAAZ,CAAoB,aAApB,EAAmC,EAAnC,EAAuC,mBAAvC,CAAX;AACApC,mBAAOmC,IAAP,EAAatB,EAAb,CAAgByB,GAAhB,CAAoBD,KAApB;AACApC;AACH,SAXD;;AAaAH,WAAG,oCAAH,EAAyC,UAAUG,IAAV,EAAgB;;AAErD,gBAAIC,cAAc;AACdE,qBAAK,eADS;AAEdC,2BAAW;AAFG,aAAlB;;AAKA,gBAAI8B,OAAO7C,KAAKiB,MAAL,CAAY6B,OAAZ,CAAoB,aAApB,EAAmC,EAAnC,EAAuC,mBAAvC,EAA4D,EAAElC,aAAaA,WAAf,EAA4BO,WAAW,UAAvC,EAAmDC,OAAO,QAA1D,EAA5D,CAAX;AACAV,mBAAOmC,IAAP,EAAatB,EAAb,CAAgByB,GAAhB,CAAoBD,KAApB;AACApC;AACH,SAVD;;AAYAH,WAAG,qCAAH,EAA0C,UAAUG,IAAV,EAAgB;;AAEtD,gBAAIC,cAAc;AACdC,oBAAI,QADU;AAEdE,2BAAW;AAFG,aAAlB;;AAKA,gBAAI8B,OAAO7C,KAAKiB,MAAL,CAAY6B,OAAZ,CAAoB,aAApB,EAAmC,EAAnC,EAAuC,mBAAvC,EAA4D,EAAElC,aAAaA,WAAf,EAA4BO,WAAW,UAAvC,EAAmDC,OAAO,QAA1D,EAA5D,CAAX;AACAV,mBAAOmC,IAAP,EAAatB,EAAb,CAAgByB,GAAhB,CAAoBD,KAApB;AACApC;AACH,SAVD;AAWH,KAnID;AAoIH,CAlaD","file":"client.js","sourcesContent":["// Load modules\r\n\r\nvar Url = require('url');\r\nvar Code = require('code');\r\nvar Hawk = require('../lib');\r\nvar Lab = require('lab');\r\n\r\n\r\n// Declare internals\r\n\r\nvar internals = {};\r\n\r\n\r\n// Test shortcuts\r\n\r\nvar lab = exports.lab = Lab.script();\r\nvar describe = lab.experiment;\r\nvar it = lab.test;\r\nvar expect = Code.expect;\r\n\r\n\r\ndescribe('Client', function () {\r\n\r\n    describe('header()', function () {\r\n\r\n        it('returns a valid authorization header (sha1)', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                key: '2983d45yun89q',\r\n                algorithm: 'sha1'\r\n            };\r\n\r\n            var header = Hawk.client.header('http://example.net/somewhere/over/the/rainbow', 'POST', { credentials: credentials, ext: 'Bazinga!', timestamp: 1353809207, nonce: 'Ygvqdz', payload: 'something to write about' }).field;\r\n            expect(header).to.equal('Hawk id=\"123456\", ts=\"1353809207\", nonce=\"Ygvqdz\", hash=\"bsvY3IfUllw6V5rvk4tStEvpBhE=\", ext=\"Bazinga!\", mac=\"qbf1ZPG/r/e06F4ht+T77LXi5vw=\"');\r\n            done();\r\n        });\r\n\r\n        it('returns a valid authorization header (sha256)', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                key: '2983d45yun89q',\r\n                algorithm: 'sha256'\r\n            };\r\n\r\n            var header = Hawk.client.header('https://example.net/somewhere/over/the/rainbow', 'POST', { credentials: credentials, ext: 'Bazinga!', timestamp: 1353809207, nonce: 'Ygvqdz', payload: 'something to write about', contentType: 'text/plain' }).field;\r\n            expect(header).to.equal('Hawk id=\"123456\", ts=\"1353809207\", nonce=\"Ygvqdz\", hash=\"2QfCt3GuY9HQnHWyWD3wX68ZOKbynqlfYmuO2ZBRqtY=\", ext=\"Bazinga!\", mac=\"q1CwFoSHzPZSkbIvl0oYlD+91rBUEvFk763nMjMndj8=\"');\r\n            done();\r\n        });\r\n\r\n        it('returns a valid authorization header (no ext)', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                key: '2983d45yun89q',\r\n                algorithm: 'sha256'\r\n            };\r\n\r\n            var header = Hawk.client.header('https://example.net/somewhere/over/the/rainbow', 'POST', { credentials: credentials, timestamp: 1353809207, nonce: 'Ygvqdz', payload: 'something to write about', contentType: 'text/plain' }).field;\r\n            expect(header).to.equal('Hawk id=\"123456\", ts=\"1353809207\", nonce=\"Ygvqdz\", hash=\"2QfCt3GuY9HQnHWyWD3wX68ZOKbynqlfYmuO2ZBRqtY=\", mac=\"HTgtd0jPI6E4izx8e4OHdO36q00xFCU0FolNq3RiCYs=\"');\r\n            done();\r\n        });\r\n\r\n        it('returns a valid authorization header (null ext)', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                key: '2983d45yun89q',\r\n                algorithm: 'sha256'\r\n            };\r\n\r\n            var header = Hawk.client.header('https://example.net/somewhere/over/the/rainbow', 'POST', { credentials: credentials, timestamp: 1353809207, nonce: 'Ygvqdz', payload: 'something to write about', contentType: 'text/plain', ext: null }).field;\r\n            expect(header).to.equal('Hawk id=\"123456\", ts=\"1353809207\", nonce=\"Ygvqdz\", hash=\"2QfCt3GuY9HQnHWyWD3wX68ZOKbynqlfYmuO2ZBRqtY=\", mac=\"HTgtd0jPI6E4izx8e4OHdO36q00xFCU0FolNq3RiCYs=\"');\r\n            done();\r\n        });\r\n\r\n        it('returns a valid authorization header (empty payload)', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                key: '2983d45yun89q',\r\n                algorithm: 'sha256'\r\n            };\r\n\r\n            var header = Hawk.client.header('https://example.net/somewhere/over/the/rainbow', 'POST', { credentials: credentials, timestamp: 1353809207, nonce: 'Ygvqdz', payload: '', contentType: 'text/plain' }).field;\r\n            expect(header).to.equal('Hawk id=\\\"123456\\\", ts=\\\"1353809207\\\", nonce=\\\"Ygvqdz\\\", hash=\\\"q/t+NNAkQZNlq/aAD6PlexImwQTxwgT2MahfTa9XRLA=\\\", mac=\\\"U5k16YEzn3UnBHKeBzsDXn067Gu3R4YaY6xOt9PYRZM=\\\"');\r\n            done();\r\n        });\r\n\r\n        it('returns a valid authorization header (pre hashed payload)', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                key: '2983d45yun89q',\r\n                algorithm: 'sha256'\r\n            };\r\n\r\n            var options = { credentials: credentials, timestamp: 1353809207, nonce: 'Ygvqdz', payload: 'something to write about', contentType: 'text/plain' };\r\n            options.hash = Hawk.crypto.calculatePayloadHash(options.payload, credentials.algorithm, options.contentType);\r\n            var header = Hawk.client.header('https://example.net/somewhere/over/the/rainbow', 'POST', options).field;\r\n            expect(header).to.equal('Hawk id=\"123456\", ts=\"1353809207\", nonce=\"Ygvqdz\", hash=\"2QfCt3GuY9HQnHWyWD3wX68ZOKbynqlfYmuO2ZBRqtY=\", mac=\"HTgtd0jPI6E4izx8e4OHdO36q00xFCU0FolNq3RiCYs=\"');\r\n            done();\r\n        });\r\n\r\n        it('errors on missing uri', function (done) {\r\n\r\n            var header = Hawk.client.header('', 'POST');\r\n            expect(header.field).to.equal('');\r\n            expect(header.err).to.equal('Invalid argument type');\r\n            done();\r\n        });\r\n\r\n        it('errors on invalid uri', function (done) {\r\n\r\n            var header = Hawk.client.header(4, 'POST');\r\n            expect(header.field).to.equal('');\r\n            expect(header.err).to.equal('Invalid argument type');\r\n            done();\r\n        });\r\n\r\n        it('errors on missing method', function (done) {\r\n\r\n            var header = Hawk.client.header('https://example.net/somewhere/over/the/rainbow', '');\r\n            expect(header.field).to.equal('');\r\n            expect(header.err).to.equal('Invalid argument type');\r\n            done();\r\n        });\r\n\r\n        it('errors on invalid method', function (done) {\r\n\r\n            var header = Hawk.client.header('https://example.net/somewhere/over/the/rainbow', 5);\r\n            expect(header.field).to.equal('');\r\n            expect(header.err).to.equal('Invalid argument type');\r\n            done();\r\n        });\r\n\r\n        it('errors on missing options', function (done) {\r\n\r\n            var header = Hawk.client.header('https://example.net/somewhere/over/the/rainbow', 'POST');\r\n            expect(header.field).to.equal('');\r\n            expect(header.err).to.equal('Invalid argument type');\r\n            done();\r\n        });\r\n\r\n        it('errors on invalid credentials (id)', function (done) {\r\n\r\n            var credentials = {\r\n                key: '2983d45yun89q',\r\n                algorithm: 'sha256'\r\n            };\r\n\r\n            var header = Hawk.client.header('https://example.net/somewhere/over/the/rainbow', 'POST', { credentials: credentials, ext: 'Bazinga!', timestamp: 1353809207 });\r\n            expect(header.field).to.equal('');\r\n            expect(header.err).to.equal('Invalid credential object');\r\n            done();\r\n        });\r\n\r\n        it('errors on missing credentials', function (done) {\r\n\r\n            var header = Hawk.client.header('https://example.net/somewhere/over/the/rainbow', 'POST', { ext: 'Bazinga!', timestamp: 1353809207 });\r\n            expect(header.field).to.equal('');\r\n            expect(header.err).to.equal('Invalid credential object');\r\n            done();\r\n        });\r\n\r\n        it('errors on invalid credentials', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                algorithm: 'sha256'\r\n            };\r\n\r\n            var header = Hawk.client.header('https://example.net/somewhere/over/the/rainbow', 'POST', { credentials: credentials, ext: 'Bazinga!', timestamp: 1353809207 });\r\n            expect(header.field).to.equal('');\r\n            expect(header.err).to.equal('Invalid credential object');\r\n            done();\r\n        });\r\n\r\n        it('errors on invalid algorithm', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                key: '2983d45yun89q',\r\n                algorithm: 'hmac-sha-0'\r\n            };\r\n\r\n            var header = Hawk.client.header('https://example.net/somewhere/over/the/rainbow', 'POST', { credentials: credentials, payload: 'something, anything!', ext: 'Bazinga!', timestamp: 1353809207 });\r\n            expect(header.field).to.equal('');\r\n            expect(header.err).to.equal('Unknown algorithm');\r\n            done();\r\n        });\r\n    });\r\n\r\n    describe('authenticate()', function () {\r\n\r\n        it('returns false on invalid header', function (done) {\r\n\r\n            var res = {\r\n                headers: {\r\n                    'server-authorization': 'Hawk mac=\"abc\", bad=\"xyz\"'\r\n                }\r\n            };\r\n\r\n            expect(Hawk.client.authenticate(res, {})).to.equal(false);\r\n            done();\r\n        });\r\n\r\n        it('returns false on invalid mac', function (done) {\r\n\r\n            var res = {\r\n                headers: {\r\n                    'content-type': 'text/plain',\r\n                    'server-authorization': 'Hawk mac=\"_IJRsMl/4oL+nn+vKoeVZPdCHXB4yJkNnBbTbHFZUYE=\", hash=\"f9cDF/TDm7TkYRLnGwRMfeDzT6LixQVLvrIKhh0vgmM=\", ext=\"response-specific\"'\r\n                }\r\n            };\r\n\r\n            var artifacts = {\r\n                method: 'POST',\r\n                host: 'example.com',\r\n                port: '8080',\r\n                resource: '/resource/4?filter=a',\r\n                ts: '1362336900',\r\n                nonce: 'eb5S_L',\r\n                hash: 'nJjkVtBE5Y/Bk38Aiokwn0jiJxt/0S2WRSUwWLCf5xk=',\r\n                ext: 'some-app-data',\r\n                app: undefined,\r\n                dlg: undefined,\r\n                mac: 'BlmSe8K+pbKIb6YsZCnt4E1GrYvY1AaYayNR82dGpIk=',\r\n                id: '123456'\r\n            };\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                key: 'werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn',\r\n                algorithm: 'sha256',\r\n                user: 'steve'\r\n            };\r\n\r\n            expect(Hawk.client.authenticate(res, credentials, artifacts)).to.equal(false);\r\n            done();\r\n        });\r\n\r\n        it('returns true on ignoring hash', function (done) {\r\n\r\n            var res = {\r\n                headers: {\r\n                    'content-type': 'text/plain',\r\n                    'server-authorization': 'Hawk mac=\"XIJRsMl/4oL+nn+vKoeVZPdCHXB4yJkNnBbTbHFZUYE=\", hash=\"f9cDF/TDm7TkYRLnGwRMfeDzT6LixQVLvrIKhh0vgmM=\", ext=\"response-specific\"'\r\n                }\r\n            };\r\n\r\n            var artifacts = {\r\n                method: 'POST',\r\n                host: 'example.com',\r\n                port: '8080',\r\n                resource: '/resource/4?filter=a',\r\n                ts: '1362336900',\r\n                nonce: 'eb5S_L',\r\n                hash: 'nJjkVtBE5Y/Bk38Aiokwn0jiJxt/0S2WRSUwWLCf5xk=',\r\n                ext: 'some-app-data',\r\n                app: undefined,\r\n                dlg: undefined,\r\n                mac: 'BlmSe8K+pbKIb6YsZCnt4E1GrYvY1AaYayNR82dGpIk=',\r\n                id: '123456'\r\n            };\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                key: 'werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn',\r\n                algorithm: 'sha256',\r\n                user: 'steve'\r\n            };\r\n\r\n            expect(Hawk.client.authenticate(res, credentials, artifacts)).to.equal(true);\r\n            done();\r\n        });\r\n\r\n        it('fails on invalid WWW-Authenticate header format', function (done) {\r\n\r\n            var header = 'Hawk ts=\"1362346425875\", tsm=\"PhwayS28vtnn3qbv0mqRBYSXebN/zggEtucfeZ620Zo=\", x=\"Stale timestamp\"';\r\n            expect(Hawk.client.authenticate({ headers: { 'www-authenticate': header } }, {})).to.equal(false);\r\n            done();\r\n        });\r\n\r\n        it('fails on invalid WWW-Authenticate header format', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                key: 'werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn',\r\n                algorithm: 'sha256',\r\n                user: 'steve'\r\n            };\r\n\r\n            var header = 'Hawk ts=\"1362346425875\", tsm=\"hwayS28vtnn3qbv0mqRBYSXebN/zggEtucfeZ620Zo=\", error=\"Stale timestamp\"';\r\n            expect(Hawk.client.authenticate({ headers: { 'www-authenticate': header } }, credentials)).to.equal(false);\r\n            done();\r\n        });\r\n\r\n        it('skips tsm validation when missing ts', function (done) {\r\n\r\n            var header = 'Hawk error=\"Stale timestamp\"';\r\n            expect(Hawk.client.authenticate({ headers: { 'www-authenticate': header } }, {})).to.equal(true);\r\n            done();\r\n        });\r\n    });\r\n\r\n    describe('message()', function () {\r\n\r\n        it('generates authorization', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                key: '2983d45yun89q',\r\n                algorithm: 'sha1'\r\n            };\r\n\r\n            var auth = Hawk.client.message('example.com', 80, 'I am the boodyman', { credentials: credentials, timestamp: 1353809207, nonce: 'abc123' });\r\n            expect(auth).to.exist();\r\n            expect(auth.ts).to.equal(1353809207);\r\n            expect(auth.nonce).to.equal('abc123');\r\n            done();\r\n        });\r\n\r\n        it('errors on invalid host', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                key: '2983d45yun89q',\r\n                algorithm: 'sha1'\r\n            };\r\n\r\n            var auth = Hawk.client.message(5, 80, 'I am the boodyman', { credentials: credentials, timestamp: 1353809207, nonce: 'abc123' });\r\n            expect(auth).to.not.exist();\r\n            done();\r\n        });\r\n\r\n        it('errors on invalid port', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                key: '2983d45yun89q',\r\n                algorithm: 'sha1'\r\n            };\r\n\r\n            var auth = Hawk.client.message('example.com', '80', 'I am the boodyman', { credentials: credentials, timestamp: 1353809207, nonce: 'abc123' });\r\n            expect(auth).to.not.exist();\r\n            done();\r\n        });\r\n\r\n        it('errors on missing host', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                key: '2983d45yun89q',\r\n                algorithm: 'sha1'\r\n            };\r\n\r\n            var auth = Hawk.client.message('example.com', 0, 'I am the boodyman', { credentials: credentials, timestamp: 1353809207, nonce: 'abc123' });\r\n            expect(auth).to.not.exist();\r\n            done();\r\n        });\r\n\r\n        it('errors on null message', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                key: '2983d45yun89q',\r\n                algorithm: 'sha1'\r\n            };\r\n\r\n            var auth = Hawk.client.message('example.com', 80, null, { credentials: credentials, timestamp: 1353809207, nonce: 'abc123' });\r\n            expect(auth).to.not.exist();\r\n            done();\r\n        });\r\n\r\n        it('errors on missing message', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                key: '2983d45yun89q',\r\n                algorithm: 'sha1'\r\n            };\r\n\r\n            var auth = Hawk.client.message('example.com', 80, undefined, { credentials: credentials, timestamp: 1353809207, nonce: 'abc123' });\r\n            expect(auth).to.not.exist();\r\n            done();\r\n        });\r\n\r\n        it('errors on invalid message', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                key: '2983d45yun89q',\r\n                algorithm: 'sha1'\r\n            };\r\n\r\n            var auth = Hawk.client.message('example.com', 80, 5, { credentials: credentials, timestamp: 1353809207, nonce: 'abc123' });\r\n            expect(auth).to.not.exist();\r\n            done();\r\n        });\r\n\r\n        it('errors on missing options', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                key: '2983d45yun89q',\r\n                algorithm: 'sha1'\r\n            };\r\n\r\n            var auth = Hawk.client.message('example.com', 80, 'I am the boodyman');\r\n            expect(auth).to.not.exist();\r\n            done();\r\n        });\r\n\r\n        it('errors on invalid credentials (id)', function (done) {\r\n\r\n            var credentials = {\r\n                key: '2983d45yun89q',\r\n                algorithm: 'sha1'\r\n            };\r\n\r\n            var auth = Hawk.client.message('example.com', 80, 'I am the boodyman', { credentials: credentials, timestamp: 1353809207, nonce: 'abc123' });\r\n            expect(auth).to.not.exist();\r\n            done();\r\n        });\r\n\r\n        it('errors on invalid credentials (key)', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                algorithm: 'sha1'\r\n            };\r\n\r\n            var auth = Hawk.client.message('example.com', 80, 'I am the boodyman', { credentials: credentials, timestamp: 1353809207, nonce: 'abc123' });\r\n            expect(auth).to.not.exist();\r\n            done();\r\n        });\r\n    });\r\n});\r\n"]}