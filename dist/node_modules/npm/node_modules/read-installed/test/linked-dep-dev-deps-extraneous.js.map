{"version":3,"sources":["../../../../../../node_modules/npm/node_modules/read-installed/test/linked-dep-dev-deps-extraneous.js"],"names":["test","require","path","fs","mkdirp","rimraf","readInstalled","root","resolve","__dirname","pkg","pkgnm","linkdepSrc","linkdepLink","devdep","pjson","dir","data","sync","d","writeFileSync","JSON","stringify","t","name","version","dependencies","linkdep","devDependencies","symlinkSync","end","dev","er","dd","notOk","extraneous"],"mappings":";;AAAA,IAAIA,OAAOC,QAAQ,KAAR,EAAeD,IAA1B;AACA,IAAIE,OAAOD,QAAQ,MAAR,CAAX;AACA,IAAIE,KAAKF,QAAQ,IAAR,CAAT;AACA,IAAIG,SAASH,QAAQ,QAAR,CAAb;AACA,IAAII,SAASJ,QAAQ,QAAR,CAAb;AACA,IAAIK,gBAAgBL,QAAQ,KAAR,CAApB;;AAEA,IAAIM,OAAOL,KAAKM,OAAL,CAAaC,SAAb,EAAwB,MAAxB,CAAX;AACA,IAAIC,MAAMR,KAAKM,OAAL,CAAaD,IAAb,EAAmB,KAAnB,CAAV;AACA,IAAII,QAAQT,KAAKM,OAAL,CAAaE,GAAb,EAAkB,cAAlB,CAAZ;AACA,IAAIE,aAAaV,KAAKM,OAAL,CAAaD,IAAb,EAAmB,SAAnB,CAAjB;AACA,IAAIM,cAAcX,KAAKM,OAAL,CAAaG,KAAb,EAAoB,SAApB,CAAlB;AACA,IAAIG,SAASZ,KAAKM,OAAL,CAAaI,UAAb,EAAyB,cAAzB,EAAyC,QAAzC,CAAb;;AAEA,SAASG,KAAT,CAAgBC,GAAhB,EAAqBC,IAArB,EAA2B;AACzBb,SAAOc,IAAP,CAAYF,GAAZ;AACA,MAAIG,IAAIjB,KAAKM,OAAL,CAAaQ,GAAb,EAAkB,cAAlB,CAAR;AACAb,KAAGiB,aAAH,CAAiBD,CAAjB,EAAoBE,KAAKC,SAAL,CAAeL,IAAf,CAApB;AACD;;AAEDjB,KAAK,OAAL,EAAc,UAAUuB,CAAV,EAAa;AACzBlB,SAAOa,IAAP,CAAYX,IAAZ;AACAQ,QAAML,GAAN,EAAW;AACTc,UAAM,MADG;AAETC,aAAS,OAFA;AAGTC,kBAAc;AACZC,eAAS;AADG;AAHL,GAAX;AAOAZ,QAAMH,UAAN,EAAkB;AAChBY,UAAM,SADU;AAEhBC,aAAS,OAFO;AAGhBG,qBAAiB;AACfd,cAAQ;AADO;AAHD,GAAlB;AAOAC,QAAMD,MAAN,EAAc;AACZU,UAAM,QADM;AAEZC,aAAS;AAFG,GAAd;;AAKArB,SAAOc,IAAP,CAAYP,KAAZ;AACAR,KAAG0B,WAAH,CAAejB,UAAf,EAA2BC,WAA3B,EAAwC,KAAxC;;AAEAU,IAAEO,GAAF;AACD,CAzBD;;AA2BA9B,KAAK,OAAL,EAAc,UAAUuB,CAAV,EAAa;AACzBjB,gBAAcI,GAAd,EAAmB,EAAEqB,KAAK,IAAP,EAAnB,EAAkC,UAAUC,EAAV,EAAcf,IAAd,EAAoB;AACpD,QAAIgB,KAAKhB,KAAKS,YAAL,CAAkBC,OAAlB,CAA0BD,YAA1B,CAAuCZ,MAAhD;AACAS,MAAEW,KAAF,CAAQD,GAAGE,UAAX,EAAuB,yCAAvB;AACAZ,MAAEO,GAAF;AACD,GAJD;AAKD,CAND;;AAQA9B,KAAK,SAAL,EAAgB,UAAUuB,CAAV,EAAa;AAC3BlB,SAAOa,IAAP,CAAYX,IAAZ;AACAgB,IAAEO,GAAF;AACD,CAHD","file":"linked-dep-dev-deps-extraneous.js","sourcesContent":["var test = require('tap').test\nvar path = require('path')\nvar fs = require('fs')\nvar mkdirp = require('mkdirp')\nvar rimraf = require('rimraf')\nvar readInstalled = require('../')\n\nvar root = path.resolve(__dirname, 'root')\nvar pkg = path.resolve(root, 'pkg')\nvar pkgnm = path.resolve(pkg, 'node_modules')\nvar linkdepSrc = path.resolve(root, 'linkdep')\nvar linkdepLink = path.resolve(pkgnm, 'linkdep')\nvar devdep = path.resolve(linkdepSrc, 'node_modules', 'devdep')\n\nfunction pjson (dir, data) {\n  mkdirp.sync(dir)\n  var d = path.resolve(dir, 'package.json')\n  fs.writeFileSync(d, JSON.stringify(data))\n}\n\ntest('setup', function (t) {\n  rimraf.sync(root)\n  pjson(pkg, {\n    name: 'root',\n    version: '1.2.3',\n    dependencies: {\n      linkdep: ''\n    }\n  })\n  pjson(linkdepSrc, {\n    name: 'linkdep',\n    version: '1.2.3',\n    devDependencies: {\n      devdep: ''\n    }\n  })\n  pjson(devdep, {\n    name: 'devdep',\n    version: '1.2.3'\n  })\n\n  mkdirp.sync(pkgnm)\n  fs.symlinkSync(linkdepSrc, linkdepLink, 'dir')\n\n  t.end()\n})\n\ntest('basic', function (t) {\n  readInstalled(pkg, { dev: true }, function (er, data) {\n    var dd = data.dependencies.linkdep.dependencies.devdep\n    t.notOk(dd.extraneous, 'linked dev dep should not be extraneous')\n    t.end()\n  })\n})\n\ntest('cleanup', function (t) {\n  rimraf.sync(root)\n  t.end()\n})\n"]}