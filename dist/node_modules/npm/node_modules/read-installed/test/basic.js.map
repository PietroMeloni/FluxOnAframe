{"version":3,"sources":["../../../../../../node_modules/npm/node_modules/read-installed/test/basic.js"],"names":["readInstalled","require","json","d","Object","keys","dependencies","dd","devDependencies","od","optionalDependencies","known","concat","sort","test","path","t","join","__dirname","dev","log","console","error","er","map","notOk","ok","stack","message","cleanup","deps","equal","length","deepEqual","tap","extraneous","end","seen","indexOf","push","i","dep"],"mappings":";;;;AAAA,IAAIA,gBAAgBC,QAAQ,sBAAR,CAApB;AACA,IAAIC,OAAOD,QAAQ,iBAAR,CAAX;AACA,IAAIE,IAAIC,OAAOC,IAAP,CAAYH,KAAKI,YAAjB,CAAR;AACA,IAAIC,KAAKH,OAAOC,IAAP,CAAYH,KAAKM,eAAjB,CAAT;AACA,IAAIC,KAAKL,OAAOC,IAAP,CAAYH,KAAKQ,oBAAjB,CAAT;AACA,IAAIC,QAAQR,EAAES,MAAF,CAASL,EAAT,EAAaK,MAAb,CAAoBH,EAApB,EAAwBI,IAAxB,EAAZ;AACA,IAAIC,OAAOb,QAAQ,KAAR,EAAea,IAA1B;AACA,IAAIC,OAAOd,QAAQ,MAAR,CAAX;;AAEAa,KAAK,yBAAL,EAAgC,UAAUE,CAAV,EAAa;AAC3ChB,gBAAce,KAAKE,IAAL,CAAUC,SAAV,EAAqB,KAArB,CAAd,EAA2C;AACzCC,SAAK,IADoC;AAEzCC,SAAKC,QAAQC;AAF4B,GAA3C,EAGG,UAAUC,EAAV,EAAcC,GAAd,EAAmB;AACpBR,MAAES,KAAF,CAAQF,EAAR,EAAY,mBAAZ;AACAP,MAAEU,EAAF,CAAKF,GAAL,EAAU,oBAAV;AACA,QAAID,EAAJ,EAAQ,OAAOF,QAAQC,KAAR,CAAcC,GAAGI,KAAH,IAAYJ,GAAGK,OAA7B,CAAP;AACRC,YAAQL,GAAR;AACA,QAAIM,OAAO1B,OAAOC,IAAP,CAAYmB,IAAIlB,YAAhB,EAA8BO,IAA9B,EAAX;AACAG,MAAEe,KAAF,CAAQpB,MAAMqB,MAAd,EAAsBF,KAAKE,MAA3B,EAAmC,yBAAnC;AACAhB,MAAEiB,SAAF,CAAYtB,KAAZ,EAAmBmB,IAAnB,EAAyB,wBAAzB;AACAd,MAAES,KAAF,CAAQD,IAAIlB,YAAJ,CAAiB4B,GAAjB,CAAqBC,UAA7B,EAAyC,8BAAzC;AACAnB,MAAEoB,GAAF;AACD,GAbD;AAcD,CAfD;;AAiBA,IAAIC,OAAO,EAAX;AACA,SAASR,OAAT,CAAkBL,GAAlB,EAAuB;AACrB,MAAIa,KAAKC,OAAL,CAAad,GAAb,MAAsB,CAAC,CAA3B,EAA8B;AAC9Ba,OAAKE,IAAL,CAAUf,GAAV;AACA,OAAK,IAAIgB,CAAT,IAAchB,GAAd;AAAmB,YAAQgB,CAAR;AACjB,WAAK,KAAL;AACA,WAAK,MAAL;AACA,WAAK,YAAL,CAAmB,KAAK,SAAL;AACnB,WAAK,cAAL,CAAqB,KAAK,MAAL;AACnB;AACF;AAAS,eAAOhB,IAAIgB,CAAJ,CAAP;AANQ;AAAnB,GAQA,IAAIC,MAAMjB,IAAIlB,YAAd;AACA,MAAImC,GAAJ,EAAS;AACP,SAAK,IAAID,CAAT,IAAcC,GAAd;AAAmB,UAAI,QAAOA,IAAID,CAAJ,CAAP,MAAkB,QAAtB,EAAgC;AACjDX,gBAAQY,IAAID,CAAJ,CAAR;AACD;AAFD;AAGD;AACD,SAAOhB,GAAP;AACD","file":"basic.js","sourcesContent":["var readInstalled = require(\"../read-installed.js\")\nvar json = require(\"../package.json\")\nvar d = Object.keys(json.dependencies)\nvar dd = Object.keys(json.devDependencies)\nvar od = Object.keys(json.optionalDependencies)\nvar known = d.concat(dd).concat(od).sort()\nvar test = require(\"tap\").test\nvar path = require(\"path\")\n\ntest(\"make sure that it works\", function (t) {\n  readInstalled(path.join(__dirname, \"../\"), {\n    dev: true,\n    log: console.error\n  }, function (er, map) {\n    t.notOk(er, \"er should be bull\")\n    t.ok(map, \"map should be data\")\n    if (er) return console.error(er.stack || er.message)\n    cleanup(map)\n    var deps = Object.keys(map.dependencies).sort()\n    t.equal(known.length, deps.length, \"array lengths are equal\")\n    t.deepEqual(known, deps, \"arrays should be equal\")\n    t.notOk(map.dependencies.tap.extraneous, 'extraneous not set on devDep')\n    t.end()\n  })\n})\n\nvar seen = []\nfunction cleanup (map) {\n  if (seen.indexOf(map) !== -1) return\n  seen.push(map)\n  for (var i in map) switch (i) {\n    case \"_id\":\n    case \"path\":\n    case \"extraneous\": case \"invalid\":\n    case \"dependencies\": case \"name\":\n      continue\n    default: delete map[i]\n  }\n  var dep = map.dependencies\n  if (dep) {\n    for (var i in dep) if (typeof dep[i] === \"object\") {\n      cleanup(dep[i])\n    }\n  }\n  return map\n}\n"]}