{"version":3,"sources":["../../../../../../node_modules/npm/node_modules/read-installed/test/cyclic-extraneous-peer-deps.js"],"names":["test","require","mkdirp","rimraf","fs","path","readInstalled","parent","name","version","dependencies","devDependencies","readme","child1","peerDependencies","child2","root","resolve","__dirname","parentjson","child1root","child1json","child2root","child2json","t","sync","writeFileSync","JSON","stringify","pass","end","dev","er","data","notOk","extraneous","ok"],"mappings":"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","file":"cyclic-extraneous-peer-deps.js","sourcesContent":["var test = require(\"tap\").test\nvar mkdirp = require(\"mkdirp\")\nvar rimraf = require(\"rimraf\")\nvar fs = require(\"fs\")\nvar path = require(\"path\")\nvar readInstalled = require(\"../read-installed.js\")\n\nvar parent = {\n  name: \"parent\",\n  version: \"1.2.3\",\n  dependencies: {},\n  devDependencies: {\n    \"child1\":\"*\"\n  },\n  readme:\".\"\n}\n\nvar child1 = {\n  name: \"child1\",\n  version: \"1.2.3\",\n  peerDependencies: {\n    child2: \"*\"\n  },\n  readme:\".\"\n}\n\nvar child2 = {\n  name: \"child2\",\n  version: \"1.2.3\",\n  peerDependencies: {\n    child1: \"*\"\n  },\n  readme:\".\"\n}\n\n\nvar root = path.resolve(__dirname, \"cyclic-extraneous-peer-deps\")\nvar parentjson = path.resolve(root, \"package.json\")\nvar child1root = path.resolve(root, \"node_modules/child1\")\nvar child1json = path.resolve(child1root, \"package.json\")\nvar child2root = path.resolve(root, \"node_modules/child2\")\nvar child2json = path.resolve(child2root, \"package.json\")\n\ntest(\"setup\", function (t) {\n  rimraf.sync(root)\n  mkdirp.sync(child1root)\n  mkdirp.sync(child2root)\n  fs.writeFileSync(parentjson, JSON.stringify(parent, null, 2) + \"\\n\", \"utf8\")\n  fs.writeFileSync(child1json, JSON.stringify(child1, null, 2) + \"\\n\", \"utf8\")\n  fs.writeFileSync(child2json, JSON.stringify(child2, null, 2) + \"\\n\", \"utf8\")\n  t.pass(\"setup done\")\n  t.end()\n})\n\ntest(\"dev mode\", function (t) {\n  // peer dev deps should both be not extraneous.\n  readInstalled(root, { dev: true }, function (er, data) {\n    if (er)\n      throw er\n    t.notOk(data.dependencies.child1.extraneous, \"c1 not extra\")\n    t.notOk(data.dependencies.child2.extraneous, \"c2 not extra\")\n    t.end()\n  })\n})\n\ntest(\"prod mode\", function (t) {\n  readInstalled(root, { dev: false }, function (er, data) {\n    if (er)\n      throw er\n    t.ok(data.dependencies.child1.extraneous, \"c1 extra\")\n    t.ok(data.dependencies.child2.extraneous, \"c2 extra\")\n    t.end()\n  })\n})\n\n\ntest(\"cleanup\", function (t) {\n  rimraf.sync(root)\n  t.pass(\"cleanup done\")\n  t.end()\n})\n"]}