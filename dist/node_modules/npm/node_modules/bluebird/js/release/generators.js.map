{"version":3,"sources":["../../../../../../../node_modules/npm/node_modules/bluebird/js/release/generators.js"],"names":["module","exports","Promise","apiRejection","INTERNAL","tryConvertToPromise","Proxyable","debug","errors","require","TypeError","util","errorObj","tryCatch","yieldHandlers","promiseFromYieldHandler","value","traceParent","i","length","_pushContext","result","_popContext","ret","reject","e","maybePromise","PromiseSpawn","generatorFunction","receiver","yieldHandler","stack","cancellation","internal","_finallyPromise","_promise","lastly","_captureStackTrace","_setOnCancel","promise","_stack","_generatorFunction","_receiver","_generator","undefined","_yieldHandlers","concat","_yieldedPromise","_cancellationPhase","inherits","prototype","_isResolved","_cleanup","_fulfill","_promiseCancelled","implementsReturn","reason","CancellationError","coroutine","returnSentinel","_attachExtraTrace","call","_continue","_promiseFulfilled","next","_promiseRejected","_resultCancelled","cancel","_run","_rejectCallback","done","_resolveCallback","replace","String","split","slice","join","_target","bitField","_bitField","_proxy","_async","invoke","_value","_reason","options","Object","PromiseSpawn$","Error","generator","apply","arguments","spawn","addYieldHandler","fn","classString","push","deprecated"],"mappings":"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","file":"generators.js","sourcesContent":["\"use strict\";\nmodule.exports = function(Promise,\n                          apiRejection,\n                          INTERNAL,\n                          tryConvertToPromise,\n                          Proxyable,\n                          debug) {\nvar errors = require(\"./errors\");\nvar TypeError = errors.TypeError;\nvar util = require(\"./util\");\nvar errorObj = util.errorObj;\nvar tryCatch = util.tryCatch;\nvar yieldHandlers = [];\n\nfunction promiseFromYieldHandler(value, yieldHandlers, traceParent) {\n    for (var i = 0; i < yieldHandlers.length; ++i) {\n        traceParent._pushContext();\n        var result = tryCatch(yieldHandlers[i])(value);\n        traceParent._popContext();\n        if (result === errorObj) {\n            traceParent._pushContext();\n            var ret = Promise.reject(errorObj.e);\n            traceParent._popContext();\n            return ret;\n        }\n        var maybePromise = tryConvertToPromise(result, traceParent);\n        if (maybePromise instanceof Promise) return maybePromise;\n    }\n    return null;\n}\n\nfunction PromiseSpawn(generatorFunction, receiver, yieldHandler, stack) {\n    if (debug.cancellation()) {\n        var internal = new Promise(INTERNAL);\n        var _finallyPromise = this._finallyPromise = new Promise(INTERNAL);\n        this._promise = internal.lastly(function() {\n            return _finallyPromise;\n        });\n        internal._captureStackTrace();\n        internal._setOnCancel(this);\n    } else {\n        var promise = this._promise = new Promise(INTERNAL);\n        promise._captureStackTrace();\n    }\n    this._stack = stack;\n    this._generatorFunction = generatorFunction;\n    this._receiver = receiver;\n    this._generator = undefined;\n    this._yieldHandlers = typeof yieldHandler === \"function\"\n        ? [yieldHandler].concat(yieldHandlers)\n        : yieldHandlers;\n    this._yieldedPromise = null;\n    this._cancellationPhase = false;\n}\nutil.inherits(PromiseSpawn, Proxyable);\n\nPromiseSpawn.prototype._isResolved = function() {\n    return this._promise === null;\n};\n\nPromiseSpawn.prototype._cleanup = function() {\n    this._promise = this._generator = null;\n    if (debug.cancellation() && this._finallyPromise !== null) {\n        this._finallyPromise._fulfill();\n        this._finallyPromise = null;\n    }\n};\n\nPromiseSpawn.prototype._promiseCancelled = function() {\n    if (this._isResolved()) return;\n    var implementsReturn = typeof this._generator[\"return\"] !== \"undefined\";\n\n    var result;\n    if (!implementsReturn) {\n        var reason = new Promise.CancellationError(\n            \"generator .return() sentinel\");\n        Promise.coroutine.returnSentinel = reason;\n        this._promise._attachExtraTrace(reason);\n        this._promise._pushContext();\n        result = tryCatch(this._generator[\"throw\"]).call(this._generator,\n                                                         reason);\n        this._promise._popContext();\n    } else {\n        this._promise._pushContext();\n        result = tryCatch(this._generator[\"return\"]).call(this._generator,\n                                                          undefined);\n        this._promise._popContext();\n    }\n    this._cancellationPhase = true;\n    this._yieldedPromise = null;\n    this._continue(result);\n};\n\nPromiseSpawn.prototype._promiseFulfilled = function(value) {\n    this._yieldedPromise = null;\n    this._promise._pushContext();\n    var result = tryCatch(this._generator.next).call(this._generator, value);\n    this._promise._popContext();\n    this._continue(result);\n};\n\nPromiseSpawn.prototype._promiseRejected = function(reason) {\n    this._yieldedPromise = null;\n    this._promise._attachExtraTrace(reason);\n    this._promise._pushContext();\n    var result = tryCatch(this._generator[\"throw\"])\n        .call(this._generator, reason);\n    this._promise._popContext();\n    this._continue(result);\n};\n\nPromiseSpawn.prototype._resultCancelled = function() {\n    if (this._yieldedPromise instanceof Promise) {\n        var promise = this._yieldedPromise;\n        this._yieldedPromise = null;\n        promise.cancel();\n    }\n};\n\nPromiseSpawn.prototype.promise = function () {\n    return this._promise;\n};\n\nPromiseSpawn.prototype._run = function () {\n    this._generator = this._generatorFunction.call(this._receiver);\n    this._receiver =\n        this._generatorFunction = undefined;\n    this._promiseFulfilled(undefined);\n};\n\nPromiseSpawn.prototype._continue = function (result) {\n    var promise = this._promise;\n    if (result === errorObj) {\n        this._cleanup();\n        if (this._cancellationPhase) {\n            return promise.cancel();\n        } else {\n            return promise._rejectCallback(result.e, false);\n        }\n    }\n\n    var value = result.value;\n    if (result.done === true) {\n        this._cleanup();\n        if (this._cancellationPhase) {\n            return promise.cancel();\n        } else {\n            return promise._resolveCallback(value);\n        }\n    } else {\n        var maybePromise = tryConvertToPromise(value, this._promise);\n        if (!(maybePromise instanceof Promise)) {\n            maybePromise =\n                promiseFromYieldHandler(maybePromise,\n                                        this._yieldHandlers,\n                                        this._promise);\n            if (maybePromise === null) {\n                this._promiseRejected(\n                    new TypeError(\n                        \"A value %s was yielded that could not be treated as a promise\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\\u000a\".replace(\"%s\", String(value)) +\n                        \"From coroutine:\\u000a\" +\n                        this._stack.split(\"\\n\").slice(1, -7).join(\"\\n\")\n                    )\n                );\n                return;\n            }\n        }\n        maybePromise = maybePromise._target();\n        var bitField = maybePromise._bitField;\n        ;\n        if (((bitField & 50397184) === 0)) {\n            this._yieldedPromise = maybePromise;\n            maybePromise._proxy(this, null);\n        } else if (((bitField & 33554432) !== 0)) {\n            Promise._async.invoke(\n                this._promiseFulfilled, this, maybePromise._value()\n            );\n        } else if (((bitField & 16777216) !== 0)) {\n            Promise._async.invoke(\n                this._promiseRejected, this, maybePromise._reason()\n            );\n        } else {\n            this._promiseCancelled();\n        }\n    }\n};\n\nPromise.coroutine = function (generatorFunction, options) {\n    if (typeof generatorFunction !== \"function\") {\n        throw new TypeError(\"generatorFunction must be a function\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n    }\n    var yieldHandler = Object(options).yieldHandler;\n    var PromiseSpawn$ = PromiseSpawn;\n    var stack = new Error().stack;\n    return function () {\n        var generator = generatorFunction.apply(this, arguments);\n        var spawn = new PromiseSpawn$(undefined, undefined, yieldHandler,\n                                      stack);\n        var ret = spawn.promise();\n        spawn._generator = generator;\n        spawn._promiseFulfilled(undefined);\n        return ret;\n    };\n};\n\nPromise.coroutine.addYieldHandler = function(fn) {\n    if (typeof fn !== \"function\") {\n        throw new TypeError(\"expecting a function but got \" + util.classString(fn));\n    }\n    yieldHandlers.push(fn);\n};\n\nPromise.spawn = function (generatorFunction) {\n    debug.deprecated(\"Promise.spawn()\", \"Promise.coroutine()\");\n    if (typeof generatorFunction !== \"function\") {\n        return apiRejection(\"generatorFunction must be a function\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n    }\n    var spawn = new PromiseSpawn(generatorFunction, this);\n    var ret = spawn.promise();\n    spawn._run(Promise.spawn);\n    return ret;\n};\n};\n"]}