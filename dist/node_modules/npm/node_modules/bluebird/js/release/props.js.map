{"version":3,"sources":["../../../../../../../node_modules/npm/node_modules/bluebird/js/release/props.js"],"names":["module","exports","Promise","PromiseArray","tryConvertToPromise","apiRejection","util","require","isObject","es5","Es6Map","Map","mapToEntries","index","size","extractEntry","value","key","map","ret","Array","forEach","entriesToMap","entries","length","i","set","PropertiesPromiseArray","obj","isMap","undefined","keys","len","constructor$","_isMap","_init$","inherits","prototype","_init","_promiseFulfilled","_values","totalResolved","_totalResolved","_length","val","keyOffset","_resolve","shouldCopyValues","getActualLength","props","promises","castValue","_then","promise","_propagateFrom"],"mappings":"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","file":"props.js","sourcesContent":["\"use strict\";\nmodule.exports = function(\n    Promise, PromiseArray, tryConvertToPromise, apiRejection) {\nvar util = require(\"./util\");\nvar isObject = util.isObject;\nvar es5 = require(\"./es5\");\nvar Es6Map;\nif (typeof Map === \"function\") Es6Map = Map;\n\nvar mapToEntries = (function() {\n    var index = 0;\n    var size = 0;\n\n    function extractEntry(value, key) {\n        this[index] = value;\n        this[index + size] = key;\n        index++;\n    }\n\n    return function mapToEntries(map) {\n        size = map.size;\n        index = 0;\n        var ret = new Array(map.size * 2);\n        map.forEach(extractEntry, ret);\n        return ret;\n    };\n})();\n\nvar entriesToMap = function(entries) {\n    var ret = new Es6Map();\n    var length = entries.length / 2 | 0;\n    for (var i = 0; i < length; ++i) {\n        var key = entries[length + i];\n        var value = entries[i];\n        ret.set(key, value);\n    }\n    return ret;\n};\n\nfunction PropertiesPromiseArray(obj) {\n    var isMap = false;\n    var entries;\n    if (Es6Map !== undefined && obj instanceof Es6Map) {\n        entries = mapToEntries(obj);\n        isMap = true;\n    } else {\n        var keys = es5.keys(obj);\n        var len = keys.length;\n        entries = new Array(len * 2);\n        for (var i = 0; i < len; ++i) {\n            var key = keys[i];\n            entries[i] = obj[key];\n            entries[i + len] = key;\n        }\n    }\n    this.constructor$(entries);\n    this._isMap = isMap;\n    this._init$(undefined, isMap ? -6 : -3);\n}\nutil.inherits(PropertiesPromiseArray, PromiseArray);\n\nPropertiesPromiseArray.prototype._init = function () {};\n\nPropertiesPromiseArray.prototype._promiseFulfilled = function (value, index) {\n    this._values[index] = value;\n    var totalResolved = ++this._totalResolved;\n    if (totalResolved >= this._length) {\n        var val;\n        if (this._isMap) {\n            val = entriesToMap(this._values);\n        } else {\n            val = {};\n            var keyOffset = this.length();\n            for (var i = 0, len = this.length(); i < len; ++i) {\n                val[this._values[i + keyOffset]] = this._values[i];\n            }\n        }\n        this._resolve(val);\n        return true;\n    }\n    return false;\n};\n\nPropertiesPromiseArray.prototype.shouldCopyValues = function () {\n    return false;\n};\n\nPropertiesPromiseArray.prototype.getActualLength = function (len) {\n    return len >> 1;\n};\n\nfunction props(promises) {\n    var ret;\n    var castValue = tryConvertToPromise(promises);\n\n    if (!isObject(castValue)) {\n        return apiRejection(\"cannot await properties of a non-object\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n    } else if (castValue instanceof Promise) {\n        ret = castValue._then(\n            Promise.props, undefined, undefined, undefined, undefined);\n    } else {\n        ret = new PropertiesPromiseArray(castValue).promise();\n    }\n\n    if (castValue instanceof Promise) {\n        ret._propagateFrom(castValue, 2);\n    }\n    return ret;\n}\n\nPromise.prototype.props = function () {\n    return props(this);\n};\n\nPromise.props = function (promises) {\n    return props(promises);\n};\n};\n"]}