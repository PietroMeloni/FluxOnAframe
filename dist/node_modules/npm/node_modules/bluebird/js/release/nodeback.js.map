{"version":3,"sources":["../../../../../../../node_modules/npm/node_modules/bluebird/js/release/nodeback.js"],"names":["util","require","maybeWrapAsError","errors","OperationalError","es5","isUntypedError","obj","Error","getPrototypeOf","prototype","rErrorKey","wrapAsOperationalError","ret","name","message","stack","keys","i","length","key","test","markAsOriginatingFromRejection","nodebackForPromise","promise","multiArgs","err","value","wrapped","_attachExtraTrace","_reject","_fulfill","$_len","arguments","args","Array","Math","max","$_i","module","exports"],"mappings":"AAAA;;AACA,IAAIA,OAAOC,QAAQ,QAAR,CAAX;AACA,IAAIC,mBAAmBF,KAAKE,gBAA5B;AACA,IAAIC,SAASF,QAAQ,UAAR,CAAb;AACA,IAAIG,mBAAmBD,OAAOC,gBAA9B;AACA,IAAIC,MAAMJ,QAAQ,OAAR,CAAV;;AAEA,SAASK,cAAT,CAAwBC,GAAxB,EAA6B;AACzB,WAAOA,eAAeC,KAAf,IACHH,IAAII,cAAJ,CAAmBF,GAAnB,MAA4BC,MAAME,SADtC;AAEH;;AAED,IAAIC,YAAY,gCAAhB;AACA,SAASC,sBAAT,CAAgCL,GAAhC,EAAqC;AACjC,QAAIM,GAAJ;AACA,QAAIP,eAAeC,GAAf,CAAJ,EAAyB;AACrBM,cAAM,IAAIT,gBAAJ,CAAqBG,GAArB,CAAN;AACAM,YAAIC,IAAJ,GAAWP,IAAIO,IAAf;AACAD,YAAIE,OAAJ,GAAcR,IAAIQ,OAAlB;AACAF,YAAIG,KAAJ,GAAYT,IAAIS,KAAhB;AACA,YAAIC,OAAOZ,IAAIY,IAAJ,CAASV,GAAT,CAAX;AACA,aAAK,IAAIW,IAAI,CAAb,EAAgBA,IAAID,KAAKE,MAAzB,EAAiC,EAAED,CAAnC,EAAsC;AAClC,gBAAIE,MAAMH,KAAKC,CAAL,CAAV;AACA,gBAAI,CAACP,UAAUU,IAAV,CAAeD,GAAf,CAAL,EAA0B;AACtBP,oBAAIO,GAAJ,IAAWb,IAAIa,GAAJ,CAAX;AACH;AACJ;AACD,eAAOP,GAAP;AACH;AACDb,SAAKsB,8BAAL,CAAoCf,GAApC;AACA,WAAOA,GAAP;AACH;;AAED,SAASgB,kBAAT,CAA4BC,OAA5B,EAAqCC,SAArC,EAAgD;AAC5C,WAAO,UAASC,GAAT,EAAcC,KAAd,EAAqB;AACxB,YAAIH,YAAY,IAAhB,EAAsB;AACtB,YAAIE,GAAJ,EAAS;AACL,gBAAIE,UAAUhB,uBAAuBV,iBAAiBwB,GAAjB,CAAvB,CAAd;AACAF,oBAAQK,iBAAR,CAA0BD,OAA1B;AACAJ,oBAAQM,OAAR,CAAgBF,OAAhB;AACH,SAJD,MAIO,IAAI,CAACH,SAAL,EAAgB;AACnBD,oBAAQO,QAAR,CAAiBJ,KAAjB;AACH,SAFM,MAEA;AACH,gBAAIK,QAAQC,UAAUd,MAAtB,CAA6B,IAAIe,OAAO,IAAIC,KAAJ,CAAUC,KAAKC,GAAL,CAASL,QAAQ,CAAjB,EAAoB,CAApB,CAAV,CAAX,CAA8C,KAAI,IAAIM,MAAM,CAAd,EAAiBA,MAAMN,KAAvB,EAA8B,EAAEM,GAAhC,EAAqC;AAACJ,qBAAKI,MAAM,CAAX,IAAgBL,UAAUK,GAAV,CAAhB;AAAgC;AACjJd,oBAAQO,QAAR,CAAiBG,IAAjB;AACH;AACDV,kBAAU,IAAV;AACH,KAbD;AAcH;;AAEDe,OAAOC,OAAP,GAAiBjB,kBAAjB","file":"nodeback.js","sourcesContent":["\"use strict\";\nvar util = require(\"./util\");\nvar maybeWrapAsError = util.maybeWrapAsError;\nvar errors = require(\"./errors\");\nvar OperationalError = errors.OperationalError;\nvar es5 = require(\"./es5\");\n\nfunction isUntypedError(obj) {\n    return obj instanceof Error &&\n        es5.getPrototypeOf(obj) === Error.prototype;\n}\n\nvar rErrorKey = /^(?:name|message|stack|cause)$/;\nfunction wrapAsOperationalError(obj) {\n    var ret;\n    if (isUntypedError(obj)) {\n        ret = new OperationalError(obj);\n        ret.name = obj.name;\n        ret.message = obj.message;\n        ret.stack = obj.stack;\n        var keys = es5.keys(obj);\n        for (var i = 0; i < keys.length; ++i) {\n            var key = keys[i];\n            if (!rErrorKey.test(key)) {\n                ret[key] = obj[key];\n            }\n        }\n        return ret;\n    }\n    util.markAsOriginatingFromRejection(obj);\n    return obj;\n}\n\nfunction nodebackForPromise(promise, multiArgs) {\n    return function(err, value) {\n        if (promise === null) return;\n        if (err) {\n            var wrapped = wrapAsOperationalError(maybeWrapAsError(err));\n            promise._attachExtraTrace(wrapped);\n            promise._reject(wrapped);\n        } else if (!multiArgs) {\n            promise._fulfill(value);\n        } else {\n            var $_len = arguments.length;var args = new Array(Math.max($_len - 1, 0)); for(var $_i = 1; $_i < $_len; ++$_i) {args[$_i - 1] = arguments[$_i];};\n            promise._fulfill(args);\n        }\n        promise = null;\n    };\n}\n\nmodule.exports = nodebackForPromise;\n"]}