{"version":3,"sources":["../../../../../../node_modules/npm/node_modules/mute-stream/test/basic.js"],"names":["Stream","require","tap","MS","END","PAUSE","RESUME","PassThrough","call","readable","writable","prototype","Object","create","constructor","value","write","c","emit","end","pause","resume","test","t","ms","str","pipe","expect","on","equal","shift","mute","unmute","isTTY","columns","rows","undefined","length","replace"],"mappings":"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","file":"basic.js","sourcesContent":["var Stream = require('stream')\nvar tap = require('tap')\nvar MS = require('../mute.js')\n\n// some marker objects\nvar END = {}\nvar PAUSE = {}\nvar RESUME = {}\n\nfunction PassThrough () {\n  Stream.call(this)\n  this.readable = this.writable = true\n}\n\nPassThrough.prototype = Object.create(Stream.prototype, {\n  constructor: {\n    value: PassThrough\n  },\n  write: {\n    value: function (c) {\n      this.emit('data', c)\n      return true\n    }\n  },\n  end: {\n    value: function (c) {\n      if (c) this.write(c)\n      this.emit('end')\n    }\n  },\n  pause: {\n    value: function () {\n      this.emit('pause')\n    }\n  },\n  resume: {\n    value: function () {\n      this.emit('resume')\n    }\n  }\n})\n\ntap.test('incoming', function (t) {\n  var ms = new MS\n  var str = new PassThrough\n  str.pipe(ms)\n\n  var expect = ['foo', 'boo', END]\n  ms.on('data', function (c) {\n    t.equal(c, expect.shift())\n  })\n  ms.on('end', function () {\n    t.equal(END, expect.shift())\n    t.end()\n  })\n  str.write('foo')\n  ms.mute()\n  str.write('bar')\n  ms.unmute()\n  str.write('boo')\n  ms.mute()\n  str.write('blaz')\n  str.end('grelb')\n})\n\ntap.test('outgoing', function (t) {\n  var ms = new MS\n  var str = new PassThrough\n  ms.pipe(str)\n\n  var expect = ['foo', 'boo', END]\n  str.on('data', function (c) {\n    t.equal(c, expect.shift())\n  })\n  str.on('end', function () {\n    t.equal(END, expect.shift())\n    t.end()\n  })\n\n  ms.write('foo')\n  ms.mute()\n  ms.write('bar')\n  ms.unmute()\n  ms.write('boo')\n  ms.mute()\n  ms.write('blaz')\n  ms.end('grelb')\n})\n\ntap.test('isTTY', function (t) {\n  var str = new PassThrough\n  str.isTTY = true\n  str.columns=80\n  str.rows=24\n\n  var ms = new MS\n  t.equal(ms.isTTY, false)\n  t.equal(ms.columns, undefined)\n  t.equal(ms.rows, undefined)\n  ms.pipe(str)\n  t.equal(ms.isTTY, true)\n  t.equal(ms.columns, 80)\n  t.equal(ms.rows, 24)\n  str.isTTY = false\n  t.equal(ms.isTTY, false)\n  t.equal(ms.columns, 80)\n  t.equal(ms.rows, 24)\n  str.isTTY = true\n  t.equal(ms.isTTY, true)\n  t.equal(ms.columns, 80)\n  t.equal(ms.rows, 24)\n  ms.isTTY = false\n  t.equal(ms.isTTY, false)\n  t.equal(ms.columns, 80)\n  t.equal(ms.rows, 24)\n\n  ms = new MS\n  t.equal(ms.isTTY, false)\n  str.pipe(ms)\n  t.equal(ms.isTTY, true)\n  str.isTTY = false\n  t.equal(ms.isTTY, false)\n  str.isTTY = true\n  t.equal(ms.isTTY, true)\n  ms.isTTY = false\n  t.equal(ms.isTTY, false)\n\n  t.end()\n})\n\ntap.test('pause/resume incoming', function (t) {\n  var str = new PassThrough\n  var ms = new MS\n  str.on('pause', function () {\n    t.equal(PAUSE, expect.shift())\n  })\n  str.on('resume', function () {\n    t.equal(RESUME, expect.shift())\n  })\n  var expect = [PAUSE, RESUME, PAUSE, RESUME]\n  str.pipe(ms)\n  ms.pause()\n  ms.resume()\n  ms.pause()\n  ms.resume()\n  t.equal(expect.length, 0, 'saw all events')\n  t.end()\n})\n\ntap.test('replace with *', function (t) {\n  var str = new PassThrough\n  var ms = new MS({replace: '*'})\n  str.pipe(ms)\n  var expect = ['foo', '*****', 'bar', '***', 'baz', 'boo', '**', '****']\n\n  ms.on('data', function (c) {\n    t.equal(c, expect.shift())\n  })\n\n  str.write('foo')\n  ms.mute()\n  str.write('12345')\n  ms.unmute()\n  str.write('bar')\n  ms.mute()\n  str.write('baz')\n  ms.unmute()\n  str.write('baz')\n  str.write('boo')\n  ms.mute()\n  str.write('xy')\n  str.write('xyzÎ©')\n\n  t.equal(expect.length, 0)\n  t.end()\n})\n\ntap.test('replace with ~YARG~', function (t) {\n  var str = new PassThrough\n  var ms = new MS({replace: '~YARG~'})\n  str.pipe(ms)\n  var expect = ['foo', '~YARG~~YARG~~YARG~~YARG~~YARG~', 'bar',\n                '~YARG~~YARG~~YARG~', 'baz', 'boo', '~YARG~~YARG~',\n                '~YARG~~YARG~~YARG~~YARG~']\n\n  ms.on('data', function (c) {\n    t.equal(c, expect.shift())\n  })\n\n  // also throw some unicode in there, just for good measure.\n  str.write('foo')\n  ms.mute()\n  str.write('ï£¿Î©ï£¿Î©ï£¿')\n  ms.unmute()\n  str.write('bar')\n  ms.mute()\n  str.write('ï£¿Î©ï£¿')\n  ms.unmute()\n  str.write('baz')\n  str.write('boo')\n  ms.mute()\n  str.write('ï£¿Î©')\n  str.write('ï£¿Î©ï£¿Î©')\n\n  t.equal(expect.length, 0)\n  t.end()\n})\n"]}