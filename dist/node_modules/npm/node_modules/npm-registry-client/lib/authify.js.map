{"version":3,"sources":["../../../../../../node_modules/npm/node_modules/npm-registry-client/lib/authify.js"],"names":["module","exports","authify","authed","parsed","headers","credentials","otp","log","verbose","token","authorization","username","password","encodeURIComponent","auth","Error"],"mappings":";;AAAAA,OAAOC,OAAP,GAAiBC,OAAjB;;AAEA,SAASA,OAAT,CAAkBC,MAAlB,EAA0BC,MAA1B,EAAkCC,OAAlC,EAA2CC,WAA3C,EAAwD;AACtD,MAAIA,eAAeA,YAAYC,GAA/B,EAAoC;AAClC,SAAKC,GAAL,CAASC,OAAT,CAAiB,SAAjB,EAA4B,uBAA5B;AACAJ,YAAQ,SAAR,IAAqBC,YAAYC,GAAjC;AACD;AACD,MAAID,eAAeA,YAAYI,KAA/B,EAAsC;AACpC,SAAKF,GAAL,CAASC,OAAT,CAAiB,SAAjB,EAA4B,6BAA5B;AACAJ,YAAQM,aAAR,GAAwB,YAAYL,YAAYI,KAAhD;;AAEA,WAAO,IAAP;AACD;;AAED,MAAIP,MAAJ,EAAY;AACV,QAAIG,eAAeA,YAAYM,QAA3B,IAAuCN,YAAYO,QAAvD,EAAiE;AAC/D,UAAID,WAAWE,mBAAmBR,YAAYM,QAA/B,CAAf;AACA,UAAIC,WAAWC,mBAAmBR,YAAYO,QAA/B,CAAf;AACAT,aAAOW,IAAP,GAAcH,WAAW,GAAX,GAAiBC,QAA/B;AACD,KAJD,MAIO;AACL,aAAO,IAAIG,KAAJ,CACL,iFADK,CAAP;AAGD;AACF;AACF","file":"authify.js","sourcesContent":["module.exports = authify\n\nfunction authify (authed, parsed, headers, credentials) {\n  if (credentials && credentials.otp) {\n    this.log.verbose('request', 'passing along npm otp')\n    headers['npm-otp'] = credentials.otp\n  }\n  if (credentials && credentials.token) {\n    this.log.verbose('request', 'using bearer token for auth')\n    headers.authorization = 'Bearer ' + credentials.token\n\n    return null\n  }\n\n  if (authed) {\n    if (credentials && credentials.username && credentials.password) {\n      var username = encodeURIComponent(credentials.username)\n      var password = encodeURIComponent(credentials.password)\n      parsed.auth = username + ':' + password\n    } else {\n      return new Error(\n        'This request requires auth credentials. Run `npm login` and repeat the request.'\n      )\n    }\n  }\n}\n"]}