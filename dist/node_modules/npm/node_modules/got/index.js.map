{"version":3,"sources":["../../../../../node_modules/npm/node_modules/got/index.js"],"names":["EventEmitter","require","http","https","PassThrough","urlLib","querystring","duplexer3","isStream","getStream","timedOut","urlParseLax","lowercaseKeys","isRedirect","unzipResponse","createErrorClass","isRetryAllowed","Buffer","pkg","requestAsEventEmitter","opts","ee","requestUrl","href","resolve","format","path","redirectCount","retryCount","redirectUrl","get","fn","protocol","req","request","statusCode","res","followRedirect","headers","method","resume","emit","got","MaxRedirectsError","bufferString","from","location","toString","redirectOpts","Object","assign","parse","setImmediate","response","url","once","backoff","retries","err","setTimeout","RequestError","gotTimeout","asPromise","Promise","reject","on","body","pipe","undefined","end","stream","encoding","buffer","catch","ReadError","then","limitStatusCode","data","json","JSON","e","ParseError","HTTPError","defineProperty","value","asStream","input","output","proxy","Error","write","bind","normalizeArguments","replace","auth","name","version","query","stringify","split","accept","getBoundary","isBuffer","length","byteLength","toUpperCase","hostname","matches","exec","socketPath","host","iter","noise","Math","random","timeout","helpers","forEach","el","stdError","error","code","message","call","statusMessage","STATUS_CODES","slice","module","exports"],"mappings":"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","file":"index.js","sourcesContent":["'use strict';\nconst EventEmitter = require('events');\nconst http = require('http');\nconst https = require('https');\nconst PassThrough = require('stream').PassThrough;\nconst urlLib = require('url');\nconst querystring = require('querystring');\nconst duplexer3 = require('duplexer3');\nconst isStream = require('is-stream');\nconst getStream = require('get-stream');\nconst timedOut = require('timed-out');\nconst urlParseLax = require('url-parse-lax');\nconst lowercaseKeys = require('lowercase-keys');\nconst isRedirect = require('is-redirect');\nconst unzipResponse = require('unzip-response');\nconst createErrorClass = require('create-error-class');\nconst isRetryAllowed = require('is-retry-allowed');\nconst Buffer = require('safe-buffer').Buffer;\nconst pkg = require('./package');\n\nfunction requestAsEventEmitter(opts) {\n\topts = opts || {};\n\n\tconst ee = new EventEmitter();\n\tconst requestUrl = opts.href || urlLib.resolve(urlLib.format(opts), opts.path);\n\tlet redirectCount = 0;\n\tlet retryCount = 0;\n\tlet redirectUrl;\n\n\tconst get = opts => {\n\t\tconst fn = opts.protocol === 'https:' ? https : http;\n\n\t\tconst req = fn.request(opts, res => {\n\t\t\tconst statusCode = res.statusCode;\n\n\t\t\tif (isRedirect(statusCode) && opts.followRedirect && 'location' in res.headers && (opts.method === 'GET' || opts.method === 'HEAD')) {\n\t\t\t\tres.resume();\n\n\t\t\t\tif (++redirectCount > 10) {\n\t\t\t\t\tee.emit('error', new got.MaxRedirectsError(statusCode, opts), null, res);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst bufferString = Buffer.from(res.headers.location, 'binary').toString();\n\n\t\t\t\tredirectUrl = urlLib.resolve(urlLib.format(opts), bufferString);\n\t\t\t\tconst redirectOpts = Object.assign({}, opts, urlLib.parse(redirectUrl));\n\n\t\t\t\tee.emit('redirect', res, redirectOpts);\n\n\t\t\t\tget(redirectOpts);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tsetImmediate(() => {\n\t\t\t\tconst response = typeof unzipResponse === 'function' && req.method !== 'HEAD' ? unzipResponse(res) : res;\n\t\t\t\tresponse.url = redirectUrl || requestUrl;\n\t\t\t\tresponse.requestUrl = requestUrl;\n\n\t\t\t\tee.emit('response', response);\n\t\t\t});\n\t\t});\n\n\t\treq.once('error', err => {\n\t\t\tconst backoff = opts.retries(++retryCount, err);\n\n\t\t\tif (backoff) {\n\t\t\t\tsetTimeout(get, backoff, opts);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tee.emit('error', new got.RequestError(err, opts));\n\t\t});\n\n\t\tif (opts.gotTimeout) {\n\t\t\ttimedOut(req, opts.gotTimeout);\n\t\t}\n\n\t\tsetImmediate(() => {\n\t\t\tee.emit('request', req);\n\t\t});\n\t};\n\n\tget(opts);\n\treturn ee;\n}\n\nfunction asPromise(opts) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst ee = requestAsEventEmitter(opts);\n\n\t\tee.on('request', req => {\n\t\t\tif (isStream(opts.body)) {\n\t\t\t\topts.body.pipe(req);\n\t\t\t\topts.body = undefined;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\treq.end(opts.body);\n\t\t});\n\n\t\tee.on('response', res => {\n\t\t\tconst stream = opts.encoding === null ? getStream.buffer(res) : getStream(res, opts);\n\n\t\t\tstream\n\t\t\t\t.catch(err => reject(new got.ReadError(err, opts)))\n\t\t\t\t.then(data => {\n\t\t\t\t\tconst statusCode = res.statusCode;\n\t\t\t\t\tconst limitStatusCode = opts.followRedirect ? 299 : 399;\n\n\t\t\t\t\tres.body = data;\n\n\t\t\t\t\tif (opts.json && res.body) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tres.body = JSON.parse(res.body);\n\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\tthrow new got.ParseError(e, statusCode, opts, data);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (statusCode < 200 || statusCode > limitStatusCode) {\n\t\t\t\t\t\tthrow new got.HTTPError(statusCode, opts);\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve(res);\n\t\t\t\t})\n\t\t\t\t.catch(err => {\n\t\t\t\t\tObject.defineProperty(err, 'response', {value: res});\n\t\t\t\t\treject(err);\n\t\t\t\t});\n\t\t});\n\n\t\tee.on('error', reject);\n\t});\n}\n\nfunction asStream(opts) {\n\tconst input = new PassThrough();\n\tconst output = new PassThrough();\n\tconst proxy = duplexer3(input, output);\n\n\tif (opts.json) {\n\t\tthrow new Error('got can not be used as stream when options.json is used');\n\t}\n\n\tif (opts.body) {\n\t\tproxy.write = () => {\n\t\t\tthrow new Error('got\\'s stream is not writable when options.body is used');\n\t\t};\n\t}\n\n\tconst ee = requestAsEventEmitter(opts);\n\n\tee.on('request', req => {\n\t\tproxy.emit('request', req);\n\n\t\tif (isStream(opts.body)) {\n\t\t\topts.body.pipe(req);\n\t\t\treturn;\n\t\t}\n\n\t\tif (opts.body) {\n\t\t\treq.end(opts.body);\n\t\t\treturn;\n\t\t}\n\n\t\tif (opts.method === 'POST' || opts.method === 'PUT' || opts.method === 'PATCH') {\n\t\t\tinput.pipe(req);\n\t\t\treturn;\n\t\t}\n\n\t\treq.end();\n\t});\n\n\tee.on('response', res => {\n\t\tconst statusCode = res.statusCode;\n\n\t\tres.pipe(output);\n\n\t\tif (statusCode < 200 || statusCode > 299) {\n\t\t\tproxy.emit('error', new got.HTTPError(statusCode, opts), null, res);\n\t\t\treturn;\n\t\t}\n\n\t\tproxy.emit('response', res);\n\t});\n\n\tee.on('redirect', proxy.emit.bind(proxy, 'redirect'));\n\tee.on('error', proxy.emit.bind(proxy, 'error'));\n\n\treturn proxy;\n}\n\nfunction normalizeArguments(url, opts) {\n\tif (typeof url !== 'string' && typeof url !== 'object') {\n\t\tthrow new Error(`Parameter \\`url\\` must be a string or object, not ${typeof url}`);\n\t}\n\n\tif (typeof url === 'string') {\n\t\turl = url.replace(/^unix:/, 'http://$&');\n\t\turl = urlParseLax(url);\n\n\t\tif (url.auth) {\n\t\t\tthrow new Error('Basic authentication must be done with auth option');\n\t\t}\n\t}\n\n\topts = Object.assign(\n\t\t{\n\t\t\tprotocol: 'http:',\n\t\t\tpath: '',\n\t\t\tretries: 5\n\t\t},\n\t\turl,\n\t\topts\n\t);\n\n\topts.headers = Object.assign({\n\t\t'user-agent': `${pkg.name}/${pkg.version} (https://github.com/sindresorhus/got)`,\n\t\t'accept-encoding': 'gzip,deflate'\n\t}, lowercaseKeys(opts.headers));\n\n\tconst query = opts.query;\n\n\tif (query) {\n\t\tif (typeof query !== 'string') {\n\t\t\topts.query = querystring.stringify(query);\n\t\t}\n\n\t\topts.path = `${opts.path.split('?')[0]}?${opts.query}`;\n\t\tdelete opts.query;\n\t}\n\n\tif (opts.json && opts.headers.accept === undefined) {\n\t\topts.headers.accept = 'application/json';\n\t}\n\n\tlet body = opts.body;\n\n\tif (body) {\n\t\tif (typeof body !== 'string' && !(body !== null && typeof body === 'object')) {\n\t\t\tthrow new Error('options.body must be a ReadableStream, string, Buffer or plain Object');\n\t\t}\n\n\t\topts.method = opts.method || 'POST';\n\n\t\tif (isStream(body) && typeof body.getBoundary === 'function') {\n\t\t\t// Special case for https://github.com/form-data/form-data\n\t\t\topts.headers['content-type'] = opts.headers['content-type'] || `multipart/form-data; boundary=${body.getBoundary()}`;\n\t\t} else if (body !== null && typeof body === 'object' && !Buffer.isBuffer(body) && !isStream(body)) {\n\t\t\topts.headers['content-type'] = opts.headers['content-type'] || 'application/x-www-form-urlencoded';\n\t\t\tbody = opts.body = querystring.stringify(body);\n\t\t}\n\n\t\tif (opts.headers['content-length'] === undefined && opts.headers['transfer-encoding'] === undefined && !isStream(body)) {\n\t\t\tconst length = typeof body === 'string' ? Buffer.byteLength(body) : body.length;\n\t\t\topts.headers['content-length'] = length;\n\t\t}\n\t}\n\n\topts.method = (opts.method || 'GET').toUpperCase();\n\n\tif (opts.hostname === 'unix') {\n\t\tconst matches = /(.+):(.+)/.exec(opts.path);\n\n\t\tif (matches) {\n\t\t\topts.socketPath = matches[1];\n\t\t\topts.path = matches[2];\n\t\t\topts.host = null;\n\t\t}\n\t}\n\n\tif (typeof opts.retries !== 'function') {\n\t\tconst retries = opts.retries;\n\n\t\topts.retries = (iter, err) => {\n\t\t\tif (iter > retries || !isRetryAllowed(err)) {\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\tconst noise = Math.random() * 100;\n\n\t\t\treturn ((1 << iter) * 1000) + noise;\n\t\t};\n\t}\n\n\tif (opts.followRedirect === undefined) {\n\t\topts.followRedirect = true;\n\t}\n\n\tif (opts.timeout) {\n\t\topts.gotTimeout = opts.timeout;\n\t\tdelete opts.timeout;\n\t}\n\n\treturn opts;\n}\n\nfunction got(url, opts) {\n\ttry {\n\t\treturn asPromise(normalizeArguments(url, opts));\n\t} catch (err) {\n\t\treturn Promise.reject(err);\n\t}\n}\n\nconst helpers = [\n\t'get',\n\t'post',\n\t'put',\n\t'patch',\n\t'head',\n\t'delete'\n];\n\nhelpers.forEach(el => {\n\tgot[el] = (url, opts) => got(url, Object.assign({}, opts, {method: el}));\n});\n\ngot.stream = (url, opts) => asStream(normalizeArguments(url, opts));\n\nfor (const el of helpers) {\n\tgot.stream[el] = (url, opts) => got.stream(url, Object.assign({}, opts, {method: el}));\n}\n\nfunction stdError(error, opts) {\n\tif (error.code !== undefined) {\n\t\tthis.code = error.code;\n\t}\n\n\tObject.assign(this, {\n\t\tmessage: error.message,\n\t\thost: opts.host,\n\t\thostname: opts.hostname,\n\t\tmethod: opts.method,\n\t\tpath: opts.path\n\t});\n}\n\ngot.RequestError = createErrorClass('RequestError', stdError);\ngot.ReadError = createErrorClass('ReadError', stdError);\ngot.ParseError = createErrorClass('ParseError', function (e, statusCode, opts, data) {\n\tstdError.call(this, e, opts);\n\tthis.statusCode = statusCode;\n\tthis.statusMessage = http.STATUS_CODES[this.statusCode];\n\tthis.message = `${e.message} in \"${urlLib.format(opts)}\": \\n${data.slice(0, 77)}...`;\n});\n\ngot.HTTPError = createErrorClass('HTTPError', function (statusCode, opts) {\n\tstdError.call(this, {}, opts);\n\tthis.statusCode = statusCode;\n\tthis.statusMessage = http.STATUS_CODES[this.statusCode];\n\tthis.message = `Response code ${this.statusCode} (${this.statusMessage})`;\n});\n\ngot.MaxRedirectsError = createErrorClass('MaxRedirectsError', function (statusCode, opts) {\n\tstdError.call(this, {}, opts);\n\tthis.statusCode = statusCode;\n\tthis.statusMessage = http.STATUS_CODES[this.statusCode];\n\tthis.message = 'Redirected 10 times. Aborting.';\n});\n\nmodule.exports = got;\n"]}