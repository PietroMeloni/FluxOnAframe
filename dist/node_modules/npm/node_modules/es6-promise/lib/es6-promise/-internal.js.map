{"version":3,"sources":["../../../../../../../node_modules/npm/node_modules/es6-promise/lib/es6-promise/-internal.js"],"names":["PROMISE_ID","Math","random","toString","substring","noop","PENDING","FULFILLED","REJECTED","TRY_CATCH_ERROR","error","selfFulfillment","TypeError","cannotReturnOwn","getThen","promise","then","tryThen","value","fulfillmentHandler","rejectionHandler","call","e","handleForeignThenable","thenable","sealed","resolve","fulfill","reject","reason","_label","handleOwnThenable","_state","_result","subscribe","undefined","handleMaybeThenable","maybeThenable","constructor","originalThen","originalResolve","publishRejection","_onerror","publish","_subscribers","length","parent","child","onFulfillment","onRejection","subscribers","settled","callback","detail","i","invokeCallback","tryCatch","hasCallback","succeeded","failed","initializePromise","resolver","resolvePromise","rejectPromise","id","nextId","makePromise"],"mappings":"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","file":"-internal.js","sourcesContent":["import {\n  objectOrFunction,\n  isFunction\n} from './utils';\n\nimport {\n  asap\n} from './asap';\n\nimport originalThen from './then';\nimport originalResolve from './promise/resolve';\n\nexport const PROMISE_ID = Math.random().toString(36).substring(2);\n\nfunction noop() {}\n\nconst PENDING   = void 0;\nconst FULFILLED = 1;\nconst REJECTED  = 2;\n\nconst TRY_CATCH_ERROR = { error: null };\n\nfunction selfFulfillment() {\n  return new TypeError(\"You cannot resolve a promise with itself\");\n}\n\nfunction cannotReturnOwn() {\n  return new TypeError('A promises callback cannot return that same promise.');\n}\n\nfunction getThen(promise) {\n  try {\n    return promise.then;\n  } catch(error) {\n    TRY_CATCH_ERROR.error = error;\n    return TRY_CATCH_ERROR;\n  }\n}\n\nfunction tryThen(then, value, fulfillmentHandler, rejectionHandler) {\n  try {\n    then.call(value, fulfillmentHandler, rejectionHandler);\n  } catch(e) {\n    return e;\n  }\n}\n\nfunction handleForeignThenable(promise, thenable, then) {\n   asap(promise => {\n    var sealed = false;\n    var error = tryThen(then, thenable, value => {\n      if (sealed) { return; }\n      sealed = true;\n      if (thenable !== value) {\n        resolve(promise, value);\n      } else {\n        fulfill(promise, value);\n      }\n    }, reason => {\n      if (sealed) { return; }\n      sealed = true;\n\n      reject(promise, reason);\n    }, 'Settle: ' + (promise._label || ' unknown promise'));\n\n    if (!sealed && error) {\n      sealed = true;\n      reject(promise, error);\n    }\n  }, promise);\n}\n\nfunction handleOwnThenable(promise, thenable) {\n  if (thenable._state === FULFILLED) {\n    fulfill(promise, thenable._result);\n  } else if (thenable._state === REJECTED) {\n    reject(promise, thenable._result);\n  } else {\n    subscribe(thenable, undefined, value  => resolve(promise, value),\n                                   reason => reject(promise, reason))\n  }\n}\n\nfunction handleMaybeThenable(promise, maybeThenable, then) {\n  if (maybeThenable.constructor === promise.constructor &&\n      then === originalThen &&\n      maybeThenable.constructor.resolve === originalResolve) {\n    handleOwnThenable(promise, maybeThenable);\n  } else {\n    if (then === TRY_CATCH_ERROR) {\n      reject(promise, TRY_CATCH_ERROR.error);\n      TRY_CATCH_ERROR.error = null;\n    } else if (then === undefined) {\n      fulfill(promise, maybeThenable);\n    } else if (isFunction(then)) {\n      handleForeignThenable(promise, maybeThenable, then);\n    } else {\n      fulfill(promise, maybeThenable);\n    }\n  }\n}\n\nfunction resolve(promise, value) {\n  if (promise === value) {\n    reject(promise, selfFulfillment());\n  } else if (objectOrFunction(value)) {\n    handleMaybeThenable(promise, value, getThen(value));\n  } else {\n    fulfill(promise, value);\n  }\n}\n\nfunction publishRejection(promise) {\n  if (promise._onerror) {\n    promise._onerror(promise._result);\n  }\n\n  publish(promise);\n}\n\nfunction fulfill(promise, value) {\n  if (promise._state !== PENDING) { return; }\n\n  promise._result = value;\n  promise._state = FULFILLED;\n\n  if (promise._subscribers.length !== 0) {\n    asap(publish, promise);\n  }\n}\n\nfunction reject(promise, reason) {\n  if (promise._state !== PENDING) { return; }\n  promise._state = REJECTED;\n  promise._result = reason;\n\n  asap(publishRejection, promise);\n}\n\nfunction subscribe(parent, child, onFulfillment, onRejection) {\n  let { _subscribers } = parent;\n  let { length } = _subscribers;\n\n  parent._onerror = null;\n\n  _subscribers[length] = child;\n  _subscribers[length + FULFILLED] = onFulfillment;\n  _subscribers[length + REJECTED]  = onRejection;\n\n  if (length === 0 && parent._state) {\n    asap(publish, parent);\n  }\n}\n\nfunction publish(promise) {\n  let subscribers = promise._subscribers;\n  let settled = promise._state;\n\n  if (subscribers.length === 0) { return; }\n\n  let child, callback, detail = promise._result;\n\n  for (let i = 0; i < subscribers.length; i += 3) {\n    child = subscribers[i];\n    callback = subscribers[i + settled];\n\n    if (child) {\n      invokeCallback(settled, child, callback, detail);\n    } else {\n      callback(detail);\n    }\n  }\n\n  promise._subscribers.length = 0;\n}\n\n\nfunction tryCatch(callback, detail) {\n  try {\n    return callback(detail);\n  } catch(e) {\n    TRY_CATCH_ERROR.error = e;\n    return TRY_CATCH_ERROR;\n  }\n}\n\nfunction invokeCallback(settled, promise, callback, detail) {\n  let hasCallback = isFunction(callback),\n      value, error, succeeded, failed;\n\n  if (hasCallback) {\n    value = tryCatch(callback, detail);\n\n    if (value === TRY_CATCH_ERROR) {\n      failed = true;\n      error = value.error;\n      value.error = null;\n    } else {\n      succeeded = true;\n    }\n\n    if (promise === value) {\n      reject(promise, cannotReturnOwn());\n      return;\n    }\n\n  } else {\n    value = detail;\n    succeeded = true;\n  }\n\n  if (promise._state !== PENDING) {\n    // noop\n  } else if (hasCallback && succeeded) {\n    resolve(promise, value);\n  } else if (failed) {\n    reject(promise, error);\n  } else if (settled === FULFILLED) {\n    fulfill(promise, value);\n  } else if (settled === REJECTED) {\n    reject(promise, value);\n  }\n}\n\nfunction initializePromise(promise, resolver) {\n  try {\n    resolver(function resolvePromise(value){\n      resolve(promise, value);\n    }, function rejectPromise(reason) {\n      reject(promise, reason);\n    });\n  } catch(e) {\n    reject(promise, e);\n  }\n}\n\nlet id = 0;\nfunction nextId() {\n  return id++;\n}\n\nfunction makePromise(promise) {\n  promise[PROMISE_ID] = id++;\n  promise._state = undefined;\n  promise._result = undefined;\n  promise._subscribers = [];\n}\n\nexport {\n  nextId,\n  makePromise,\n  getThen,\n  noop,\n  resolve,\n  reject,\n  fulfill,\n  subscribe,\n  publish,\n  publishRejection,\n  initializePromise,\n  invokeCallback,\n  FULFILLED,\n  REJECTED,\n  PENDING,\n  handleMaybeThenable\n};\n"]}