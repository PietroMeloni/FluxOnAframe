{"version":3,"sources":["../../../../../../node_modules/npm/node_modules/read/lib/read.js"],"names":["module","exports","read","readline","require","Mute","opts","cb","num","Error","default","input","process","stdin","output","stdout","prompt","trim","silent","editDef","timeout","def","edit","terminal","isTTY","m","replace","pipe","end","rlOpts","version","match","rl","createInterface","unmute","setPrompt","mute","line","cursor","length","_refreshLine","called","on","onLine","onError","close","timer","setTimeout","done","removeAllListeners","pause","clearTimeout","er","write","isDefault"],"mappings":"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","file":"read.js","sourcesContent":["\nmodule.exports = read\n\nvar readline = require('readline')\nvar Mute = require('mute-stream')\n\nfunction read (opts, cb) {\n  if (opts.num) {\n    throw new Error('read() no longer accepts a char number limit')\n  }\n\n  if (typeof opts.default !== 'undefined' &&\n      typeof opts.default !== 'string' &&\n      typeof opts.default !== 'number') {\n    throw new Error('default value must be string or number')\n  }\n\n  var input = opts.input || process.stdin\n  var output = opts.output || process.stdout\n  var prompt = (opts.prompt || '').trim() + ' '\n  var silent = opts.silent\n  var editDef = false\n  var timeout = opts.timeout\n\n  var def = opts.default || ''\n  if (def) {\n    if (silent) {\n      prompt += '(<default hidden>) '\n    } else if (opts.edit) {\n      editDef = true\n    } else {\n      prompt += '(' + def + ') '\n    }\n  }\n  var terminal = !!(opts.terminal || output.isTTY)\n\n  var m = new Mute({ replace: opts.replace, prompt: prompt })\n  m.pipe(output, {end: false})\n  output = m\n  var rlOpts = { input: input, output: output, terminal: terminal }\n\n  if (process.version.match(/^v0\\.6/)) {\n    var rl = readline.createInterface(rlOpts.input, rlOpts.output)\n  } else {\n    var rl = readline.createInterface(rlOpts)\n  }\n\n\n  output.unmute()\n  rl.setPrompt(prompt)\n  rl.prompt()\n  if (silent) {\n    output.mute()\n  } else if (editDef) {\n    rl.line = def\n    rl.cursor = def.length\n    rl._refreshLine()\n  }\n\n  var called = false\n  rl.on('line', onLine)\n  rl.on('error', onError)\n\n  rl.on('SIGINT', function () {\n    rl.close()\n    onError(new Error('canceled'))\n  })\n\n  var timer\n  if (timeout) {\n    timer = setTimeout(function () {\n      onError(new Error('timed out'))\n    }, timeout)\n  }\n\n  function done () {\n    called = true\n    rl.close()\n\n    if (process.version.match(/^v0\\.6/)) {\n      rl.input.removeAllListeners('data')\n      rl.input.removeAllListeners('keypress')\n      rl.input.pause()\n    }\n\n    clearTimeout(timer)\n    output.mute()\n    output.end()\n  }\n\n  function onError (er) {\n    if (called) return\n    done()\n    return cb(er)\n  }\n\n  function onLine (line) {\n    if (called) return\n    if (silent && terminal) {\n      output.unmute()\n      output.write('\\r\\n')\n    }\n    done()\n    // truncate the \\n at the end.\n    line = line.replace(/\\r?\\n$/, '')\n    var isDefault = !!(editDef && line === def)\n    if (def && !line) {\n      isDefault = true\n      line = def\n    }\n    cb(null, line, isDefault)\n  }\n}\n"]}