{"version":3,"sources":["../../../../../node_modules/npm/node_modules/request/request.js"],"names":["http","require","https","url","util","stream","zlib","hawk","aws2","aws4","httpSignature","mime","stringstream","caseless","ForeverAgent","FormData","extend","isstream","isTypedArray","strict","helpers","cookies","getProxyFromURI","Querystring","Har","Auth","OAuth","Multipart","Redirect","Tunnel","now","Buffer","safeStringify","isReadStream","toBase64","defer","copy","version","globalCookieJar","jar","globalPool","filterForNonReserved","reserved","options","object","i","notReserved","indexOf","filterOutReservedFunctions","isReserved","isFunction","requestToJSON","self","uri","method","headers","responseToJSON","statusCode","body","request","call","Request","har","_har","Stream","Object","keys","prototype","nonReserved","readable","writable","explicitMethod","_qs","_auth","_oauth","_multipart","_redirect","_tunnel","init","inherits","debug","process","env","NODE_DEBUG","test","console","error","format","apply","arguments","headerName","httpify","localAddress","pool","dests","__isRequestRequest","_callback","callback","_callbackCalled","on","bind","baseUrl","emit","Error","baseUrlEndsWithSlash","lastIndexOf","length","uriStartsWithSlash","slice","parse","href","protocol","host","enableUnixSocket","strictSSL","rejectUnauthorized","pathname","hostname","port","isUnix","faultyUri","message","abort","hasOwnProperty","proxy","tunnel","isEnabled","setup","onRequest","setHost","hasHeader","hostHeaderName","originalHostHeaderName","setHeader","_jar","form","formData","requestForm","appendFormValue","key","value","append","formKey","formValue","Array","j","qs","path","search","aws","auth","user","username","pass","password","sendImmediately","bearer","gzip","uriAuthPieces","split","map","item","unescape","join","proxyAuthPieces","authHeader","json","multipart","time","timing","elapsedTime","setContentLength","from","byteLength","isArray","reduce","a","b","oauth","params","defaultModules","httpModules","httpModule","ca","agent","agentOptions","agentClass","forever","v","major","minor","SSL","Agent","keepAlive","getNewAgent","src","ntick","_started","lookup","_json","_aborted","end","_form","hasAuth","pipe","sentAuth","chunked","forEach","part","write","requestBodyStream","warn","getHeaders","getLength","err","isNaN","ciphers","secureProtocol","secureOptions","cert","pfx","passphrase","poolKey","name","isHttps","toString","globalAgent","maxSockets","start","startTime","Date","getTime","startTimeNow","stat","size","_aws","reqOptions","timeout","req","timings","timeoutTimer","isFinite","onRequestResponse","onRequestError","socket","isConnecting","_connecting","connecting","onLookupTiming","onConnectTiming","connect","once","removeListener","setReqTimeout","setTimeout","e","code","undefined","onReqSockConnect","clearTimeout","_reusedSocket","addRequestNoreuse","addRequest","response","timingStart","Math","round","timingPhases","wait","dns","tcp","firstByte","download","total","resume","toJSON","authorized","sslErr","authorizationError","originalHost","getHeader","removeHeader","targetCookieJar","setCookie","addCookie","cookie","ignoreError","has","_disableCookies","onResponse","_ended","noBody","responseContent","contentEncoding","trim","toLowerCase","zlibOptions","flush","Z_SYNC_FLUSH","finishFlush","createGunzip","createInflate","encoding","setEncoding","_paused","pause","dest","pipeDest","chunk","responseStarted","responseStartTime","_destdata","readResponseBody","buffers","bufferLength","strings","isBuffer","push","concat","substring","JSON","_jsonReviver","alloc","destroy","headersSent","ctname","clname","pipefilter","q","clobber","base","query","stringify","rfc3986","val","jsonReplacer","_jsonReplacer","jsonReviver","result","re","match","RegExp","unixParts","socketPath","opts","sign_version","signRes","sign","accessKeyId","secretAccessKey","secret","sessionToken","session","Authorization","date","toUTCString","verb","toUpperCase","contentType","md5","amazonHeaders","canonicalizeHeaders","bucket","resource","canonicalizeResource","authorization","signRequest","header","client","field","redirectsFollowed","originalCookieHeader","getCookieString","urihref","defaultProxyHeaderWhiteList","defaultProxyHeaderExclusiveList","module","exports"],"mappings":"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","file":"request.js","sourcesContent":["'use strict'\n\nvar http = require('http')\n  , https = require('https')\n  , url = require('url')\n  , util = require('util')\n  , stream = require('stream')\n  , zlib = require('zlib')\n  , hawk = require('hawk')\n  , aws2 = require('aws-sign2')\n  , aws4 = require('aws4')\n  , httpSignature = require('http-signature')\n  , mime = require('mime-types')\n  , stringstream = require('stringstream')\n  , caseless = require('caseless')\n  , ForeverAgent = require('forever-agent')\n  , FormData = require('form-data')\n  , extend = require('extend')\n  , isstream = require('isstream')\n  , isTypedArray = require('is-typedarray').strict\n  , helpers = require('./lib/helpers')\n  , cookies = require('./lib/cookies')\n  , getProxyFromURI = require('./lib/getProxyFromURI')\n  , Querystring = require('./lib/querystring').Querystring\n  , Har = require('./lib/har').Har\n  , Auth = require('./lib/auth').Auth\n  , OAuth = require('./lib/oauth').OAuth\n  , Multipart = require('./lib/multipart').Multipart\n  , Redirect = require('./lib/redirect').Redirect\n  , Tunnel = require('./lib/tunnel').Tunnel\n  , now = require('performance-now')\n  , Buffer = require('safe-buffer').Buffer\n\nvar safeStringify = helpers.safeStringify\n  , isReadStream = helpers.isReadStream\n  , toBase64 = helpers.toBase64\n  , defer = helpers.defer\n  , copy = helpers.copy\n  , version = helpers.version\n  , globalCookieJar = cookies.jar()\n\n\nvar globalPool = {}\n\nfunction filterForNonReserved(reserved, options) {\n  // Filter out properties that are not reserved.\n  // Reserved values are passed in at call site.\n\n  var object = {}\n  for (var i in options) {\n    var notReserved = (reserved.indexOf(i) === -1)\n    if (notReserved) {\n      object[i] = options[i]\n    }\n  }\n  return object\n}\n\nfunction filterOutReservedFunctions(reserved, options) {\n  // Filter out properties that are functions and are reserved.\n  // Reserved values are passed in at call site.\n\n  var object = {}\n  for (var i in options) {\n    var isReserved = !(reserved.indexOf(i) === -1)\n    var isFunction = (typeof options[i] === 'function')\n    if (!(isReserved && isFunction)) {\n      object[i] = options[i]\n    }\n  }\n  return object\n\n}\n\n// Return a simpler request object to allow serialization\nfunction requestToJSON() {\n  var self = this\n  return {\n    uri: self.uri,\n    method: self.method,\n    headers: self.headers\n  }\n}\n\n// Return a simpler response object to allow serialization\nfunction responseToJSON() {\n  var self = this\n  return {\n    statusCode: self.statusCode,\n    body: self.body,\n    headers: self.headers,\n    request: requestToJSON.call(self.request)\n  }\n}\n\nfunction Request (options) {\n  // if given the method property in options, set property explicitMethod to true\n\n  // extend the Request instance with any non-reserved properties\n  // remove any reserved functions from the options object\n  // set Request instance to be readable and writable\n  // call init\n\n  var self = this\n\n  // start with HAR, then override with additional options\n  if (options.har) {\n    self._har = new Har(self)\n    options = self._har.options(options)\n  }\n\n  stream.Stream.call(self)\n  var reserved = Object.keys(Request.prototype)\n  var nonReserved = filterForNonReserved(reserved, options)\n\n  extend(self, nonReserved)\n  options = filterOutReservedFunctions(reserved, options)\n\n  self.readable = true\n  self.writable = true\n  if (options.method) {\n    self.explicitMethod = true\n  }\n  self._qs = new Querystring(self)\n  self._auth = new Auth(self)\n  self._oauth = new OAuth(self)\n  self._multipart = new Multipart(self)\n  self._redirect = new Redirect(self)\n  self._tunnel = new Tunnel(self)\n  self.init(options)\n}\n\nutil.inherits(Request, stream.Stream)\n\n// Debugging\nRequest.debug = process.env.NODE_DEBUG && /\\brequest\\b/.test(process.env.NODE_DEBUG)\nfunction debug() {\n  if (Request.debug) {\n    console.error('REQUEST %s', util.format.apply(util, arguments))\n  }\n}\nRequest.prototype.debug = debug\n\nRequest.prototype.init = function (options) {\n  // init() contains all the code to setup the request object.\n  // the actual outgoing request is not started until start() is called\n  // this function is called from both the constructor and on redirect.\n  var self = this\n  if (!options) {\n    options = {}\n  }\n  self.headers = self.headers ? copy(self.headers) : {}\n\n  // Delete headers with value undefined since they break\n  // ClientRequest.OutgoingMessage.setHeader in node 0.12\n  for (var headerName in self.headers) {\n    if (typeof self.headers[headerName] === 'undefined') {\n      delete self.headers[headerName]\n    }\n  }\n\n  caseless.httpify(self, self.headers)\n\n  if (!self.method) {\n    self.method = options.method || 'GET'\n  }\n  if (!self.localAddress) {\n    self.localAddress = options.localAddress\n  }\n\n  self._qs.init(options)\n\n  debug(options)\n  if (!self.pool && self.pool !== false) {\n    self.pool = globalPool\n  }\n  self.dests = self.dests || []\n  self.__isRequestRequest = true\n\n  // Protect against double callback\n  if (!self._callback && self.callback) {\n    self._callback = self.callback\n    self.callback = function () {\n      if (self._callbackCalled) {\n        return // Print a warning maybe?\n      }\n      self._callbackCalled = true\n      self._callback.apply(self, arguments)\n    }\n    self.on('error', self.callback.bind())\n    self.on('complete', self.callback.bind(self, null))\n  }\n\n  // People use this property instead all the time, so support it\n  if (!self.uri && self.url) {\n    self.uri = self.url\n    delete self.url\n  }\n\n  // If there's a baseUrl, then use it as the base URL (i.e. uri must be\n  // specified as a relative path and is appended to baseUrl).\n  if (self.baseUrl) {\n    if (typeof self.baseUrl !== 'string') {\n      return self.emit('error', new Error('options.baseUrl must be a string'))\n    }\n\n    if (typeof self.uri !== 'string') {\n      return self.emit('error', new Error('options.uri must be a string when using options.baseUrl'))\n    }\n\n    if (self.uri.indexOf('//') === 0 || self.uri.indexOf('://') !== -1) {\n      return self.emit('error', new Error('options.uri must be a path when using options.baseUrl'))\n    }\n\n    // Handle all cases to make sure that there's only one slash between\n    // baseUrl and uri.\n    var baseUrlEndsWithSlash = self.baseUrl.lastIndexOf('/') === self.baseUrl.length - 1\n    var uriStartsWithSlash = self.uri.indexOf('/') === 0\n\n    if (baseUrlEndsWithSlash && uriStartsWithSlash) {\n      self.uri = self.baseUrl + self.uri.slice(1)\n    } else if (baseUrlEndsWithSlash || uriStartsWithSlash) {\n      self.uri = self.baseUrl + self.uri\n    } else if (self.uri === '') {\n      self.uri = self.baseUrl\n    } else {\n      self.uri = self.baseUrl + '/' + self.uri\n    }\n    delete self.baseUrl\n  }\n\n  // A URI is needed by this point, emit error if we haven't been able to get one\n  if (!self.uri) {\n    return self.emit('error', new Error('options.uri is a required argument'))\n  }\n\n  // If a string URI/URL was given, parse it into a URL object\n  if (typeof self.uri === 'string') {\n    self.uri = url.parse(self.uri)\n  }\n\n  // Some URL objects are not from a URL parsed string and need href added\n  if (!self.uri.href) {\n    self.uri.href = url.format(self.uri)\n  }\n\n  // DEPRECATED: Warning for users of the old Unix Sockets URL Scheme\n  if (self.uri.protocol === 'unix:') {\n    return self.emit('error', new Error('`unix://` URL scheme is no longer supported. Please use the format `http://unix:SOCKET:PATH`'))\n  }\n\n  // Support Unix Sockets\n  if (self.uri.host === 'unix') {\n    self.enableUnixSocket()\n  }\n\n  if (self.strictSSL === false) {\n    self.rejectUnauthorized = false\n  }\n\n  if (!self.uri.pathname) {self.uri.pathname = '/'}\n\n  if (!(self.uri.host || (self.uri.hostname && self.uri.port)) && !self.uri.isUnix) {\n    // Invalid URI: it may generate lot of bad errors, like 'TypeError: Cannot call method `indexOf` of undefined' in CookieJar\n    // Detect and reject it as soon as possible\n    var faultyUri = url.format(self.uri)\n    var message = 'Invalid URI \"' + faultyUri + '\"'\n    if (Object.keys(options).length === 0) {\n      // No option ? This can be the sign of a redirect\n      // As this is a case where the user cannot do anything (they didn't call request directly with this URL)\n      // they should be warned that it can be caused by a redirection (can save some hair)\n      message += '. This can be caused by a crappy redirection.'\n    }\n    // This error was fatal\n    self.abort()\n    return self.emit('error', new Error(message))\n  }\n\n  if (!self.hasOwnProperty('proxy')) {\n    self.proxy = getProxyFromURI(self.uri)\n  }\n\n  self.tunnel = self._tunnel.isEnabled()\n  if (self.proxy) {\n    self._tunnel.setup(options)\n  }\n\n  self._redirect.onRequest(options)\n\n  self.setHost = false\n  if (!self.hasHeader('host')) {\n    var hostHeaderName = self.originalHostHeaderName || 'host'\n    // When used with an IPv6 address, `host` will provide\n    // the correct bracketed format, unlike using `hostname` and\n    // optionally adding the `port` when necessary.\n    self.setHeader(hostHeaderName, self.uri.host)\n    self.setHost = true\n  }\n\n  self.jar(self._jar || options.jar)\n\n  if (!self.uri.port) {\n    if (self.uri.protocol === 'http:') {self.uri.port = 80}\n    else if (self.uri.protocol === 'https:') {self.uri.port = 443}\n  }\n\n  if (self.proxy && !self.tunnel) {\n    self.port = self.proxy.port\n    self.host = self.proxy.hostname\n  } else {\n    self.port = self.uri.port\n    self.host = self.uri.hostname\n  }\n\n  if (options.form) {\n    self.form(options.form)\n  }\n\n  if (options.formData) {\n    var formData = options.formData\n    var requestForm = self.form()\n    var appendFormValue = function (key, value) {\n      if (value && value.hasOwnProperty('value') && value.hasOwnProperty('options')) {\n        requestForm.append(key, value.value, value.options)\n      } else {\n        requestForm.append(key, value)\n      }\n    }\n    for (var formKey in formData) {\n      if (formData.hasOwnProperty(formKey)) {\n        var formValue = formData[formKey]\n        if (formValue instanceof Array) {\n          for (var j = 0; j < formValue.length; j++) {\n            appendFormValue(formKey, formValue[j])\n          }\n        } else {\n          appendFormValue(formKey, formValue)\n        }\n      }\n    }\n  }\n\n  if (options.qs) {\n    self.qs(options.qs)\n  }\n\n  if (self.uri.path) {\n    self.path = self.uri.path\n  } else {\n    self.path = self.uri.pathname + (self.uri.search || '')\n  }\n\n  if (self.path.length === 0) {\n    self.path = '/'\n  }\n\n  // Auth must happen last in case signing is dependent on other headers\n  if (options.aws) {\n    self.aws(options.aws)\n  }\n\n  if (options.hawk) {\n    self.hawk(options.hawk)\n  }\n\n  if (options.httpSignature) {\n    self.httpSignature(options.httpSignature)\n  }\n\n  if (options.auth) {\n    if (Object.prototype.hasOwnProperty.call(options.auth, 'username')) {\n      options.auth.user = options.auth.username\n    }\n    if (Object.prototype.hasOwnProperty.call(options.auth, 'password')) {\n      options.auth.pass = options.auth.password\n    }\n\n    self.auth(\n      options.auth.user,\n      options.auth.pass,\n      options.auth.sendImmediately,\n      options.auth.bearer\n    )\n  }\n\n  if (self.gzip && !self.hasHeader('accept-encoding')) {\n    self.setHeader('accept-encoding', 'gzip, deflate')\n  }\n\n  if (self.uri.auth && !self.hasHeader('authorization')) {\n    var uriAuthPieces = self.uri.auth.split(':').map(function(item) {return self._qs.unescape(item)})\n    self.auth(uriAuthPieces[0], uriAuthPieces.slice(1).join(':'), true)\n  }\n\n  if (!self.tunnel && self.proxy && self.proxy.auth && !self.hasHeader('proxy-authorization')) {\n    var proxyAuthPieces = self.proxy.auth.split(':').map(function(item) {return self._qs.unescape(item)})\n    var authHeader = 'Basic ' + toBase64(proxyAuthPieces.join(':'))\n    self.setHeader('proxy-authorization', authHeader)\n  }\n\n  if (self.proxy && !self.tunnel) {\n    self.path = (self.uri.protocol + '//' + self.uri.host + self.path)\n  }\n\n  if (options.json) {\n    self.json(options.json)\n  }\n  if (options.multipart) {\n    self.multipart(options.multipart)\n  }\n\n  if (options.time) {\n    self.timing = true\n\n    // NOTE: elapsedTime is deprecated in favor of .timings\n    self.elapsedTime = self.elapsedTime || 0\n  }\n\n  function setContentLength () {\n    if (isTypedArray(self.body)) {\n      self.body = Buffer.from(self.body)\n    }\n\n    if (!self.hasHeader('content-length')) {\n      var length\n      if (typeof self.body === 'string') {\n        length = Buffer.byteLength(self.body)\n      }\n      else if (Array.isArray(self.body)) {\n        length = self.body.reduce(function (a, b) {return a + b.length}, 0)\n      }\n      else {\n        length = self.body.length\n      }\n\n      if (length) {\n        self.setHeader('content-length', length)\n      } else {\n        self.emit('error', new Error('Argument error, options.body.'))\n      }\n    }\n  }\n  if (self.body && !isstream(self.body)) {\n    setContentLength()\n  }\n\n  if (options.oauth) {\n    self.oauth(options.oauth)\n  } else if (self._oauth.params && self.hasHeader('authorization')) {\n    self.oauth(self._oauth.params)\n  }\n\n  var protocol = self.proxy && !self.tunnel ? self.proxy.protocol : self.uri.protocol\n    , defaultModules = {'http:':http, 'https:':https}\n    , httpModules = self.httpModules || {}\n\n  self.httpModule = httpModules[protocol] || defaultModules[protocol]\n\n  if (!self.httpModule) {\n    return self.emit('error', new Error('Invalid protocol: ' + protocol))\n  }\n\n  if (options.ca) {\n    self.ca = options.ca\n  }\n\n  if (!self.agent) {\n    if (options.agentOptions) {\n      self.agentOptions = options.agentOptions\n    }\n\n    if (options.agentClass) {\n      self.agentClass = options.agentClass\n    } else if (options.forever) {\n      var v = version()\n      // use ForeverAgent in node 0.10- only\n      if (v.major === 0 && v.minor <= 10) {\n        self.agentClass = protocol === 'http:' ? ForeverAgent : ForeverAgent.SSL\n      } else {\n        self.agentClass = self.httpModule.Agent\n        self.agentOptions = self.agentOptions || {}\n        self.agentOptions.keepAlive = true\n      }\n    } else {\n      self.agentClass = self.httpModule.Agent\n    }\n  }\n\n  if (self.pool === false) {\n    self.agent = false\n  } else {\n    self.agent = self.agent || self.getNewAgent()\n  }\n\n  self.on('pipe', function (src) {\n    if (self.ntick && self._started) {\n      self.emit('error', new Error('You cannot pipe to this stream after the outbound request has started.'))\n    }\n    self.src = src\n    if (isReadStream(src)) {\n      if (!self.hasHeader('content-type')) {\n        self.setHeader('content-type', mime.lookup(src.path))\n      }\n    } else {\n      if (src.headers) {\n        for (var i in src.headers) {\n          if (!self.hasHeader(i)) {\n            self.setHeader(i, src.headers[i])\n          }\n        }\n      }\n      if (self._json && !self.hasHeader('content-type')) {\n        self.setHeader('content-type', 'application/json')\n      }\n      if (src.method && !self.explicitMethod) {\n        self.method = src.method\n      }\n    }\n\n    // self.on('pipe', function () {\n    //   console.error('You have already piped to this stream. Pipeing twice is likely to break the request.')\n    // })\n  })\n\n  defer(function () {\n    if (self._aborted) {\n      return\n    }\n\n    var end = function () {\n      if (self._form) {\n        if (!self._auth.hasAuth) {\n          self._form.pipe(self)\n        }\n        else if (self._auth.hasAuth && self._auth.sentAuth) {\n          self._form.pipe(self)\n        }\n      }\n      if (self._multipart && self._multipart.chunked) {\n        self._multipart.body.pipe(self)\n      }\n      if (self.body) {\n        if (isstream(self.body)) {\n          self.body.pipe(self)\n        } else {\n          setContentLength()\n          if (Array.isArray(self.body)) {\n            self.body.forEach(function (part) {\n              self.write(part)\n            })\n          } else {\n            self.write(self.body)\n          }\n          self.end()\n        }\n      } else if (self.requestBodyStream) {\n        console.warn('options.requestBodyStream is deprecated, please pass the request object to stream.pipe.')\n        self.requestBodyStream.pipe(self)\n      } else if (!self.src) {\n        if (self._auth.hasAuth && !self._auth.sentAuth) {\n          self.end()\n          return\n        }\n        if (self.method !== 'GET' && typeof self.method !== 'undefined') {\n          self.setHeader('content-length', 0)\n        }\n        self.end()\n      }\n    }\n\n    if (self._form && !self.hasHeader('content-length')) {\n      // Before ending the request, we had to compute the length of the whole form, asyncly\n      self.setHeader(self._form.getHeaders(), true)\n      self._form.getLength(function (err, length) {\n        if (!err && !isNaN(length)) {\n          self.setHeader('content-length', length)\n        }\n        end()\n      })\n    } else {\n      end()\n    }\n\n    self.ntick = true\n  })\n\n}\n\nRequest.prototype.getNewAgent = function () {\n  var self = this\n  var Agent = self.agentClass\n  var options = {}\n  if (self.agentOptions) {\n    for (var i in self.agentOptions) {\n      options[i] = self.agentOptions[i]\n    }\n  }\n  if (self.ca) {\n    options.ca = self.ca\n  }\n  if (self.ciphers) {\n    options.ciphers = self.ciphers\n  }\n  if (self.secureProtocol) {\n    options.secureProtocol = self.secureProtocol\n  }\n  if (self.secureOptions) {\n    options.secureOptions = self.secureOptions\n  }\n  if (typeof self.rejectUnauthorized !== 'undefined') {\n    options.rejectUnauthorized = self.rejectUnauthorized\n  }\n\n  if (self.cert && self.key) {\n    options.key = self.key\n    options.cert = self.cert\n  }\n\n  if (self.pfx) {\n    options.pfx = self.pfx\n  }\n\n  if (self.passphrase) {\n    options.passphrase = self.passphrase\n  }\n\n  var poolKey = ''\n\n  // different types of agents are in different pools\n  if (Agent !== self.httpModule.Agent) {\n    poolKey += Agent.name\n  }\n\n  // ca option is only relevant if proxy or destination are https\n  var proxy = self.proxy\n  if (typeof proxy === 'string') {\n    proxy = url.parse(proxy)\n  }\n  var isHttps = (proxy && proxy.protocol === 'https:') || this.uri.protocol === 'https:'\n\n  if (isHttps) {\n    if (options.ca) {\n      if (poolKey) {\n        poolKey += ':'\n      }\n      poolKey += options.ca\n    }\n\n    if (typeof options.rejectUnauthorized !== 'undefined') {\n      if (poolKey) {\n        poolKey += ':'\n      }\n      poolKey += options.rejectUnauthorized\n    }\n\n    if (options.cert) {\n      if (poolKey) {\n        poolKey += ':'\n      }\n      poolKey += options.cert.toString('ascii') + options.key.toString('ascii')\n    }\n\n    if (options.pfx) {\n      if (poolKey) {\n        poolKey += ':'\n      }\n      poolKey += options.pfx.toString('ascii')\n    }\n\n    if (options.ciphers) {\n      if (poolKey) {\n        poolKey += ':'\n      }\n      poolKey += options.ciphers\n    }\n\n    if (options.secureProtocol) {\n      if (poolKey) {\n        poolKey += ':'\n      }\n      poolKey += options.secureProtocol\n    }\n\n    if (options.secureOptions) {\n      if (poolKey) {\n        poolKey += ':'\n      }\n      poolKey += options.secureOptions\n    }\n  }\n\n  if (self.pool === globalPool && !poolKey && Object.keys(options).length === 0 && self.httpModule.globalAgent) {\n    // not doing anything special.  Use the globalAgent\n    return self.httpModule.globalAgent\n  }\n\n  // we're using a stored agent.  Make sure it's protocol-specific\n  poolKey = self.uri.protocol + poolKey\n\n  // generate a new agent for this setting if none yet exists\n  if (!self.pool[poolKey]) {\n    self.pool[poolKey] = new Agent(options)\n    // properly set maxSockets on new agents\n    if (self.pool.maxSockets) {\n      self.pool[poolKey].maxSockets = self.pool.maxSockets\n    }\n  }\n\n  return self.pool[poolKey]\n}\n\nRequest.prototype.start = function () {\n  // start() is called once we are ready to send the outgoing HTTP request.\n  // this is usually called on the first write(), end() or on nextTick()\n  var self = this\n\n  if (self.timing) {\n    // All timings will be relative to this request's startTime.  In order to do this,\n    // we need to capture the wall-clock start time (via Date), immediately followed\n    // by the high-resolution timer (via now()).  While these two won't be set\n    // at the _exact_ same time, they should be close enough to be able to calculate\n    // high-resolution, monotonically non-decreasing timestamps relative to startTime.\n    var startTime = new Date().getTime()\n    var startTimeNow = now()\n  }\n\n  if (self._aborted) {\n    return\n  }\n\n  self._started = true\n  self.method = self.method || 'GET'\n  self.href = self.uri.href\n\n  if (self.src && self.src.stat && self.src.stat.size && !self.hasHeader('content-length')) {\n    self.setHeader('content-length', self.src.stat.size)\n  }\n  if (self._aws) {\n    self.aws(self._aws, true)\n  }\n\n  // We have a method named auth, which is completely different from the http.request\n  // auth option.  If we don't remove it, we're gonna have a bad time.\n  var reqOptions = copy(self)\n  delete reqOptions.auth\n\n  debug('make request', self.uri.href)\n\n  // node v6.8.0 now supports a `timeout` value in `http.request()`, but we\n  // should delete it for now since we handle timeouts manually for better\n  // consistency with node versions before v6.8.0\n  delete reqOptions.timeout\n\n  try {\n    self.req = self.httpModule.request(reqOptions)\n  } catch (err) {\n    self.emit('error', err)\n    return\n  }\n\n  if (self.timing) {\n    self.startTime = startTime\n    self.startTimeNow = startTimeNow\n\n    // Timing values will all be relative to startTime (by comparing to startTimeNow\n    // so we have an accurate clock)\n    self.timings = {}\n  }\n\n  var timeout\n  if (self.timeout && !self.timeoutTimer) {\n    if (self.timeout < 0) {\n      timeout = 0\n    } else if (typeof self.timeout === 'number' && isFinite(self.timeout)) {\n      timeout = self.timeout\n    }\n  }\n\n  self.req.on('response', self.onRequestResponse.bind(self))\n  self.req.on('error', self.onRequestError.bind(self))\n  self.req.on('drain', function() {\n    self.emit('drain')\n  })\n  self.req.on('socket', function(socket) {\n    // `._connecting` was the old property which was made public in node v6.1.0\n    var isConnecting = socket._connecting || socket.connecting\n    if (self.timing) {\n      self.timings.socket = now() - self.startTimeNow\n\n      if (isConnecting) {\n        var onLookupTiming = function() {\n          self.timings.lookup = now() - self.startTimeNow\n        }\n\n        var onConnectTiming = function() {\n          self.timings.connect = now() - self.startTimeNow\n        }\n\n        socket.once('lookup', onLookupTiming)\n        socket.once('connect', onConnectTiming)\n\n        // clean up timing event listeners if needed on error\n        self.req.once('error', function() {\n          socket.removeListener('lookup', onLookupTiming)\n          socket.removeListener('connect', onConnectTiming)\n        })\n      }\n    }\n\n    var setReqTimeout = function() {\n      // This timeout sets the amount of time to wait *between* bytes sent\n      // from the server once connected.\n      //\n      // In particular, it's useful for erroring if the server fails to send\n      // data halfway through streaming a response.\n      self.req.setTimeout(timeout, function () {\n        if (self.req) {\n          self.abort()\n          var e = new Error('ESOCKETTIMEDOUT')\n          e.code = 'ESOCKETTIMEDOUT'\n          e.connect = false\n          self.emit('error', e)\n        }\n      })\n    }\n    if (timeout !== undefined) {\n      // Only start the connection timer if we're actually connecting a new\n      // socket, otherwise if we're already connected (because this is a\n      // keep-alive connection) do not bother. This is important since we won't\n      // get a 'connect' event for an already connected socket.\n      if (isConnecting) {\n        var onReqSockConnect = function() {\n          socket.removeListener('connect', onReqSockConnect)\n          clearTimeout(self.timeoutTimer)\n          self.timeoutTimer = null\n          setReqTimeout()\n        }\n\n        socket.on('connect', onReqSockConnect)\n\n        self.req.on('error', function(err) {\n          socket.removeListener('connect', onReqSockConnect)\n        })\n\n        // Set a timeout in memory - this block will throw if the server takes more\n        // than `timeout` to write the HTTP status and headers (corresponding to\n        // the on('response') event on the client). NB: this measures wall-clock\n        // time, not the time between bytes sent by the server.\n        self.timeoutTimer = setTimeout(function () {\n          socket.removeListener('connect', onReqSockConnect)\n          self.abort()\n          var e = new Error('ETIMEDOUT')\n          e.code = 'ETIMEDOUT'\n          e.connect = true\n          self.emit('error', e)\n        }, timeout)\n      } else {\n        // We're already connected\n        setReqTimeout()\n      }\n    }\n    self.emit('socket', socket)\n  })\n\n  self.emit('request', self.req)\n}\n\nRequest.prototype.onRequestError = function (error) {\n  var self = this\n  if (self._aborted) {\n    return\n  }\n  if (self.req && self.req._reusedSocket && error.code === 'ECONNRESET'\n      && self.agent.addRequestNoreuse) {\n    self.agent = { addRequest: self.agent.addRequestNoreuse.bind(self.agent) }\n    self.start()\n    self.req.end()\n    return\n  }\n  if (self.timeout && self.timeoutTimer) {\n    clearTimeout(self.timeoutTimer)\n    self.timeoutTimer = null\n  }\n  self.emit('error', error)\n}\n\nRequest.prototype.onRequestResponse = function (response) {\n  var self = this\n\n  if (self.timing) {\n    self.timings.response = now() - self.startTimeNow\n  }\n\n  debug('onRequestResponse', self.uri.href, response.statusCode, response.headers)\n  response.on('end', function() {\n    if (self.timing) {\n      self.timings.end = now() - self.startTimeNow\n      response.timingStart = self.startTime\n\n      // fill in the blanks for any periods that didn't trigger, such as\n      // no lookup or connect due to keep alive\n      if (!self.timings.socket) {\n        self.timings.socket = 0\n      }\n      if (!self.timings.lookup) {\n        self.timings.lookup = self.timings.socket\n      }\n      if (!self.timings.connect) {\n        self.timings.connect = self.timings.lookup\n      }\n      if (!self.timings.response) {\n        self.timings.response = self.timings.connect\n      }\n\n      debug('elapsed time', self.timings.end)\n\n      // elapsedTime includes all redirects\n      self.elapsedTime += Math.round(self.timings.end)\n\n      // NOTE: elapsedTime is deprecated in favor of .timings\n      response.elapsedTime = self.elapsedTime\n\n      // timings is just for the final fetch\n      response.timings = self.timings\n\n      // pre-calculate phase timings as well\n      response.timingPhases = {\n        wait: self.timings.socket,\n        dns: self.timings.lookup - self.timings.socket,\n        tcp: self.timings.connect - self.timings.lookup,\n        firstByte: self.timings.response - self.timings.connect,\n        download: self.timings.end - self.timings.response,\n        total: self.timings.end\n      }\n    }\n    debug('response end', self.uri.href, response.statusCode, response.headers)\n  })\n\n  if (self._aborted) {\n    debug('aborted', self.uri.href)\n    response.resume()\n    return\n  }\n\n  self.response = response\n  response.request = self\n  response.toJSON = responseToJSON\n\n  // XXX This is different on 0.10, because SSL is strict by default\n  if (self.httpModule === https &&\n      self.strictSSL && (!response.hasOwnProperty('socket') ||\n      !response.socket.authorized)) {\n    debug('strict ssl error', self.uri.href)\n    var sslErr = response.hasOwnProperty('socket') ? response.socket.authorizationError : self.uri.href + ' does not support SSL'\n    self.emit('error', new Error('SSL Error: ' + sslErr))\n    return\n  }\n\n  // Save the original host before any redirect (if it changes, we need to\n  // remove any authorization headers).  Also remember the case of the header\n  // name because lots of broken servers expect Host instead of host and we\n  // want the caller to be able to specify this.\n  self.originalHost = self.getHeader('host')\n  if (!self.originalHostHeaderName) {\n    self.originalHostHeaderName = self.hasHeader('host')\n  }\n  if (self.setHost) {\n    self.removeHeader('host')\n  }\n  if (self.timeout && self.timeoutTimer) {\n    clearTimeout(self.timeoutTimer)\n    self.timeoutTimer = null\n  }\n\n  var targetCookieJar = (self._jar && self._jar.setCookie) ? self._jar : globalCookieJar\n  var addCookie = function (cookie) {\n    //set the cookie if it's domain in the href's domain.\n    try {\n      targetCookieJar.setCookie(cookie, self.uri.href, {ignoreError: true})\n    } catch (e) {\n      self.emit('error', e)\n    }\n  }\n\n  response.caseless = caseless(response.headers)\n\n  if (response.caseless.has('set-cookie') && (!self._disableCookies)) {\n    var headerName = response.caseless.has('set-cookie')\n    if (Array.isArray(response.headers[headerName])) {\n      response.headers[headerName].forEach(addCookie)\n    } else {\n      addCookie(response.headers[headerName])\n    }\n  }\n\n  if (self._redirect.onResponse(response)) {\n    return // Ignore the rest of the response\n  } else {\n    // Be a good stream and emit end when the response is finished.\n    // Hack to emit end on close because of a core bug that never fires end\n    response.on('close', function () {\n      if (!self._ended) {\n        self.response.emit('end')\n      }\n    })\n\n    response.once('end', function () {\n      self._ended = true\n    })\n\n    var noBody = function (code) {\n      return (\n        self.method === 'HEAD'\n        // Informational\n        || (code >= 100 && code < 200)\n        // No Content\n        || code === 204\n        // Not Modified\n        || code === 304\n      )\n    }\n\n    var responseContent\n    if (self.gzip && !noBody(response.statusCode)) {\n      var contentEncoding = response.headers['content-encoding'] || 'identity'\n      contentEncoding = contentEncoding.trim().toLowerCase()\n\n      // Be more lenient with decoding compressed responses, since (very rarely)\n      // servers send slightly invalid gzip responses that are still accepted\n      // by common browsers.\n      // Always using Z_SYNC_FLUSH is what cURL does.\n      var zlibOptions = {\n        flush: zlib.Z_SYNC_FLUSH\n      , finishFlush: zlib.Z_SYNC_FLUSH\n      }\n\n      if (contentEncoding === 'gzip') {\n        responseContent = zlib.createGunzip(zlibOptions)\n        response.pipe(responseContent)\n      } else if (contentEncoding === 'deflate') {\n        responseContent = zlib.createInflate(zlibOptions)\n        response.pipe(responseContent)\n      } else {\n        // Since previous versions didn't check for Content-Encoding header,\n        // ignore any invalid values to preserve backwards-compatibility\n        if (contentEncoding !== 'identity') {\n          debug('ignoring unrecognized Content-Encoding ' + contentEncoding)\n        }\n        responseContent = response\n      }\n    } else {\n      responseContent = response\n    }\n\n    if (self.encoding) {\n      if (self.dests.length !== 0) {\n        console.error('Ignoring encoding parameter as this stream is being piped to another stream which makes the encoding option invalid.')\n      } else if (responseContent.setEncoding) {\n        responseContent.setEncoding(self.encoding)\n      } else {\n        // Should only occur on node pre-v0.9.4 (joyent/node@9b5abe5) with\n        // zlib streams.\n        // If/When support for 0.9.4 is dropped, this should be unnecessary.\n        responseContent = responseContent.pipe(stringstream(self.encoding))\n      }\n    }\n\n    if (self._paused) {\n      responseContent.pause()\n    }\n\n    self.responseContent = responseContent\n\n    self.emit('response', response)\n\n    self.dests.forEach(function (dest) {\n      self.pipeDest(dest)\n    })\n\n    responseContent.on('data', function (chunk) {\n      if (self.timing && !self.responseStarted) {\n        self.responseStartTime = (new Date()).getTime()\n\n        // NOTE: responseStartTime is deprecated in favor of .timings\n        response.responseStartTime = self.responseStartTime\n      }\n      self._destdata = true\n      self.emit('data', chunk)\n    })\n    responseContent.once('end', function (chunk) {\n      self.emit('end', chunk)\n    })\n    responseContent.on('error', function (error) {\n      self.emit('error', error)\n    })\n    responseContent.on('close', function () {self.emit('close')})\n\n    if (self.callback) {\n      self.readResponseBody(response)\n    }\n    //if no callback\n    else {\n      self.on('end', function () {\n        if (self._aborted) {\n          debug('aborted', self.uri.href)\n          return\n        }\n        self.emit('complete', response)\n      })\n    }\n  }\n  debug('finish init function', self.uri.href)\n}\n\nRequest.prototype.readResponseBody = function (response) {\n  var self = this\n  debug('reading response\\'s body')\n  var buffers = []\n    , bufferLength = 0\n    , strings = []\n\n  self.on('data', function (chunk) {\n    if (!Buffer.isBuffer(chunk)) {\n      strings.push(chunk)\n    } else if (chunk.length) {\n      bufferLength += chunk.length\n      buffers.push(chunk)\n    }\n  })\n  self.on('end', function () {\n    debug('end event', self.uri.href)\n    if (self._aborted) {\n      debug('aborted', self.uri.href)\n      // `buffer` is defined in the parent scope and used in a closure it exists for the life of the request.\n      // This can lead to leaky behavior if the user retains a reference to the request object.\n      buffers = []\n      bufferLength = 0\n      return\n    }\n\n    if (bufferLength) {\n      debug('has body', self.uri.href, bufferLength)\n      response.body = Buffer.concat(buffers, bufferLength)\n      if (self.encoding !== null) {\n        response.body = response.body.toString(self.encoding)\n      }\n      // `buffer` is defined in the parent scope and used in a closure it exists for the life of the Request.\n      // This can lead to leaky behavior if the user retains a reference to the request object.\n      buffers = []\n      bufferLength = 0\n    } else if (strings.length) {\n      // The UTF8 BOM [0xEF,0xBB,0xBF] is converted to [0xFE,0xFF] in the JS UTC16/UCS2 representation.\n      // Strip this value out when the encoding is set to 'utf8', as upstream consumers won't expect it and it breaks JSON.parse().\n      if (self.encoding === 'utf8' && strings[0].length > 0 && strings[0][0] === '\\uFEFF') {\n        strings[0] = strings[0].substring(1)\n      }\n      response.body = strings.join('')\n    }\n\n    if (self._json) {\n      try {\n        response.body = JSON.parse(response.body, self._jsonReviver)\n      } catch (e) {\n        debug('invalid JSON received', self.uri.href)\n      }\n    }\n    debug('emitting complete', self.uri.href)\n    if (typeof response.body === 'undefined' && !self._json) {\n      response.body = self.encoding === null ? Buffer.alloc(0) : ''\n    }\n    self.emit('complete', response, response.body)\n  })\n}\n\nRequest.prototype.abort = function () {\n  var self = this\n  self._aborted = true\n\n  if (self.req) {\n    self.req.abort()\n  }\n  else if (self.response) {\n    self.response.destroy()\n  }\n\n  self.emit('abort')\n}\n\nRequest.prototype.pipeDest = function (dest) {\n  var self = this\n  var response = self.response\n  // Called after the response is received\n  if (dest.headers && !dest.headersSent) {\n    if (response.caseless.has('content-type')) {\n      var ctname = response.caseless.has('content-type')\n      if (dest.setHeader) {\n        dest.setHeader(ctname, response.headers[ctname])\n      }\n      else {\n        dest.headers[ctname] = response.headers[ctname]\n      }\n    }\n\n    if (response.caseless.has('content-length')) {\n      var clname = response.caseless.has('content-length')\n      if (dest.setHeader) {\n        dest.setHeader(clname, response.headers[clname])\n      } else {\n        dest.headers[clname] = response.headers[clname]\n      }\n    }\n  }\n  if (dest.setHeader && !dest.headersSent) {\n    for (var i in response.headers) {\n      // If the response content is being decoded, the Content-Encoding header\n      // of the response doesn't represent the piped content, so don't pass it.\n      if (!self.gzip || i !== 'content-encoding') {\n        dest.setHeader(i, response.headers[i])\n      }\n    }\n    dest.statusCode = response.statusCode\n  }\n  if (self.pipefilter) {\n    self.pipefilter(response, dest)\n  }\n}\n\nRequest.prototype.qs = function (q, clobber) {\n  var self = this\n  var base\n  if (!clobber && self.uri.query) {\n    base = self._qs.parse(self.uri.query)\n  } else {\n    base = {}\n  }\n\n  for (var i in q) {\n    base[i] = q[i]\n  }\n\n  var qs = self._qs.stringify(base)\n\n  if (qs === '') {\n    return self\n  }\n\n  self.uri = url.parse(self.uri.href.split('?')[0] + '?' + qs)\n  self.url = self.uri\n  self.path = self.uri.path\n\n  if (self.uri.host === 'unix') {\n    self.enableUnixSocket()\n  }\n\n  return self\n}\nRequest.prototype.form = function (form) {\n  var self = this\n  if (form) {\n    if (!/^application\\/x-www-form-urlencoded\\b/.test(self.getHeader('content-type'))) {\n      self.setHeader('content-type', 'application/x-www-form-urlencoded')\n    }\n    self.body = (typeof form === 'string')\n      ? self._qs.rfc3986(form.toString('utf8'))\n      : self._qs.stringify(form).toString('utf8')\n    return self\n  }\n  // create form-data object\n  self._form = new FormData()\n  self._form.on('error', function(err) {\n    err.message = 'form-data: ' + err.message\n    self.emit('error', err)\n    self.abort()\n  })\n  return self._form\n}\nRequest.prototype.multipart = function (multipart) {\n  var self = this\n\n  self._multipart.onRequest(multipart)\n\n  if (!self._multipart.chunked) {\n    self.body = self._multipart.body\n  }\n\n  return self\n}\nRequest.prototype.json = function (val) {\n  var self = this\n\n  if (!self.hasHeader('accept')) {\n    self.setHeader('accept', 'application/json')\n  }\n\n  if (typeof self.jsonReplacer === 'function') {\n    self._jsonReplacer = self.jsonReplacer\n  }\n\n  self._json = true\n  if (typeof val === 'boolean') {\n    if (self.body !== undefined) {\n      if (!/^application\\/x-www-form-urlencoded\\b/.test(self.getHeader('content-type'))) {\n        self.body = safeStringify(self.body, self._jsonReplacer)\n      } else {\n        self.body = self._qs.rfc3986(self.body)\n      }\n      if (!self.hasHeader('content-type')) {\n        self.setHeader('content-type', 'application/json')\n      }\n    }\n  } else {\n    self.body = safeStringify(val, self._jsonReplacer)\n    if (!self.hasHeader('content-type')) {\n      self.setHeader('content-type', 'application/json')\n    }\n  }\n\n  if (typeof self.jsonReviver === 'function') {\n    self._jsonReviver = self.jsonReviver\n  }\n\n  return self\n}\nRequest.prototype.getHeader = function (name, headers) {\n  var self = this\n  var result, re, match\n  if (!headers) {\n    headers = self.headers\n  }\n  Object.keys(headers).forEach(function (key) {\n    if (key.length !== name.length) {\n      return\n    }\n    re = new RegExp(name, 'i')\n    match = key.match(re)\n    if (match) {\n      result = headers[key]\n    }\n  })\n  return result\n}\nRequest.prototype.enableUnixSocket = function () {\n  // Get the socket & request paths from the URL\n  var unixParts = this.uri.path.split(':')\n    , host = unixParts[0]\n    , path = unixParts[1]\n  // Apply unix properties to request\n  this.socketPath = host\n  this.uri.pathname = path\n  this.uri.path = path\n  this.uri.host = host\n  this.uri.hostname = host\n  this.uri.isUnix = true\n}\n\n\nRequest.prototype.auth = function (user, pass, sendImmediately, bearer) {\n  var self = this\n\n  self._auth.onRequest(user, pass, sendImmediately, bearer)\n\n  return self\n}\nRequest.prototype.aws = function (opts, now) {\n  var self = this\n\n  if (!now) {\n    self._aws = opts\n    return self\n  }\n\n  if (opts.sign_version == 4 || opts.sign_version == '4') {\n    // use aws4\n    var options = {\n      host: self.uri.host,\n      path: self.uri.path,\n      method: self.method,\n      headers: {\n        'content-type': self.getHeader('content-type') || ''\n      },\n      body: self.body\n    }\n    var signRes = aws4.sign(options, {\n      accessKeyId: opts.key,\n      secretAccessKey: opts.secret,\n      sessionToken: opts.session\n    })\n    self.setHeader('authorization', signRes.headers.Authorization)\n    self.setHeader('x-amz-date', signRes.headers['X-Amz-Date'])\n    if (signRes.headers['X-Amz-Security-Token']) {\n      self.setHeader('x-amz-security-token', signRes.headers['X-Amz-Security-Token'])\n    }\n  }\n  else {\n    // default: use aws-sign2\n    var date = new Date()\n    self.setHeader('date', date.toUTCString())\n    var auth =\n      { key: opts.key\n      , secret: opts.secret\n      , verb: self.method.toUpperCase()\n      , date: date\n      , contentType: self.getHeader('content-type') || ''\n      , md5: self.getHeader('content-md5') || ''\n      , amazonHeaders: aws2.canonicalizeHeaders(self.headers)\n      }\n    var path = self.uri.path\n    if (opts.bucket && path) {\n      auth.resource = '/' + opts.bucket + path\n    } else if (opts.bucket && !path) {\n      auth.resource = '/' + opts.bucket\n    } else if (!opts.bucket && path) {\n      auth.resource = path\n    } else if (!opts.bucket && !path) {\n      auth.resource = '/'\n    }\n    auth.resource = aws2.canonicalizeResource(auth.resource)\n    self.setHeader('authorization', aws2.authorization(auth))\n  }\n\n  return self\n}\nRequest.prototype.httpSignature = function (opts) {\n  var self = this\n  httpSignature.signRequest({\n    getHeader: function(header) {\n      return self.getHeader(header, self.headers)\n    },\n    setHeader: function(header, value) {\n      self.setHeader(header, value)\n    },\n    method: self.method,\n    path: self.path\n  }, opts)\n  debug('httpSignature authorization', self.getHeader('authorization'))\n\n  return self\n}\nRequest.prototype.hawk = function (opts) {\n  var self = this\n  self.setHeader('Authorization', hawk.client.header(self.uri, self.method, opts).field)\n}\nRequest.prototype.oauth = function (_oauth) {\n  var self = this\n\n  self._oauth.onRequest(_oauth)\n\n  return self\n}\n\nRequest.prototype.jar = function (jar) {\n  var self = this\n  var cookies\n\n  if (self._redirect.redirectsFollowed === 0) {\n    self.originalCookieHeader = self.getHeader('cookie')\n  }\n\n  if (!jar) {\n    // disable cookies\n    cookies = false\n    self._disableCookies = true\n  } else {\n    var targetCookieJar = (jar && jar.getCookieString) ? jar : globalCookieJar\n    var urihref = self.uri.href\n    //fetch cookie in the Specified host\n    if (targetCookieJar) {\n      cookies = targetCookieJar.getCookieString(urihref)\n    }\n  }\n\n  //if need cookie and cookie is not empty\n  if (cookies && cookies.length) {\n    if (self.originalCookieHeader) {\n      // Don't overwrite existing Cookie header\n      self.setHeader('cookie', self.originalCookieHeader + '; ' + cookies)\n    } else {\n      self.setHeader('cookie', cookies)\n    }\n  }\n  self._jar = jar\n  return self\n}\n\n\n// Stream API\nRequest.prototype.pipe = function (dest, opts) {\n  var self = this\n\n  if (self.response) {\n    if (self._destdata) {\n      self.emit('error', new Error('You cannot pipe after data has been emitted from the response.'))\n    } else if (self._ended) {\n      self.emit('error', new Error('You cannot pipe after the response has been ended.'))\n    } else {\n      stream.Stream.prototype.pipe.call(self, dest, opts)\n      self.pipeDest(dest)\n      return dest\n    }\n  } else {\n    self.dests.push(dest)\n    stream.Stream.prototype.pipe.call(self, dest, opts)\n    return dest\n  }\n}\nRequest.prototype.write = function () {\n  var self = this\n  if (self._aborted) {return}\n\n  if (!self._started) {\n    self.start()\n  }\n  if (self.req) {\n    return self.req.write.apply(self.req, arguments)\n  }\n}\nRequest.prototype.end = function (chunk) {\n  var self = this\n  if (self._aborted) {return}\n\n  if (chunk) {\n    self.write(chunk)\n  }\n  if (!self._started) {\n    self.start()\n  }\n  if (self.req) {\n    self.req.end()\n  }\n}\nRequest.prototype.pause = function () {\n  var self = this\n  if (!self.responseContent) {\n    self._paused = true\n  } else {\n    self.responseContent.pause.apply(self.responseContent, arguments)\n  }\n}\nRequest.prototype.resume = function () {\n  var self = this\n  if (!self.responseContent) {\n    self._paused = false\n  } else {\n    self.responseContent.resume.apply(self.responseContent, arguments)\n  }\n}\nRequest.prototype.destroy = function () {\n  var self = this\n  if (!self._ended) {\n    self.end()\n  } else if (self.response) {\n    self.response.destroy()\n  }\n}\n\nRequest.defaultProxyHeaderWhiteList =\n  Tunnel.defaultProxyHeaderWhiteList.slice()\n\nRequest.defaultProxyHeaderExclusiveList =\n  Tunnel.defaultProxyHeaderExclusiveList.slice()\n\n// Exports\n\nRequest.prototype.toJSON = requestToJSON\nmodule.exports = Request\n"]}