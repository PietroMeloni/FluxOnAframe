{"version":3,"sources":["../../../../../../node_modules/npm/node_modules/config-chain/test/save.js"],"names":["CC","require","ConfigChain","test","f1","f2","ini","f1data","foo","bar","bloo","f2data","oof","rab","oolb","fs","writeFileSync","stringify","JSON","t","add","grelb","addFile","on","cc","same","snapshot","list","set","save","equal","readFileSync","pass","end"],"mappings":";;AAAA,IAAIA,KAAKC,QAAQ,aAAR,EAAuBC,WAAhC;AACA,IAAIC,OAAOF,QAAQ,KAAR,EAAeE,IAA1B;;AAEA,IAAIC,KAAK,aAAT;AACA,IAAIC,KAAK,cAAT;;AAEA,IAAIC,MAAML,QAAQ,KAAR,CAAV;;AAEA,IAAIM,SAAS,EAACC,KAAK,EAACC,KAAK,KAAN,EAAN,EAAoBC,MAAM,MAA1B,EAAb;AACA,IAAIC,SAAS,EAACC,KAAK,EAACC,KAAK,KAAN,EAAN,EAAoBC,MAAM,MAA1B,EAAb;;AAEA,IAAIC,KAAKd,QAAQ,IAAR,CAAT;;AAEAc,GAAGC,aAAH,CAAiBZ,EAAjB,EAAqBE,IAAIW,SAAJ,CAAcV,MAAd,CAArB,EAA4C,MAA5C;AACAQ,GAAGC,aAAH,CAAiBX,EAAjB,EAAqBa,KAAKD,SAAL,CAAeN,MAAf,CAArB,EAA6C,MAA7C;;AAEAR,KAAK,mCAAL,EAA0C,UAAUgB,CAAV,EAAa;AACrD,MAAInB,EAAJ,GACGoB,GADH,CACO,EAACC,OAAM,OAAP,EADP,EACwB,KADxB,EAEGC,OAFH,CAEWlB,EAFX,EAEe,KAFf,EAEsB,SAFtB,EAGGkB,OAHH,CAGWjB,EAHX,EAGe,MAHf,EAGuB,UAHvB,EAIGkB,EAJH,CAIM,MAJN,EAIc,UAAUC,EAAV,EAAc;;AAExBL,MAAEM,IAAF,CAAOD,GAAGE,QAAV,EAAoB,EAAEL,OAAO,OAAT;AACEX,YAAM,MADR;AAEEF,WAAK,EAAEC,KAAK,KAAP,EAFP;AAGEG,WAAK,EAAEC,KAAK,KAAP,EAHP;AAIEC,YAAM,MAJR,EAApB;;AAMAK,MAAEM,IAAF,CAAOD,GAAGG,IAAV,EAAgB,CAAE,EAAEN,OAAO,OAAT,EAAF,EACE,EAAEX,MAAM,MAAR,EAAgBF,KAAK,EAAEC,KAAK,KAAP,EAArB,EADF,EAEE,EAAEG,KAAK,EAAEC,KAAK,KAAP,EAAP,EAAuBC,MAAM,MAA7B,EAFF,CAAhB;;AAIAU,OAAGI,GAAH,CAAO,OAAP,EAAgB,OAAhB,EAAyB,KAAzB,EACGA,GADH,CACO,KADP,EACc,KADd,EACqB,SADrB,EAEGA,GAFH,CAEO,KAFP,EAEc,KAFd,EAEqB,UAFrB,EAGGC,IAHH,CAGQ,SAHR,EAIGA,IAJH,CAIQ,UAJR,EAKGN,EALH,CAKM,MALN,EAKc,YAAY;AACtBJ,QAAEW,KAAF,CAAQf,GAAGgB,YAAH,CAAgB3B,EAAhB,EAAoB,MAApB,CAAR,EACQ,sBADR;AAEAe,QAAEW,KAAF,CAAQf,GAAGgB,YAAH,CAAgB1B,EAAhB,EAAoB,MAApB,CAAR,EACQ,qCADR;;AAGAc,QAAEM,IAAF,CAAOD,GAAGE,QAAV,EAAoB,EAAEL,OAAO,OAAT;AACEX,cAAM,MADR;AAEEF,aAAK,KAFP;AAGEI,aAAK,KAHP;AAIEE,cAAM,MAJR,EAApB;;AAMAK,QAAEM,IAAF,CAAOD,GAAGG,IAAV,EAAgB,CAAE,EAAEN,OAAO,OAAT,EAAF,EACE,EAAEX,MAAM,MAAR,EAAgBF,KAAK,KAArB,EADF,EAEE,EAAEI,KAAK,KAAP,EAAcE,MAAM,MAApB,EAFF,CAAhB;;AAIAK,QAAEa,IAAF,CAAO,IAAP;AACAb,QAAEc,GAAF;AACD,KAvBH;AAwBD,GAxCH;AAyCD,CA1CD","file":"save.js","sourcesContent":["var CC = require('../index.js').ConfigChain\nvar test = require('tap').test\n\nvar f1 = '/tmp/f1.ini'\nvar f2 = '/tmp/f2.json'\n\nvar ini = require('ini')\n\nvar f1data = {foo: {bar: 'baz'}, bloo: 'jaus'}\nvar f2data = {oof: {rab: 'zab'}, oolb: 'suaj'}\n\nvar fs = require('fs')\n\nfs.writeFileSync(f1, ini.stringify(f1data), 'utf8')\nfs.writeFileSync(f2, JSON.stringify(f2data), 'utf8')\n\ntest('test saving and loading ini files', function (t) {\n  new CC()\n    .add({grelb:'blerg'}, 'opt')\n    .addFile(f1, 'ini', 'inifile')\n    .addFile(f2, 'json', 'jsonfile')\n    .on('load', function (cc) {\n\n      t.same(cc.snapshot, { grelb: 'blerg',\n                            bloo: 'jaus',\n                            foo: { bar: 'baz' },\n                            oof: { rab: 'zab' },\n                            oolb: 'suaj' })\n\n      t.same(cc.list, [ { grelb: 'blerg' },\n                        { bloo: 'jaus', foo: { bar: 'baz' } },\n                        { oof: { rab: 'zab' }, oolb: 'suaj' } ])\n\n      cc.set('grelb', 'brelg', 'opt')\n        .set('foo', 'zoo', 'inifile')\n        .set('oof', 'ooz', 'jsonfile')\n        .save('inifile')\n        .save('jsonfile')\n        .on('save', function () {\n          t.equal(fs.readFileSync(f1, 'utf8'),\n                  \"bloo=jaus\\nfoo=zoo\\n\")\n          t.equal(fs.readFileSync(f2, 'utf8'),\n                  \"{\\\"oof\\\":\\\"ooz\\\",\\\"oolb\\\":\\\"suaj\\\"}\")\n\n          t.same(cc.snapshot, { grelb: 'brelg',\n                                bloo: 'jaus',\n                                foo: 'zoo',\n                                oof: 'ooz',\n                                oolb: 'suaj' })\n\n          t.same(cc.list, [ { grelb: 'brelg' },\n                            { bloo: 'jaus', foo: 'zoo' },\n                            { oof: 'ooz', oolb: 'suaj' } ])\n\n          t.pass('ok')\n          t.end()\n        })\n    })\n})\n"]}