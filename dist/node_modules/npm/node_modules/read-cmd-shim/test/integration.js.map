{"version":3,"sources":["../../../../../../node_modules/npm/node_modules/read-cmd-shim/test/integration.js"],"names":["path","require","fs","test","rimraf","cmdShim","readCmdShim","workDir","join","__dirname","basename","__filename","testShbang","testShbangCmd","testShim","testShimCmd","t","sync","mkdirSync","writeFileSync","er","error","done","plan","dest","is","ok","code","throws"],"mappings":"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","file":"integration.js","sourcesContent":["'use strict'\nvar path = require('path')\nvar fs = require('graceful-fs')\nvar test = require('tap').test\nvar rimraf = require('rimraf')\nvar cmdShim = require('cmd-shim')\nvar readCmdShim = require('../index.js')\nvar workDir = path.join(__dirname, path.basename(__filename, '.js'))\nvar testShbang = path.join(workDir, 'test-shbang')\nvar testShbangCmd = testShbang + '.cmd'\nvar testShim = path.join(workDir, 'test')\nvar testShimCmd = testShim + '.cmd'\n\ntest('setup', function (t) {\n  rimraf.sync(workDir)\n  fs.mkdirSync(workDir)\n  fs.writeFileSync(testShbang + '.js', '#!/usr/bin/env node\\ntrue')\n  cmdShim(__filename, testShim, function (er) {\n    t.error(er)\n    cmdShim(testShbang + '.js', testShbang, function (er) {\n      t.error(er)\n      t.done()\n    })\n  })\n})\n\ntest('async-read-no-shbang', function (t) {\n  t.plan(2)\n  readCmdShim(testShimCmd, function (er, dest) {\n    t.error(er)\n    t.is(dest, '..\\\\basic.js')\n    t.done()\n  })\n})\n\ntest('sync-read-no-shbang', function (t) {\n  t.plan(1)\n  var dest = readCmdShim.sync(testShimCmd)\n  t.is(dest, '..\\\\basic.js')\n  t.done()\n})\n\ntest('async-read-shbang', function (t) {\n  t.plan(2)\n  readCmdShim(testShbangCmd, function (er, dest) {\n    t.error(er)\n    t.is(dest, 'test-shbang.js')\n    t.done()\n  })\n})\n\ntest('sync-read-shbang', function (t) {\n  t.plan(1)\n  var dest = readCmdShim.sync(testShbangCmd)\n  t.is(dest, 'test-shbang.js')\n  t.done()\n})\n\ntest('async-read-no-shbang-cygwin', function (t) {\n  t.plan(2)\n  readCmdShim(testShim, function (er, dest) {\n    t.error(er)\n    t.is(dest, '../basic.js')\n    t.done()\n  })\n})\n\ntest('sync-read-no-shbang-cygwin', function (t) {\n  t.plan(1)\n  var dest = readCmdShim.sync(testShim)\n  t.is(dest, '../basic.js')\n  t.done()\n})\n\ntest('async-read-shbang-cygwin', function (t) {\n  t.plan(2)\n  readCmdShim(testShbang, function (er, dest) {\n    t.error(er)\n    t.is(dest, 'test-shbang.js')\n    t.done()\n  })\n})\n\ntest('sync-read-shbang-cygwin', function (t) {\n  t.plan(1)\n  var dest = readCmdShim.sync(testShbang)\n  t.is(dest, 'test-shbang.js')\n  t.done()\n})\n\ntest('async-read-dir', function (t) {\n  t.plan(2)\n  readCmdShim(workDir, function (er) {\n    t.ok(er)\n    t.is(er.code, 'EISDIR', \"cmd-shims can't be directories\")\n    t.done()\n  })\n})\n\ntest('sync-read-dir', function (t) {\n  t.plan(1)\n  t.throws(function () { readCmdShim.sync(workDir) }, \"cmd-shims can't be directories\")\n  t.done()\n})\n\ntest('async-read-not-there', function (t) {\n  t.plan(2)\n  readCmdShim('/path/to/nowhere', function (er, dest) {\n    t.ok(er, 'missing files throw errors')\n    t.is(er.code, 'ENOENT', \"cmd-shim file doesn't exist\")\n    t.done()\n  })\n})\n\ntest('sync-read-not-there', function (t) {\n  t.plan(1)\n  t.throws(function () { readCmdShim.sync('/path/to/nowhere') }, \"cmd-shim file doesn't exist\")\n  t.done()\n})\n\ntest('async-read-not-shim', function (t) {\n  t.plan(2)\n  readCmdShim(__filename, function (er, dest) {\n    t.ok(er)\n    t.is(er.code, 'ENOTASHIM', 'shim file specified is not a shim')\n    t.done()\n  })\n})\n\ntest('sync-read-not-shim', function (t) {\n  t.plan(1)\n  t.throws(function () { readCmdShim.sync(__filename) }, 'shim file specified is not a shim')\n  t.done()\n})\n\ntest('cleanup', function (t) {\n  rimraf.sync(workDir)\n  t.done()\n})\n"]}