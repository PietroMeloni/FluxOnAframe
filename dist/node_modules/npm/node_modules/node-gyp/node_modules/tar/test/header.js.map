{"version":3,"sources":["../../../../../../../../node_modules/npm/node_modules/node-gyp/node_modules/tar/test/header.js"],"names":["tap","require","TarHeader","tar","fs","headers","cksumValid","path","mode","uid","gid","size","mtime","cksum","type","linkpath","ustar","ustarver","uname","gname","devmaj","devmin","fill","test","t","Object","keys","forEach","name","h","header","Buffer","expect","parsed","has","end","encoded","encode","th","block","needExtended","parseNumeric","numbers","n","b","equal"],"mappings":"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","file":"header.js","sourcesContent":["var tap = require(\"tap\")\nvar TarHeader = require(\"../lib/header.js\")\nvar tar = require(\"../tar.js\")\nvar fs = require(\"fs\")\n\n\nvar headers =\n  { \"a.txt file header\":\n    [ \"612e747874000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000030303036343420003035373736312000303030303234200030303030303030303430312031313635313336303333332030313234353100203000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000757374617200303069736161637300000000000000000000000000000000000000000000000000007374616666000000000000000000000000000000000000000000000000000000303030303030200030303030303020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\"\n    , { cksumValid: true\n      , path: 'a.txt'\n      , mode: 420\n      , uid: 24561\n      , gid: 20\n      , size: 257\n      , mtime: 1319493851\n      , cksum: 5417\n      , type: '0'\n      , linkpath: ''\n      , ustar: 'ustar\\0'\n      , ustarver: '00'\n      , uname: 'isaacs'\n      , gname: 'staff'\n      , devmaj: 0\n      , devmin: 0\n      , fill: '' }\n    ]\n\n  , \"omega pax\": // the extended header from omega tar.\n    [ \"5061784865616465722fcea92e74787400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000030303036343420003035373736312000303030303234200030303030303030303137302031313534333731303631312030313530353100207800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000757374617200303069736161637300000000000000000000000000000000000000000000000000007374616666000000000000000000000000000000000000000000000000000000303030303030200030303030303020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\"\n    , { cksumValid: true\n      , path: 'PaxHeader/Ω.txt'\n      , mode: 420\n      , uid: 24561\n      , gid: 20\n      , size: 120\n      , mtime: 1301254537\n      , cksum: 6697\n      , type: 'x'\n      , linkpath: ''\n      , ustar: 'ustar\\0'\n      , ustarver: '00'\n      , uname: 'isaacs'\n      , gname: 'staff'\n      , devmaj: 0\n      , devmin: 0\n      , fill: '' } ]\n\n  , \"omega file header\":\n    [ \"cea92e7478740000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000030303036343420003035373736312000303030303234200030303030303030303030322031313534333731303631312030313330373200203000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000757374617200303069736161637300000000000000000000000000000000000000000000000000007374616666000000000000000000000000000000000000000000000000000000303030303030200030303030303020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\"\n    , { cksumValid: true\n      , path: 'Ω.txt'\n      , mode: 420\n      , uid: 24561\n      , gid: 20\n      , size: 2\n      , mtime: 1301254537\n      , cksum: 5690\n      , type: '0'\n      , linkpath: ''\n      , ustar: 'ustar\\0'\n      , ustarver: '00'\n      , uname: 'isaacs'\n      , gname: 'staff'\n      , devmaj: 0\n      , devmin: 0\n      , fill: '' } ]\n\n  , \"foo.js file header\":\n    [ \"666f6f2e6a730000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000030303036343420003035373736312000303030303234200030303030303030303030342031313534333637303734312030313236313700203000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000757374617200303069736161637300000000000000000000000000000000000000000000000000007374616666000000000000000000000000000000000000000000000000000000303030303030200030303030303020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\"\n    , { cksumValid: true\n      , path: 'foo.js'\n      , mode: 420\n      , uid: 24561\n      , gid: 20\n      , size: 4\n      , mtime: 1301246433\n      , cksum: 5519\n      , type: '0'\n      , linkpath: ''\n      , ustar: 'ustar\\0'\n      , ustarver: '00'\n      , uname: 'isaacs'\n      , gname: 'staff'\n      , devmaj: 0\n      , devmin: 0\n      , fill: '' }\n    ]\n\n  , \"b.txt file header\":\n    [ \"622e747874000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000030303036343420003035373736312000303030303234200030303030303030313030302031313635313336303637372030313234363100203000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000757374617200303069736161637300000000000000000000000000000000000000000000000000007374616666000000000000000000000000000000000000000000000000000000303030303030200030303030303020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\"\n    , { cksumValid: true\n      , path: 'b.txt'\n      , mode: 420\n      , uid: 24561\n      , gid: 20\n      , size: 512\n      , mtime: 1319494079\n      , cksum: 5425\n      , type: '0'\n      , linkpath: ''\n      , ustar: 'ustar\\0'\n      , ustarver: '00'\n      , uname: 'isaacs'\n      , gname: 'staff'\n      , devmaj: 0\n      , devmin: 0\n      , fill: '' }\n    ]\n\n  , \"deep nested file\":\n    [ \"636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363633030303634342000303537373631200030303030323420003030303030303030313434203131363532313531353333203034333331340020300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000075737461720030306973616163730000000000000000000000000000000000000000000000000000737461666600000000000000000000000000000000000000000000000000000030303030303020003030303030302000722f652f612f6c2f6c2f792f2d2f642f652f652f702f2d2f662f6f2f6c2f642f652f722f2d2f702f612f742f680000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\"\n    , { cksumValid: true,\n        path: 'r/e/a/l/l/y/-/d/e/e/p/-/f/o/l/d/e/r/-/p/a/t/h/cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc'\n      , mode: 420\n      , uid: 24561\n      , gid: 20\n      , size: 100\n      , mtime: 1319687003\n      , cksum: 18124\n      , type: '0'\n      , linkpath: ''\n      , ustar: 'ustar\\0'\n      , ustarver: '00'\n      , uname: 'isaacs'\n      , gname: 'staff'\n      , devmaj: 0\n      , devmin: 0\n      , fill: '' }\n    ]\n  }\n\ntap.test(\"parsing\", function (t) {\n  Object.keys(headers).forEach(function (name) {\n    var h = headers[name]\n      , header = new Buffer(h[0], \"hex\")\n      , expect = h[1]\n      , parsed = new TarHeader(header)\n\n    // console.error(parsed)\n    t.has(parsed, expect, \"parse \" + name)\n  })\n  t.end()\n})\n\ntap.test(\"encoding\", function (t) {\n  Object.keys(headers).forEach(function (name) {\n    var h = headers[name]\n      , expect = new Buffer(h[0], \"hex\")\n      , encoded = TarHeader.encode(h[1])\n\n    // might have slightly different bytes, since the standard\n    // isn't very strict, but should have the same semantics\n    // checkSum will be different, but cksumValid will be true\n\n    var th = new TarHeader(encoded)\n    delete h[1].block\n    delete h[1].needExtended\n    delete h[1].cksum\n    t.has(th, h[1], \"fields \"+name)\n  })\n  t.end()\n})\n\n// test these manually.  they're a bit rare to find in the wild\ntap.test(\"parseNumeric tests\", function (t) {\n  var parseNumeric = TarHeader.parseNumeric\n    , numbers =\n      { \"303737373737373700\": 2097151\n      , \"30373737373737373737373700\": 8589934591\n      , \"303030303036343400\": 420\n      , \"800000ffffffffffff\": 281474976710655\n      , \"ffffff000000000001\": -281474976710654\n      , \"ffffff000000000000\": -281474976710655\n      , \"800000000000200000\": 2097152\n      , \"8000000000001544c5\": 1393861\n      , \"ffffffffffff1544c5\": -15383354 }\n  Object.keys(numbers).forEach(function (n) {\n    var b = new Buffer(n, \"hex\")\n    t.equal(parseNumeric(b), numbers[n], n + \" === \" + numbers[n])\n  })\n  t.end()\n})\n"]}