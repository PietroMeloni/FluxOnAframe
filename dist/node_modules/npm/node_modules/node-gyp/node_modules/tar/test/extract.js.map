{"version":3,"sources":["../../../../../../../../node_modules/npm/node_modules/node-gyp/node_modules/tar/test/extract.js"],"names":["process","umask","parseInt","tap","require","tar","fs","path","file","resolve","__dirname","target","index","fstream","ee","expectEntries","mode","type","depth","undefined","size","linkpath","nlink","dev","ino","ef","expectFiles","join","test","t","sync","pass","end","extract","Extract","inp","createReadStream","bufferSize","pipe","on","equal","length","removeAllListeners","e","fail","next","entry","found","props","toString","wanted","equivalent","r","Reader","sort","foundEntry","finish","p","substr","has"],"mappings":"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","file":"extract.js","sourcesContent":["// Set the umask, so that it works the same everywhere.\nprocess.umask(parseInt('22', 8))\n\nvar tap = require(\"tap\")\n  , tar = require(\"../tar.js\")\n  , fs = require(\"fs\")\n  , path = require(\"path\")\n  , file = path.resolve(__dirname, \"fixtures/c.tar\")\n  , target = path.resolve(__dirname, \"tmp/extract-test\")\n  , index = 0\n  , fstream = require(\"fstream\")\n\n  , ee = 0\n  , expectEntries =\n[ { path: 'c.txt',\n    mode: '644',\n    type: '0',\n    depth: undefined,\n    size: 513,\n    linkpath: '',\n    nlink: undefined,\n    dev: undefined,\n    ino: undefined },\n  { path: 'cc.txt',\n    mode: '644',\n    type: '0',\n    depth: undefined,\n    size: 513,\n    linkpath: '',\n    nlink: undefined,\n    dev: undefined,\n    ino: undefined },\n  { path: 'r/e/a/l/l/y/-/d/e/e/p/-/f/o/l/d/e/r/-/p/a/t/h/cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc',\n    mode: '644',\n    type: '0',\n    depth: undefined,\n    size: 100,\n    linkpath: '',\n    nlink: undefined,\n    dev: undefined,\n    ino: undefined },\n  { path: 'Ω.txt',\n    mode: '644',\n    type: '0',\n    depth: undefined,\n    size: 2,\n    linkpath: '',\n    nlink: undefined,\n    dev: undefined,\n    ino: undefined },\n  { path: 'Ω.txt',\n    mode: '644',\n    type: '0',\n    depth: undefined,\n    size: 2,\n    linkpath: '',\n    nlink: 1,\n    dev: 234881026,\n    ino: 51693379 },\n  { path: '200ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc',\n    mode: '644',\n    type: '0',\n    depth: undefined,\n    size: 200,\n    linkpath: '',\n    nlink: 1,\n    dev: 234881026,\n    ino: 51681874 },\n  { path: '200ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc',\n    mode: '644',\n    type: '0',\n    depth: undefined,\n    size: 201,\n    linkpath: '',\n    nlink: undefined,\n    dev: undefined,\n    ino: undefined },\n  { path: '200LLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLL',\n    mode: '777',\n    type: '2',\n    depth: undefined,\n    size: 0,\n    linkpath: '200ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc',\n    nlink: undefined,\n    dev: undefined,\n    ino: undefined },\n  { path: '200-hard',\n    mode: '644',\n    type: '0',\n    depth: undefined,\n    size: 200,\n    linkpath: '',\n    nlink: 2,\n    dev: 234881026,\n    ino: 51681874 },\n  { path: '200ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc',\n    mode: '644',\n    type: '1',\n    depth: undefined,\n    size: 0,\n    linkpath: path.resolve(target, '200-hard'),\n    nlink: 2,\n    dev: 234881026,\n    ino: 51681874 } ]\n\n  , ef = 0\n  , expectFiles =\n[ { path: '',\n    mode: '40755',\n    type: 'Directory',\n    depth: 0,\n    linkpath: undefined },\n  { path: '/200-hard',\n    mode: '100644',\n    type: 'File',\n    depth: 1,\n    size: 200,\n    linkpath: undefined,\n    nlink: 2 },\n  { path: '/200LLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLL',\n    mode: '120777',\n    type: 'SymbolicLink',\n    depth: 1,\n    size: 200,\n    linkpath: '200ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc',\n    nlink: 1 },\n  { path: '/200ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc',\n    mode: '100644',\n    type: 'Link',\n    depth: 1,\n    size: 200,\n    linkpath: path.join(target, '200-hard'),\n    nlink: 2 },\n  { path: '/c.txt',\n    mode: '100644',\n    type: 'File',\n    depth: 1,\n    size: 513,\n    linkpath: undefined,\n    nlink: 1 },\n  { path: '/cc.txt',\n    mode: '100644',\n    type: 'File',\n    depth: 1,\n    size: 513,\n    linkpath: undefined,\n    nlink: 1 },\n  { path: '/r',\n    mode: '40755',\n    type: 'Directory',\n    depth: 1,\n    linkpath: undefined },\n  { path: '/r/e',\n    mode: '40755',\n    type: 'Directory',\n    depth: 2,\n    linkpath: undefined },\n  { path: '/r/e/a',\n    mode: '40755',\n    type: 'Directory',\n    depth: 3,\n    linkpath: undefined },\n  { path: '/r/e/a/l',\n    mode: '40755',\n    type: 'Directory',\n    depth: 4,\n    linkpath: undefined },\n  { path: '/r/e/a/l/l',\n    mode: '40755',\n    type: 'Directory',\n    depth: 5,\n    linkpath: undefined },\n  { path: '/r/e/a/l/l/y',\n    mode: '40755',\n    type: 'Directory',\n    depth: 6,\n    linkpath: undefined },\n  { path: '/r/e/a/l/l/y/-',\n    mode: '40755',\n    type: 'Directory',\n    depth: 7,\n    linkpath: undefined },\n  { path: '/r/e/a/l/l/y/-/d',\n    mode: '40755',\n    type: 'Directory',\n    depth: 8,\n    linkpath: undefined },\n  { path: '/r/e/a/l/l/y/-/d/e',\n    mode: '40755',\n    type: 'Directory',\n    depth: 9,\n    linkpath: undefined },\n  { path: '/r/e/a/l/l/y/-/d/e/e',\n    mode: '40755',\n    type: 'Directory',\n    depth: 10,\n    linkpath: undefined },\n  { path: '/r/e/a/l/l/y/-/d/e/e/p',\n    mode: '40755',\n    type: 'Directory',\n    depth: 11,\n    linkpath: undefined },\n  { path: '/r/e/a/l/l/y/-/d/e/e/p/-',\n    mode: '40755',\n    type: 'Directory',\n    depth: 12,\n    linkpath: undefined },\n  { path: '/r/e/a/l/l/y/-/d/e/e/p/-/f',\n    mode: '40755',\n    type: 'Directory',\n    depth: 13,\n    linkpath: undefined },\n  { path: '/r/e/a/l/l/y/-/d/e/e/p/-/f/o',\n    mode: '40755',\n    type: 'Directory',\n    depth: 14,\n    linkpath: undefined },\n  { path: '/r/e/a/l/l/y/-/d/e/e/p/-/f/o/l',\n    mode: '40755',\n    type: 'Directory',\n    depth: 15,\n    linkpath: undefined },\n  { path: '/r/e/a/l/l/y/-/d/e/e/p/-/f/o/l/d',\n    mode: '40755',\n    type: 'Directory',\n    depth: 16,\n    linkpath: undefined },\n  { path: '/r/e/a/l/l/y/-/d/e/e/p/-/f/o/l/d/e',\n    mode: '40755',\n    type: 'Directory',\n    depth: 17,\n    linkpath: undefined },\n  { path: '/r/e/a/l/l/y/-/d/e/e/p/-/f/o/l/d/e/r',\n    mode: '40755',\n    type: 'Directory',\n    depth: 18,\n    linkpath: undefined },\n  { path: '/r/e/a/l/l/y/-/d/e/e/p/-/f/o/l/d/e/r/-',\n    mode: '40755',\n    type: 'Directory',\n    depth: 19,\n    linkpath: undefined },\n  { path: '/r/e/a/l/l/y/-/d/e/e/p/-/f/o/l/d/e/r/-/p',\n    mode: '40755',\n    type: 'Directory',\n    depth: 20,\n    linkpath: undefined },\n  { path: '/r/e/a/l/l/y/-/d/e/e/p/-/f/o/l/d/e/r/-/p/a',\n    mode: '40755',\n    type: 'Directory',\n    depth: 21,\n    linkpath: undefined },\n  { path: '/r/e/a/l/l/y/-/d/e/e/p/-/f/o/l/d/e/r/-/p/a/t',\n    mode: '40755',\n    type: 'Directory',\n    depth: 22,\n    linkpath: undefined },\n  { path: '/r/e/a/l/l/y/-/d/e/e/p/-/f/o/l/d/e/r/-/p/a/t/h',\n    mode: '40755',\n    type: 'Directory',\n    depth: 23,\n    linkpath: undefined },\n  { path: '/r/e/a/l/l/y/-/d/e/e/p/-/f/o/l/d/e/r/-/p/a/t/h/cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc',\n    mode: '100644',\n    type: 'File',\n    depth: 24,\n    size: 100,\n    linkpath: undefined,\n    nlink: 1 },\n  { path: '/Ω.txt',\n    mode: '100644',\n    type: 'File',\n    depth: 1,\n    size: 2,\n    linkpath: undefined,\n    nlink: 1 } ]\n\n\n\n// The extract class basically just pipes the input\n// to a Reader, and then to a fstream.DirWriter\n\n// So, this is as much a test of fstream.Reader and fstream.Writer\n// as it is of tar.Extract, but it sort of makes sense.\n\ntap.test(\"preclean\", function (t) {\n  require(\"rimraf\").sync(__dirname + \"/tmp/extract-test\")\n  t.pass(\"cleaned!\")\n  t.end()\n})\n\ntap.test(\"extract test\", function (t) {\n  var extract = tar.Extract(target)\n  var inp = fs.createReadStream(file)\n\n  // give it a weird buffer size to try to break in odd places\n  inp.bufferSize = 1234\n\n  inp.pipe(extract)\n\n  extract.on(\"end\", function () {\n    t.equal(ee, expectEntries.length, \"should see \"+ee+\" entries\")\n\n    // should get no more entries after end\n    extract.removeAllListeners(\"entry\")\n    extract.on(\"entry\", function (e) {\n      t.fail(\"Should not get entries after end!\")\n    })\n\n    next()\n  })\n\n  extract.on(\"entry\", function (entry) {\n    var found =\n      { path: entry.path\n      , mode: entry.props.mode.toString(8)\n      , type: entry.props.type\n      , depth: entry.props.depth\n      , size: entry.props.size\n      , linkpath: entry.props.linkpath\n      , nlink: entry.props.nlink\n      , dev: entry.props.dev\n      , ino: entry.props.ino\n      }\n\n    var wanted = expectEntries[ee ++]\n\n    t.equivalent(found, wanted, \"tar entry \" + ee + \" \" + wanted.path)\n  })\n\n  function next () {\n    var r = fstream.Reader({ path: target\n                           , type: \"Directory\"\n                           // this is just to encourage consistency\n                           , sort: \"alpha\" })\n\n    r.on(\"ready\", function () {\n      foundEntry(r)\n    })\n\n    r.on(\"end\", finish)\n\n    function foundEntry (entry) {\n      var p = entry.path.substr(target.length)\n      var found =\n        { path: p\n        , mode: entry.props.mode.toString(8)\n        , type: entry.props.type\n        , depth: entry.props.depth\n        , size: entry.props.size\n        , linkpath: entry.props.linkpath\n        , nlink: entry.props.nlink\n        }\n\n      var wanted = expectFiles[ef ++]\n\n      t.has(found, wanted, \"unpacked file \" + ef + \" \" + wanted.path)\n\n      entry.on(\"entry\", foundEntry)\n    }\n\n    function finish () {\n      t.equal(ef, expectFiles.length, \"should have \"+ef+\" items\")\n      t.end()\n    }\n  }\n})\n"]}