{"version":3,"sources":["../../../../../../../node_modules/npm/node_modules/cross-spawn/lib/util/readShebang.js"],"names":["fs","require","LRU","shebangCommand","shebangCache","max","maxAge","readShebang","command","buffer","fd","shebang","has","get","Buffer","openSync","readSync","closeSync","e","toString","set","module","exports"],"mappings":"AAAA;;AAEA,IAAIA,KAAKC,QAAQ,IAAR,CAAT;AACA,IAAIC,MAAMD,QAAQ,WAAR,CAAV;AACA,IAAIE,iBAAiBF,QAAQ,iBAAR,CAArB;;AAEA,IAAIG,eAAe,IAAIF,GAAJ,CAAQ,EAAEG,KAAK,EAAP,EAAWC,QAAQ,KAAK,IAAxB,EAAR,CAAnB,C,CAA6D;;AAE7D,SAASC,WAAT,CAAqBC,OAArB,EAA8B;AAC1B,QAAIC,MAAJ;AACA,QAAIC,EAAJ;AACA,QAAIC,OAAJ;;AAEA;AACA,QAAIP,aAAaQ,GAAb,CAAiBJ,OAAjB,CAAJ,EAA+B;AAC3B,eAAOJ,aAAaS,GAAb,CAAiBL,OAAjB,CAAP;AACH;;AAED;AACAC,aAAS,IAAIK,MAAJ,CAAW,GAAX,CAAT;;AAEA,QAAI;AACAJ,aAAKV,GAAGe,QAAH,CAAYP,OAAZ,EAAqB,GAArB,CAAL;AACAR,WAAGgB,QAAH,CAAYN,EAAZ,EAAgBD,MAAhB,EAAwB,CAAxB,EAA2B,GAA3B,EAAgC,CAAhC;AACAT,WAAGiB,SAAH,CAAaP,EAAb;AACH,KAJD,CAIE,OAAOQ,CAAP,EAAU,CAAe,CAAzB,CAAY;;AAEd;AACAP,cAAUR,eAAeM,OAAOU,QAAP,EAAf,CAAV;;AAEA;AACAf,iBAAagB,GAAb,CAAiBZ,OAAjB,EAA0BG,OAA1B;;AAEA,WAAOA,OAAP;AACH;;AAEDU,OAAOC,OAAP,GAAiBf,WAAjB","file":"readShebang.js","sourcesContent":["'use strict';\n\nvar fs = require('fs');\nvar LRU = require('lru-cache');\nvar shebangCommand = require('shebang-command');\n\nvar shebangCache = new LRU({ max: 50, maxAge: 30 * 1000 });  // Cache just for 30sec\n\nfunction readShebang(command) {\n    var buffer;\n    var fd;\n    var shebang;\n\n    // Check if it is in the cache first\n    if (shebangCache.has(command)) {\n        return shebangCache.get(command);\n    }\n\n    // Read the first 150 bytes from the file\n    buffer = new Buffer(150);\n\n    try {\n        fd = fs.openSync(command, 'r');\n        fs.readSync(fd, buffer, 0, 150, 0);\n        fs.closeSync(fd);\n    } catch (e) { /* empty */ }\n\n    // Attempt to extract shebang (null is returned if not a shebang)\n    shebang = shebangCommand(buffer.toString());\n\n    // Store the shebang in the cache\n    shebangCache.set(command, shebang);\n\n    return shebang;\n}\n\nmodule.exports = readShebang;\n"]}