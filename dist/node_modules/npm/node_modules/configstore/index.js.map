{"version":3,"sources":["../../../../../node_modules/npm/node_modules/configstore/index.js"],"names":["path","require","os","fs","makeDir","xdgBasedir","writeFileAtomic","dotProp","uniqueString","configDir","config","join","tmpdir","permissionError","makeDirOptions","mode","writeFileOptions","Configstore","id","defaults","opts","pathPrefix","globalConfigPath","all","Object","assign","key","get","val","arguments","length","keys","k","set","has","delete","JSON","parse","readFileSync","err","code","sync","dirname","message","name","stringify","module","exports"],"mappings":"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","file":"index.js","sourcesContent":["'use strict';\nconst path = require('path');\nconst os = require('os');\nconst fs = require('graceful-fs');\nconst makeDir = require('make-dir');\nconst xdgBasedir = require('xdg-basedir');\nconst writeFileAtomic = require('write-file-atomic');\nconst dotProp = require('dot-prop');\nconst uniqueString = require('unique-string');\n\nconst configDir = xdgBasedir.config || path.join(os.tmpdir(), uniqueString());\nconst permissionError = 'You don\\'t have access to this file.';\nconst makeDirOptions = {mode: 0o0700};\nconst writeFileOptions = {mode: 0o0600};\n\nclass Configstore {\n\tconstructor(id, defaults, opts) {\n\t\topts = opts || {};\n\n\t\tconst pathPrefix = opts.globalConfigPath ?\n\t\t\tpath.join(id, 'config.json') :\n\t\t\tpath.join('configstore', `${id}.json`);\n\n\t\tthis.path = path.join(configDir, pathPrefix);\n\t\tthis.all = Object.assign({}, defaults, this.all);\n\t}\n\n\tget all() {\n\t\ttry {\n\t\t\treturn JSON.parse(fs.readFileSync(this.path, 'utf8'));\n\t\t} catch (err) {\n\t\t\t// Create dir if it doesn't exist\n\t\t\tif (err.code === 'ENOENT') {\n\t\t\t\tmakeDir.sync(path.dirname(this.path), makeDirOptions);\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\t// Improve the message of permission errors\n\t\t\tif (err.code === 'EACCES') {\n\t\t\t\terr.message = `${err.message}\\n${permissionError}\\n`;\n\t\t\t}\n\n\t\t\t// Empty the file if it encounters invalid JSON\n\t\t\tif (err.name === 'SyntaxError') {\n\t\t\t\twriteFileAtomic.sync(this.path, '', writeFileOptions);\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\tthrow err;\n\t\t}\n\t}\n\n\tset all(val) {\n\t\ttry {\n\t\t\t// Make sure the folder exists as it could have been deleted in the meantime\n\t\t\tmakeDir.sync(path.dirname(this.path), makeDirOptions);\n\n\t\t\twriteFileAtomic.sync(this.path, JSON.stringify(val, null, '\\t'), writeFileOptions);\n\t\t} catch (err) {\n\t\t\t// Improve the message of permission errors\n\t\t\tif (err.code === 'EACCES') {\n\t\t\t\terr.message = `${err.message}\\n${permissionError}\\n`;\n\t\t\t}\n\n\t\t\tthrow err;\n\t\t}\n\t}\n\n\tget size() {\n\t\treturn Object.keys(this.all || {}).length;\n\t}\n\n\tget(key) {\n\t\treturn dotProp.get(this.all, key);\n\t}\n\n\tset(key, val) {\n\t\tconst config = this.all;\n\n\t\tif (arguments.length === 1) {\n\t\t\tfor (const k of Object.keys(key)) {\n\t\t\t\tdotProp.set(config, k, key[k]);\n\t\t\t}\n\t\t} else {\n\t\t\tdotProp.set(config, key, val);\n\t\t}\n\n\t\tthis.all = config;\n\t}\n\n\thas(key) {\n\t\treturn dotProp.has(this.all, key);\n\t}\n\n\tdelete(key) {\n\t\tconst config = this.all;\n\t\tdotProp.delete(config, key);\n\t\tthis.all = config;\n\t}\n\n\tclear() {\n\t\tthis.all = {};\n\t}\n}\n\nmodule.exports = Configstore;\n"]}