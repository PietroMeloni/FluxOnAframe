{"version":3,"sources":["../../../../../../node_modules/npm/node_modules/registry-auth-token/test/registry-url.test.js"],"names":["fs","require","path","mocha","assert","requireUncached","npmRcPath","join","__dirname","afterEach","describe","it","done","unlink","getRegistryUrl","writeFile","err","equal","content"],"mappings":";;AAAA,IAAIA,KAAKC,QAAQ,IAAR,CAAT;AACA,IAAIC,OAAOD,QAAQ,MAAR,CAAX;AACA,IAAIE,QAAQF,QAAQ,OAAR,CAAZ;AACA,IAAIG,SAASH,QAAQ,QAAR,CAAb;AACA,IAAII,kBAAkBJ,QAAQ,kBAAR,CAAtB;;AAEA,IAAIK,YAAYJ,KAAKK,IAAL,CAAUC,SAAV,EAAqB,IAArB,EAA2B,QAA3B,CAAhB;AACA,IAAIC,YAAYN,MAAMM,SAAtB;AACA,IAAIC,WAAWP,MAAMO,QAArB;AACA,IAAIC,KAAKR,MAAMQ,EAAf;;AAEAD,SAAS,cAAT,EAAyB,YAAY;AACnCD,YAAU,UAAUG,IAAV,EAAgB;AACxBZ,OAAGa,MAAH,CAAUP,SAAV,EAAqB,YAAY;AAC/BM;AACD,KAFD;AAGD,GAJD;;AAMAD,KAAG,yCAAH,EAA8C,YAAY;AACxD,QAAIG,iBAAiBT,gBAAgB,iBAAhB,CAArB;AACAS;AACD,GAHD;;AAKAH,KAAG,6DAAH,EAAkE,UAAUC,IAAV,EAAgB;AAChFZ,OAAGe,SAAH,CAAaT,SAAb,EAAwB,sCAAxB,EAAgE,UAAUU,GAAV,EAAe;AAC7E,UAAIF,iBAAiBT,gBAAgB,iBAAhB,CAArB;AACAD,aAAO,CAACY,GAAR,EAAaA,GAAb;AACAZ,aAAOa,KAAP,CAAaH,eAAe,YAAf,CAAb,EAA2C,6BAA3C;AACAF;AACD,KALD;AAMD,GAPD;;AASAD,KAAG,uDAAH,EAA4D,UAAUC,IAAV,EAAgB;AAC1EZ,OAAGe,SAAH,CAAaT,SAAb,EAAwB,4CAAxB,EAAsE,UAAUU,GAAV,EAAe;AACnF,UAAIF,iBAAiBT,gBAAgB,iBAAhB,CAArB;AACAD,aAAO,CAACY,GAAR,EAAaA,GAAb;AACAZ,aAAOa,KAAP,CAAaH,eAAe,YAAf,CAAb,EAA2C,wBAA3C;AACAF;AACD,KALD;AAMD,GAPD;;AASAD,KAAG,6CAAH,EAAkD,UAAUC,IAAV,EAAgB;AAChEZ,OAAGe,SAAH,CAAaT,SAAb,EAAwB,2CAAxB,EAAqE,UAAUU,GAAV,EAAe;AAClF,UAAIF,iBAAiBT,gBAAgB,iBAAhB,CAArB;AACAD,aAAO,CAACY,GAAR,EAAaA,GAAb;AACAZ,aAAOa,KAAP,CAAaH,eAAe,YAAf,CAAb,EAA2C,wBAA3C;AACAF;AACD,KALD;AAMD,GAPD;;AASAD,KAAG,mDAAH,EAAwD,UAAUC,IAAV,EAAgB;AACtE,QAAIM,UAAU,CACZ,qCADY,EAEZ,uCAFY,EAE6B,EAF7B,EAGZX,IAHY,CAGP,IAHO,CAAd;;AAKAP,OAAGe,SAAH,CAAaT,SAAb,EAAwBY,OAAxB,EAAiC,UAAUF,GAAV,EAAe;AAC9C,UAAIF,iBAAiBT,gBAAgB,iBAAhB,CAArB;AACAD,aAAO,CAACY,GAAR,EAAaA,GAAb;AACAZ,aAAOa,KAAP,CAAaH,gBAAb,EAA+B,4BAA/B;AACAF;AACD,KALD;AAMD,GAZD;AAaD,CApDD","file":"registry-url.test.js","sourcesContent":["var fs = require('fs')\nvar path = require('path')\nvar mocha = require('mocha')\nvar assert = require('assert')\nvar requireUncached = require('require-uncached')\n\nvar npmRcPath = path.join(__dirname, '..', '.npmrc')\nvar afterEach = mocha.afterEach\nvar describe = mocha.describe\nvar it = mocha.it\n\ndescribe('registry-url', function () {\n  afterEach(function (done) {\n    fs.unlink(npmRcPath, function () {\n      done()\n    })\n  })\n\n  it('should read global if no local is found', function () {\n    var getRegistryUrl = requireUncached('../registry-url')\n    getRegistryUrl()\n  })\n\n  it('should return default registry if no url is given for scope', function (done) {\n    fs.writeFile(npmRcPath, 'registry=https://registry.npmjs.org/', function (err) {\n      var getRegistryUrl = requireUncached('../registry-url')\n      assert(!err, err)\n      assert.equal(getRegistryUrl('@somescope'), 'https://registry.npmjs.org/')\n      done()\n    })\n  })\n\n  it('should return registry url if url is given for scope ', function (done) {\n    fs.writeFile(npmRcPath, '@somescope:registry=https://some.registry/', function (err) {\n      var getRegistryUrl = requireUncached('../registry-url')\n      assert(!err, err)\n      assert.equal(getRegistryUrl('@somescope'), 'https://some.registry/')\n      done()\n    })\n  })\n\n  it('should append trailing slash if not present', function (done) {\n    fs.writeFile(npmRcPath, '@somescope:registry=https://some.registry', function (err) {\n      var getRegistryUrl = requireUncached('../registry-url')\n      assert(!err, err)\n      assert.equal(getRegistryUrl('@somescope'), 'https://some.registry/')\n      done()\n    })\n  })\n\n  it('should return configured global registry if given', function (done) {\n    var content = [\n      'registry=http://registry.foobar.eu/',\n      '@somescope:registry=https://some.url/', ''\n    ].join('\\n')\n\n    fs.writeFile(npmRcPath, content, function (err) {\n      var getRegistryUrl = requireUncached('../registry-url')\n      assert(!err, err)\n      assert.equal(getRegistryUrl(), 'http://registry.foobar.eu/')\n      done()\n    })\n  })\n})\n"]}