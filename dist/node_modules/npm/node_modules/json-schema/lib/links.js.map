{"version":3,"sources":["../../../../../../node_modules/npm/node_modules/json-schema/lib/links.js"],"names":["root","factory","define","amd","module","exports","jsonSchemaLinks","cacheLinks","getLink","relation","instance","schema","links","__linkTemplates","schemaLinks","Array","forEach","link","rel","href","linkTemplate","substitute","replace","t","property","value","decodeURIComponent","join"],"mappings":";;;;AAAA;;;;;AAKC,WAAUA,IAAV,EAAgBC,OAAhB,EAAyB;AACtB,KAAI,OAAOC,MAAP,KAAkB,UAAlB,IAAgCA,OAAOC,GAA3C,EAAgD;AAC5C;AACAD,SAAO,EAAP,EAAW,YAAY;AACnB,UAAOD,SAAP;AACH,GAFD;AAGH,EALD,MAKO,IAAI,QAAOG,MAAP,yCAAOA,MAAP,OAAkB,QAAlB,IAA8BA,OAAOC,OAAzC,EAAkD;AACrD;AACA;AACA;AACAD,SAAOC,OAAP,GAAiBJ,SAAjB;AACH,EALM,MAKA;AACH;AACAD,OAAKM,eAAL,GAAuBL,SAAvB;AACH;AACJ,CAfA,aAeO,YAAY;AAAC;AACrB,KAAII,UAAU,EAAd;AACAA,SAAQE,UAAR,GAAqB,IAArB;AACAF,SAAQG,OAAR,GAAkB,UAASC,QAAT,EAAmBC,QAAnB,EAA6BC,MAA7B,EAAoC;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAIC,QAAQD,OAAOE,eAAnB;AACA,MAAG,CAACD,KAAJ,EAAU;AACTA,WAAQ,EAAR;AACA,OAAIE,cAAcH,OAAOC,KAAzB;AACA,OAAGE,eAAeA,uBAAuBC,KAAzC,EAA+C;AAC9CD,gBAAYE,OAAZ,CAAoB,UAASC,IAAT,EAAc;AACpC;;;;;;AAMGL,WAAMK,KAAKC,GAAX,IAAkBD,KAAKE,IAAvB;AACA,KARD;AASA;AACD,OAAGd,QAAQE,UAAX,EAAsB;AACrBI,WAAOE,eAAP,GAAyBD,KAAzB;AACA;AACD;AACD,MAAIQ,eAAeR,MAAMH,QAAN,CAAnB;AACA,SAAOW,gBAAgBf,QAAQgB,UAAR,CAAmBD,YAAnB,EAAiCV,QAAjC,CAAvB;AACA,EA7BD;;AA+BAL,SAAQgB,UAAR,GAAqB,UAASD,YAAT,EAAuBV,QAAvB,EAAgC;AACpD,SAAOU,aAAaE,OAAb,CAAqB,eAArB,EAAsC,UAASC,CAAT,EAAYC,QAAZ,EAAqB;AAChE,OAAIC,QAAQf,SAASgB,mBAAmBF,QAAnB,CAAT,CAAZ;AACA,OAAGC,iBAAiBV,KAApB,EAA0B;AACzB;AACA,WAAO,MAAMU,MAAME,IAAN,CAAW,GAAX,CAAN,GAAwB,GAA/B;AACA;AACD,UAAOF,KAAP;AACA,GAPK,CAAP;AAQA,EATD;AAUA,QAAOpB,OAAP;AACC,CA5DA,CAAD","file":"links.js","sourcesContent":["/** \r\n * JSON Schema link handler\r\n * Copyright (c) 2007 Kris Zyp SitePen (www.sitepen.com)\r\n * Licensed under the MIT (MIT-LICENSE.txt) license.\r\n */\r\n(function (root, factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        // AMD. Register as an anonymous module.\r\n        define([], function () {\r\n            return factory();\r\n        });\r\n    } else if (typeof module === 'object' && module.exports) {\r\n        // Node. Does not work with strict CommonJS, but\r\n        // only CommonJS-like environments that support module.exports,\r\n        // like Node.\r\n        module.exports = factory();\r\n    } else {\r\n        // Browser globals\r\n        root.jsonSchemaLinks = factory();\r\n    }\r\n}(this, function () {// setup primitive classes to be JSON Schema types\r\nvar exports = {};\r\nexports.cacheLinks = true;\r\nexports.getLink = function(relation, instance, schema){\r\n\t// gets the URI of the link for the given relation based on the instance and schema\r\n\t// for example:\r\n\t// getLink(\r\n\t// \t\t\"brother\", \r\n\t// \t\t{\"brother_id\":33}, \r\n\t// \t\t{links:[{rel:\"brother\", href:\"Brother/{brother_id}\"}]}) ->\r\n\t//\t\"Brother/33\"\r\n\tvar links = schema.__linkTemplates; \r\n\tif(!links){\r\n\t\tlinks = {};\r\n\t\tvar schemaLinks = schema.links;\r\n\t\tif(schemaLinks && schemaLinks instanceof Array){\r\n\t\t\tschemaLinks.forEach(function(link){\r\n\t/*\t\t\t// TODO: allow for multiple same-name relations\r\n\t\t\t\tif(links[link.rel]){\r\n\t\t\t\t\tif(!(links[link.rel] instanceof Array)){\r\n\t\t\t\t\t\tlinks[link.rel] = [links[link.rel]];\r\n\t\t\t\t\t}\r\n\t\t\t\t}*/\r\n\t\t\t\tlinks[link.rel] = link.href;\r\n\t\t\t});\r\n\t\t}\r\n\t\tif(exports.cacheLinks){\r\n\t\t\tschema.__linkTemplates = links;\r\n\t\t}\r\n\t}\r\n\tvar linkTemplate = links[relation];\r\n\treturn linkTemplate && exports.substitute(linkTemplate, instance);\r\n};\r\n\r\nexports.substitute = function(linkTemplate, instance){\r\n\treturn linkTemplate.replace(/\\{([^\\}]*)\\}/g, function(t, property){\r\n\t\t\tvar value = instance[decodeURIComponent(property)];\r\n\t\t\tif(value instanceof Array){\r\n\t\t\t\t// the value is an array, it should produce a URI like /Table/(4,5,8) and store.get() should handle that as an array of values\r\n\t\t\t\treturn '(' + value.join(',') + ')';\r\n\t\t\t}\r\n\t\t\treturn value;\r\n\t\t});\r\n};\r\nreturn exports;\r\n}));"]}