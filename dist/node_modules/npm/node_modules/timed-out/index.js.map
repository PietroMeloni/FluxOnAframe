{"version":3,"sources":["../../../../../node_modules/npm/node_modules/timed-out/index.js"],"names":["module","exports","req","time","timeoutTimer","delays","isNaN","socket","connect","host","_headers","undefined","setTimeout","timeoutHandler","abort","e","Error","code","emit","on","assign","connecting","_connecting","once","clear","clearTimeout","socketTimeoutHandler"],"mappings":"AAAA;;AAEAA,OAAOC,OAAP,GAAiB,UAAUC,GAAV,EAAeC,IAAf,EAAqB;AACrC,KAAID,IAAIE,YAAR,EAAsB;AACrB,SAAOF,GAAP;AACA;;AAED,KAAIG,SAASC,MAAMH,IAAN,IAAcA,IAAd,GAAqB,EAACI,QAAQJ,IAAT,EAAeK,SAASL,IAAxB,EAAlC;AACA,KAAIM,OAAOP,IAAIQ,QAAJ,GAAgB,SAASR,IAAIQ,QAAJ,CAAaD,IAAtC,GAA8C,EAAzD;;AAEA,KAAIJ,OAAOG,OAAP,KAAmBG,SAAvB,EAAkC;AACjCT,MAAIE,YAAJ,GAAmBQ,WAAW,SAASC,cAAT,GAA0B;AACvDX,OAAIY,KAAJ;AACA,OAAIC,IAAI,IAAIC,KAAJ,CAAU,oCAAoCP,IAA9C,CAAR;AACAM,KAAEE,IAAF,GAAS,WAAT;AACAf,OAAIgB,IAAJ,CAAS,OAAT,EAAkBH,CAAlB;AACA,GALkB,EAKhBV,OAAOG,OALS,CAAnB;AAMA;;AAED;AACA;AACAN,KAAIiB,EAAJ,CAAO,QAAP,EAAiB,SAASC,MAAT,CAAgBb,MAAhB,EAAwB;AACxC;AACA,MAAI,EAAEA,OAAOc,UAAP,IAAqBd,OAAOe,WAA9B,CAAJ,EAAgD;AAC/Cd;AACA;AACA;;AAEDD,SAAOgB,IAAP,CAAY,SAAZ,EAAuBf,OAAvB;AACA,EARD;;AAUA,UAASgB,KAAT,GAAiB;AAChB,MAAItB,IAAIE,YAAR,EAAsB;AACrBqB,gBAAavB,IAAIE,YAAjB;AACAF,OAAIE,YAAJ,GAAmB,IAAnB;AACA;AACD;;AAED,UAASI,OAAT,GAAmB;AAClBgB;;AAEA,MAAInB,OAAOE,MAAP,KAAkBI,SAAtB,EAAiC;AAChC;AACA;AACAT,OAAIU,UAAJ,CAAeP,OAAOE,MAAtB,EAA8B,SAASmB,oBAAT,GAAgC;AAC7DxB,QAAIY,KAAJ;AACA,QAAIC,IAAI,IAAIC,KAAJ,CAAU,gCAAgCP,IAA1C,CAAR;AACAM,MAAEE,IAAF,GAAS,iBAAT;AACAf,QAAIgB,IAAJ,CAAS,OAAT,EAAkBH,CAAlB;AACA,IALD;AAMA;AACD;;AAED,QAAOb,IAAIiB,EAAJ,CAAO,OAAP,EAAgBK,KAAhB,CAAP;AACA,CApDD","file":"index.js","sourcesContent":["'use strict';\n\nmodule.exports = function (req, time) {\n\tif (req.timeoutTimer) {\n\t\treturn req;\n\t}\n\n\tvar delays = isNaN(time) ? time : {socket: time, connect: time};\n\tvar host = req._headers ? (' to ' + req._headers.host) : '';\n\n\tif (delays.connect !== undefined) {\n\t\treq.timeoutTimer = setTimeout(function timeoutHandler() {\n\t\t\treq.abort();\n\t\t\tvar e = new Error('Connection timed out on request' + host);\n\t\t\te.code = 'ETIMEDOUT';\n\t\t\treq.emit('error', e);\n\t\t}, delays.connect);\n\t}\n\n\t// Clear the connection timeout timer once a socket is assigned to the\n\t// request and is connected.\n\treq.on('socket', function assign(socket) {\n\t\t// Socket may come from Agent pool and may be already connected.\n\t\tif (!(socket.connecting || socket._connecting)) {\n\t\t\tconnect();\n\t\t\treturn;\n\t\t}\n\n\t\tsocket.once('connect', connect);\n\t});\n\n\tfunction clear() {\n\t\tif (req.timeoutTimer) {\n\t\t\tclearTimeout(req.timeoutTimer);\n\t\t\treq.timeoutTimer = null;\n\t\t}\n\t}\n\n\tfunction connect() {\n\t\tclear();\n\n\t\tif (delays.socket !== undefined) {\n\t\t\t// Abort the request if there is no activity on the socket for more\n\t\t\t// than `delays.socket` milliseconds.\n\t\t\treq.setTimeout(delays.socket, function socketTimeoutHandler() {\n\t\t\t\treq.abort();\n\t\t\t\tvar e = new Error('Socket timed out on request' + host);\n\t\t\t\te.code = 'ESOCKETTIMEDOUT';\n\t\t\t\treq.emit('error', e);\n\t\t\t});\n\t\t}\n\t}\n\n\treturn req.on('error', clear);\n};\n"]}